<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">G3 (Bethesda)</journal-id><journal-id journal-id-type="iso-abbrev">Genetics</journal-id><journal-id journal-id-type="hwp">G3: Genes, Genomes, Genetics</journal-id><journal-id journal-id-type="pmc">G3: Genes, Genomes, Genetics</journal-id><journal-id journal-id-type="publisher-id">G3: Genes, Genomes, Genetics</journal-id><journal-title-group><journal-title>G3: Genes|Genomes|Genetics</journal-title></journal-title-group><issn pub-type="epub">2160-1836</issn><publisher><publisher-name>Genetics Society of America</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6288830</article-id><article-id pub-id-type="publisher-id">GGG_200728</article-id><article-id pub-id-type="doi">10.1534/g3.118.200728</article-id><article-categories><subj-group subj-group-type="heading"><subject>Genomic Prediction</subject></subj-group></article-categories><title-group><article-title>Multi-trait, Multi-environment Deep Learning Modeling for Genomic-Enabled Prediction of Plant Traits</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Montesinos-L&#x000f3;pez</surname><given-names>Osval A.</given-names></name><xref ref-type="aff" rid="aff1">*</xref><xref ref-type="corresp" rid="cor1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Montesinos-L&#x000f3;pez</surname><given-names>Abelardo</given-names></name><xref ref-type="aff" rid="aff2"><sup>&#x02020;</sup></xref></contrib><contrib contrib-type="author"><name><surname>Crossa</surname><given-names>Jos&#x000e9;</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9429-5855</contrib-id><xref ref-type="aff" rid="aff3"><sup>&#x02021;</sup></xref><xref ref-type="corresp" rid="cor1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Gianola</surname><given-names>Daniel</given-names></name><xref ref-type="aff" rid="aff4"><sup>&#x000a7;</sup></xref></contrib><contrib contrib-type="author"><name><surname>Hern&#x000e1;ndez-Su&#x000e1;rez</surname><given-names>Carlos M.</given-names></name><xref ref-type="aff" rid="aff5">**</xref></contrib><contrib contrib-type="author"><name><surname>Mart&#x000ed;n-Vallejo</surname><given-names>Javier</given-names></name><xref ref-type="aff" rid="aff6"><sup>&#x02020;&#x02020;</sup></xref></contrib><aff id="aff1"><label>*</label>Facultad de Telem&#x000e1;tica</aff><aff id="aff5"><label>**</label>Facultad de Ciencias, Universidad de Colima, Colima, Colima, 28040, M&#x000e9;xico</aff><aff id="aff2"><label>&#x02020;</label>Departamento de Matem&#x000e1;ticas, Centro Universitario de Ciencias Exactas e Ingenier&#x000ed;as (CUCEI), Universidad de Guadalajara, 44430, Guadalajara, Jalisco, M&#x000e9;xico</aff><aff id="aff3"><label>&#x02021;</label>Biometrics and Statistics Unit, Genetic Resources Program, International Maize and Wheat Improvement Center (CIMMYT), Apdo. Postal 6-641, 06600, Ciudad de M&#x000e9;xico, M&#x000e9;xico</aff><aff id="aff4"><label>&#x000a7;</label>Departments of Animal Sciences, Dairy Science, and Biostatistics and Medical Informatics, University of Wisconsin-Madison, Madison, Wisconsin 53706</aff><aff id="aff6"><label>&#x02020;&#x02020;</label>Departamento de Estad&#x000ed;stica, Universidad de Salamanca, c/Espejo 2, Salamanca, 37007, Espa&#x000f1;a</aff></contrib-group><author-notes><corresp id="cor1"><label>1</label>Corresponding authors: Facultad de Telem&#x000e1;tica, Universidad de Colima, 2804, Colima, M&#x000e9;xico. E-mail: <email>oamontes1@ucol.mx</email>; and Biometrics and Statistics Unit, International Maize and Wheat Improvement Center (CIMMYT), Apdo. Postal 6-641, Apdo. Postal 6-641, 06600 M&#x000e9;xico City, M&#x000e9;xico. E-mail: <email>j.crossa@cgiar.org</email></corresp></author-notes><pub-date pub-type="epub"><day>4</day><month>10</month><year>2018</year></pub-date><pub-date pub-type="collection"><month>12</month><year>2018</year></pub-date><volume>8</volume><issue>12</issue><fpage>3829</fpage><lpage>3840</lpage><history><date date-type="received"><day>30</day><month>7</month><year>2018</year></date><date date-type="accepted"><day>03</day><month>10</month><year>2018</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2018 Montesinos-L&#x000f3;pez <italic>et al.</italic></copyright-statement><copyright-year>2018</copyright-year><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:title="pdf" xlink:type="simple" xlink:href="3829.pdf"/><abstract><p>Multi-trait and multi-environment data are common in animal and plant breeding programs. However, what is lacking are more powerful statistical models that can exploit the correlation between traits to improve prediction accuracy in the context of genomic selection (GS). Multi-trait models are more complex than univariate models and usually require more computational resources, but they are preferred because they can exploit the correlation between traits, which many times helps improve prediction accuracy. For this reason, in this paper we explore the power of multi-trait deep learning (MTDL) models in terms of prediction accuracy. The prediction performance of MTDL models was compared to the performance of the Bayesian multi-trait and multi-environment (BMTME) model proposed by <xref rid="bib21" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2016)</xref>, which is a multi-trait version of the genomic best linear unbiased prediction (GBLUP) univariate model. Both models were evaluated with predictors with and without the genotype&#x000d7;environment interaction term. The prediction performance of both models was evaluated in terms of Pearson&#x02019;s correlation using cross-validation. We found that the best predictions in two of the three data sets were found under the BMTME model, but in general the predictions of both models, BTMTE and MTDL, were similar. Among models without the genotype&#x000d7;environment interaction, the MTDL model was the best, while among models with genotype&#x000d7;environment interaction, the BMTME model was superior. These results indicate that the MTDL model is very competitive for performing predictions in the context of GS, with the important practical advantage that it requires less computational resources than the BMTME model.</p></abstract><kwd-group><title>Key words:</title><kwd>deep learning</kwd><kwd>multi-trait</kwd><kwd>multi-environment</kwd><kwd>genomic prediction</kwd><kwd>plant breeding</kwd><kwd>Bayesian modeling</kwd><kwd>GenPred</kwd><kwd>Shared Data Resources</kwd></kwd-group><counts><fig-count count="4"/><table-count count="1"/><equation-count count="20"/><ref-count count="39"/><page-count count="12"/></counts></article-meta></front><body><p>The key principle of genomic selection (GS) is to build an accurate prediction model based on a training population consisting of individuals with both genotypic and phenotypic data. Existing GS prediction models can be grouped into two main categories based on the number of traits analyzed: univariate-trait (UT) models and multi-trait (MT) models. Most of the time, UT models are trained to predict the value of a single continuous (or categorical) phenotype in a testing data set. When there are many traits (or variables), breeders need to use more complex analyses in order to obtain all the necessary information from the data (<xref rid="bib10" ref-type="bibr">Everitt and Dunn 1992</xref>). For this reason, these situations are handled by a generalization of univariate models, which involves predicting multiple traits; the generalized models are known as MT models.</p><p>MT models are concerned with the simultaneous prediction of multiple traits based on the same set of explanatory input variables. It is assumed that MT data sets are generated by a single system, most likely indicating that the captured outputs have some structure. MT models are designed to more efficiently capturing the complex relationships between traits, and most of the time they produce more accurate parameter estimates and better predictions than the UT models. MT models exploit not only the correlation between lines, but also the correlation between traits, which improves its efficiency. UT models, on the other hand, eliminate any possibility of learning from the possible relationships between traits because a single, independent model is trained for each trait separately. Another advantage of MT techniques is model interpretability (<xref rid="bib36" ref-type="bibr">Xiong <italic>et al.</italic>, 2014</xref>). A MT model is much more interpretable than a series of single-trait models because it not only exploits the relationship between lines, but also among the traits themselves. In addition, a MT deep learning model has the advantage that it does not increase the computational time exponentially when going from the univariate to the multivariate version, which makes MT deep learning very attractive.</p><p>MT models have recently become increasingly popular in GS due to their great capacity to predict multiple traits simultaneously and also because they help increase prediction accuracy when the traits are correlated. MT models are also popular in other fields like ecological modeling, energy forecasting, data mining (<xref rid="bib34" ref-type="bibr">Wang <italic>et al.</italic>, 2015</xref>), computer vision (<xref rid="bib37" ref-type="bibr">Yan <italic>et al.</italic>, 2015</xref>), water quality monitoring, forest monitoring, load/price forecasting and medical image analysis (<xref rid="bib38" ref-type="bibr">Zhen <italic>et al.</italic>, 2015</xref>), due to their great effectiveness in solving challenging problems in a broad range of applications. Also, as one of the reviewers suggested, there is a great need for multivariate models in emerging fields like high-throughput phenotyping, where various traits are produced and not exploited to their full capacity due to the lack of adequate multivariate techniques that can exploit the genetic association among phenotypic traits. For dealing with multivariate data for high-throughput phenotyping and longitudinal interdependencies, we suggest reading the work of <xref rid="bib31" ref-type="bibr">Sun <italic>et al.</italic> (2017)</xref>, and for studying the relationship among traits with multivariate mixed models, we suggest reading <xref rid="bib35" ref-type="bibr">Xavier <italic>et al.</italic> (2017)</xref>.</p><p>In the context of GS, <xref rid="bib17" ref-type="bibr">Jia and Jannink (2012)</xref> and <xref rid="bib18" ref-type="bibr">Jiang <italic>et al.</italic> (2015)</xref> showed that the larger the genetic correlation between traits, the better the prediction accuracy of MT analysis compared to UT analysis. <xref rid="bib4" ref-type="bibr">Calus and Veerkamp (2011)</xref> reported modest improvement in the prediction accuracy of MT analysis with regard to UT analysis. <xref rid="bib21" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2016)</xref> found modest improvement in the prediction accuracy of MT analysis for correlated traits in comparison to data with null correlation between traits. Along these lines, <xref rid="bib14" ref-type="bibr">He <italic>et al.</italic> (2016)</xref> found that MT analysis improves prediction accuracy for correlated traits as compared to UT analysis. <xref rid="bib27" ref-type="bibr">Schulthess <italic>et al.</italic> (2017)</xref> also found that in terms of prediction accuracy, MT analysis performs better than UT analysis, and pointed out that MT models are better when the degree of relatedness between genotypes is weaker. Also, there is evidence that MT analysis improves accuracy when classifying and identifying superior genetic constitutions (<xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic>, 2018</xref>) and helps scientists understand the type of allele interaction involved in heredity and the relationships between the traits under study (<xref rid="bib3" ref-type="bibr">Bertan <italic>et al.</italic>, 2009</xref>). In addition, it increases the precision of genetic correlation parameter estimates between traits, which helps breeders perform indirect selection. In general, MT analysis is a powerful tool for clarifying the relationship and the effect of each studied variable and for building more efficient prediction models (<xref rid="bib5" ref-type="bibr">Castro <italic>et al.</italic>, 2013</xref>; <xref rid="bib15" ref-type="bibr">Huang <italic>et al.</italic>, 2015</xref>).</p><p>It is documented that MT models have some advantages over UT models, including: (a) higher prediction accuracy for individual traits because there is more information (direct or indirect) and better data connectedness (<xref rid="bib7" ref-type="bibr">Colleau <italic>et al.</italic>, 2009</xref>), especially when traits with varying heritabilities are analyzed jointly; this is true if genetic correlations are significant or substantial with low error correlations; (b) simplified index selection because optimal weight factors for the total merit index are the economic weights (<xref rid="bib7" ref-type="bibr">Colleau <italic>et al.</italic>, 2009</xref>); and (c) procedures for obtaining genetic and residual covariances and incorporating these in expected breeding value (EBV) estimates for across-location, across-country or across-region evaluations (<xref rid="bib26" ref-type="bibr">Schaeffer 2001</xref>).</p><p>Genomic prediction plays a significant role in the selection of the best candidate lines for which there is only measured genomic information. Achieving accurate phenotypic prediction using genetic information is a major goal in GS and plant breeding programs. Accurate prediction models will have great impact on selecting the best lines and on breeding program strategies. Various approaches for modeling MT data have been proposed in the context of GS. The most popular approach for MT prediction modeling in plant breeding is the use of mixed models under a frequentist and Bayesian approach. Selection by mixed models focusing on multivariate analyses is a powerful tool for selecting cultivars under the Bayesian approach of mixed models. One of these models is the Bayesian multi-trait and multi-environment (BMTME) model proposed by <xref rid="bib21" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2016)</xref>, which is a MT version of the genomic best linear unbiased prediction (GBLUP) univariate model. Under a frequentist approach, the restricted maximum likelihood (Software ASREML; <xref rid="bib12" ref-type="bibr">Gilmour <italic>et al.</italic>, 1995</xref>) is one of the most popular models in the context of mixed models.</p><p>Deep neural networks referring to artificial neural networks with more than two hidden layers, have been explored for prediction in many domains. Deep learning (DL) is often presented in the media as a field that appeared from nowhere during the last decade. However, the key concepts of DL have been developing for more than 60 years, since DL is a specific subfield of machine learning that deals with neural networks with more than two layers. The applications of DL cover many areas, for example, <xref rid="bib23" ref-type="bibr">Qi <italic>et al.</italic> (2012)</xref> developed a unified multi-task, local-structure predictor of proteins using DL networks as a classifier. <xref rid="bib11" ref-type="bibr">Fox <italic>et al.</italic> (2018)</xref> used DL models to accurately predict blood glucose trajectories. <xref rid="bib28" ref-type="bibr">Spencer <italic>et al.</italic> (2015)</xref> developed an iterative DL network for protein secondary structure prediction. <xref rid="bib32" ref-type="bibr">Tavanaei <italic>et al.</italic> (2017)</xref> used a DL model for predicting tumor suppressor genes and oncogenes. DL models have also made accurate predictions of single-cell DNA methylation states (<xref rid="bib2" ref-type="bibr">Angermueller <italic>et al.</italic>, 2017</xref>). <xref rid="bib1" ref-type="bibr">Alipanahi <italic>et al.</italic> (2015)</xref> used DL with a convolutional network architecture to predict specificities of DNA- and RNA-binding proteins. <xref rid="bib20" ref-type="bibr">Menden <italic>et al.</italic> (2013)</xref> applied DL models to predict the viability of a cancer cell line exposed to a drug.</p><p>In a recent study, <xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2018)</xref> explored DL models with densely connected network architecture on nine extensive genomic data sets, including genomic&#x000d7;environment interaction, and compared the results to those of the GBLUP model. Results showed that the DL models appeared to be competitive, since they had higher prediction accuracy than the GBLUP in 6 out of the 9 data sets in scenarios that ignored the genotype&#x000d7;environment interaction term. However, the authors applied univariate modeling and did not attempt to add other traits to the prediction accuracy.</p><p>Based on the previous considerations and the need to adapt DL methodology to the application of GS in plant breeding, in this article we propose a MT deep learning (MTDL) model for genomic-enabled prediction of multiple response variables simultaneously. To evaluate its performance, we compare the MTDL model against the BMTME model, which is a Bayesian model for predicting multi-trait and multi-environment data in the context of GS (<xref rid="bib21" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic>, 2016</xref>, <xref rid="bib22" ref-type="bibr">2018</xref>). Prediction performance was evaluated on three real data sets using 10 random cross-validations and measuring the prediction accuracy based on Pearson&#x02019;s correlation between the observed and predicted values.</p><sec sec-type="materials|methods" id="s1"><title>Materials and Methods</title><sec id="s2"><title>Implemented models</title><sec id="s3"><title>Bayesian multiple-trait multiple-environment (BMTME) model:</title><p>This model was implemented by <xref rid="bib21" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2016)</xref> and for a complete understanding of the description of the BMTME model, first we provide the notations used for the matrix-variate normal distribution that plays a key role in building the BMTME model. Matrix-variate normal distribution is a generalization of the multivariate normal distribution to matrices. The (<italic>n</italic>&#x000d7;<italic>p</italic>) random matrix, <inline-formula><mml:math id="me5"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> is distributed as matrix-variate normal distribution denoted as <inline-formula><mml:math id="me6"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">H</mml:mi><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a9;</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, if and only if, the (<italic>np</italic>&#x000d7;1) random vector <inline-formula><mml:math id="me7"><mml:mrow><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is distributed as multivariate normal as <inline-formula><mml:math id="me8"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mo>&#x02297;</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a9;</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; therefore, <inline-formula><mml:math id="me9"><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the (<inline-formula><mml:math id="me10"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>) dimensional matrix-variate normal distribution, <inline-formula><mml:math id="me11"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle></mml:math></inline-formula> is a (<italic>n</italic>&#x000d7;<italic>p</italic>) location matrix, <inline-formula><mml:math id="me12"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle></mml:math></inline-formula> is a (<inline-formula><mml:math id="me13"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>) first covariance matrix, and <inline-formula><mml:math id="me14"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a9;</mml:mi></mml:mstyle></mml:math></inline-formula> is a (<inline-formula><mml:math id="me15"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>) second covariance matrix (<xref rid="bib29" ref-type="bibr">Srivastava and Khatri 1979</xref>). <inline-formula><mml:math id="me16"><mml:mrow><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and &#x02297; are the standard vectorization operator and Kronecker product, respectively. Unlike in a multivariate normal model where the data are concatenated into a single vector of length <italic>n</italic><italic>p</italic>, in a matrix-variate normal model, the data <inline-formula><mml:math id="me17"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are in an <italic>n</italic>&#x000d7;<italic>p</italic> matrix where each column is a trait (<xref rid="bib21" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic>, 2016</xref>). Therefore, the proposed BMTME model is defined as follows:<disp-formula id="eq1"><mml:math id="me18"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X&#x003b2;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow></mml:math><label>(1)</label></disp-formula>where <inline-formula><mml:math id="me19"><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:math></inline-formula> is of order <inline-formula><mml:math id="me20"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="me21"><mml:mi>L</mml:mi></mml:math></inline-formula> the number of traits and <inline-formula><mml:math id="me22"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me23"><mml:mi>J</mml:mi></mml:math></inline-formula> denotes the number of lines and <inline-formula><mml:math id="me24"><mml:mi>I</mml:mi></mml:math></inline-formula> the number of environments, <inline-formula><mml:math id="me25"><mml:mi mathvariant="bold-italic">X</mml:mi></mml:math></inline-formula> is of order <inline-formula><mml:math id="me26"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me27"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:math></inline-formula> is of order <inline-formula><mml:math id="me28"><mml:mrow><mml:mi>I</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, since <inline-formula><mml:math id="me29"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="me30"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="me31"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="me32"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me33"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me34"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me35"><mml:mrow><mml:mi>J</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> and contains the genotype<inline-formula><mml:math id="me36"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>trait interaction term since <inline-formula><mml:math id="me37"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="me38"><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the effect of genotype<inline-formula><mml:math id="me39"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>trait interaction term for <inline-formula><mml:math id="me40"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula> and for <inline-formula><mml:math id="me41"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>.<inline-formula><mml:math id="me42"><mml:mrow><mml:mo>&#x000a0;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me43"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>I</mml:mi><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me44"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me45"><mml:mrow><mml:mi>I</mml:mi><mml:mi>J</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> and contains the genotype<inline-formula><mml:math id="me46"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment<inline-formula><mml:math id="me47"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>trait interaction, since <inline-formula><mml:math id="me48"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="me49"><mml:mrow><mml:mi>g</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the effect of genotype<inline-formula><mml:math id="me50"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment<inline-formula><mml:math id="me51"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>trait interaction for <inline-formula><mml:math id="me52"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="me53"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> and for <inline-formula><mml:math id="me54"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. Vector <inline-formula><mml:math id="me55"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></inline-formula>is distributed under a matrix-variate normal distribution as <inline-formula><mml:math id="me56"><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="me57"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me58"><mml:mrow><mml:mi>J</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula> and represents the Genomic Relationship Matrix (GRM) and is calculated using the <xref rid="bib33" ref-type="bibr">VanRaden (2008)</xref> method as <inline-formula><mml:math id="me59"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mi>p</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me60"><mml:mi>p</mml:mi></mml:math></inline-formula> denotes the number of markers and <inline-formula><mml:math id="me61"><mml:mi mathvariant="bold-italic">W</mml:mi></mml:math></inline-formula> the matrix of markers of order <inline-formula><mml:math id="me62"><mml:mrow><mml:mi>J</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>; and <inline-formula><mml:math id="me63"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the unstructured genetic (co)variance matrix of traits of order <inline-formula><mml:math id="me64"><mml:mrow><mml:mi>L</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me65"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mi>I</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x000a0;</mml:mi><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>&#x000a0;</mml:mo><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi mathvariant="bold-italic">g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me66"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></inline-formula>is an unstructured (co)variance matrix of order <inline-formula><mml:math id="me67"><mml:mrow><mml:mi>I</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>I</mml:mi><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></inline-formula>and <inline-formula><mml:math id="me68"><mml:mi mathvariant="bold-italic">E</mml:mi></mml:math></inline-formula> is the matrix of residuals of order <inline-formula><mml:math id="me69"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="me70"><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me71"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the unstructured residual (co)variance matrix of traits of order <inline-formula><mml:math id="me72"><mml:mrow><mml:mi>L</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="me73"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the genomic relationship matrix described above (<xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic>, 2018</xref>).</p><p>The BMTME model resulting from <xref ref-type="disp-formula" rid="eq1">equation (1)</xref> was implemented by <xref rid="bib21" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2016)</xref>. Next, we use the modified version of the Gibbs sampler of the original BMTME model proposed by <xref rid="bib21" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2016)</xref> that was implemented in <xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2018)</xref>. It is important to point out that model (1) takes into account the genotype<inline-formula><mml:math id="me74"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment terms in the (<inline-formula><mml:math id="me75"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> term and for comparison purposes, we also ran the model in <xref ref-type="disp-formula" rid="eq1">equation (1)</xref> without the (<inline-formula><mml:math id="me76"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> term to study the effect on prediction performance with and without the genotype<inline-formula><mml:math id="me77"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment term.</p><p>Outlined below is the Gibbs sampler implemented by <xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2018)</xref> for estimating the parameters of interest in the BMTME model. While the order is somewhat arbitrary, we suggest the following:</p><list list-type="simple" id="L1"><list-item><p>Step 1. Simulate <inline-formula><mml:math id="me78"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:math></inline-formula> according to the normal distribution given in Appendix A (A.1) of <xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2018)</xref>.</p></list-item><list-item><p>Step 2. Simulate <inline-formula><mml:math id="me79"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></inline-formula>according to the normal distribution given in Appendix A (A.2) of <xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2018)</xref>.</p></list-item><list-item><p>Step 3. Simulate <inline-formula><mml:math id="me80"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></inline-formula>according to the normal distribution given in Appendix A (A.3) of <xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2018)</xref>.</p></list-item><list-item><p>Step 4. Simulate <inline-formula><mml:math id="me81"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></inline-formula>according to the inverse Wishart (IW) distribution given in Appendix A (A.4) of <xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2018)</xref>.</p></list-item><list-item><p>Step 5. Simulate <inline-formula><mml:math id="me82"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></inline-formula>according to the IW distribution given in Appendix A (A.5) of <xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2018)</xref>.</p></list-item><list-item><p>Step 6. Simulate <inline-formula><mml:math id="me83"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></inline-formula>according to the IW distribution given in Appendix A (A.6) of <xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2018)</xref>.</p></list-item><list-item><p>Step 7. Return to step 1 or terminate when chain length is adequate to meet convergence diagnostics.</p></list-item></list><p>The main differences between this Gibbs sampler and that given by <xref rid="bib21" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2016)</xref> are: (i) the modified Gibbs sampler was built using the matrix-variate normal distribution instead of a multivariate normal distribution; (ii) this modified Gibbs sampler assumes a general or unstructured variance-covariance matrix for environments, that needs <inline-formula><mml:math id="me84"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> parameters because every term is different, while the original BMTME model assumes a diagonal variance-covariance matrix for environments that only needs <inline-formula><mml:math id="me85"><mml:mi>L</mml:mi></mml:math></inline-formula> parameters since all off diagonal elements are zero; and (iii) the original BMTME model used non-informative priors based on the Half-<inline-formula><mml:math id="me86"><mml:mi>t</mml:mi></mml:math></inline-formula> distribution of each standard deviation term and uniform priors on each correlation of the covariance matrices of traits (genetic and residual). The priors implemented for the Gibbs sampler described above are given in Appendix A of this article.</p></sec><sec id="s4"><title>Multi-trait deep learning (MTDL) model:</title><p>Popular neural network architectures are: (a) densely connected networks, (b) convolutional networks, and (c) recurrent networks. Details of each type of network, its assumptions and input characteristics can be found in <xref rid="bib13" ref-type="bibr">Gulli and Sujit (2017)</xref>, <xref rid="bib2" ref-type="bibr">Angermueller <italic>et al.</italic> (2017)</xref> and <xref rid="bib6" ref-type="bibr">Chollet and Allaire, (2017)</xref>. In this study we implemented a type (a) network, which does not assume a specific structure in the input features. In general, the basic structure of a densely connected network consists of an input layer, L output layers (for multi-trait modeling) and multiple hidden layers between the input and output layers. This type of neural network is also known as a feedforward neural network. The implementation of this neural network is challenging because it requires the following hyperparameters: number of units (U), number of layers, number of epochs (E), type of regularization method and type of activation function. Based on the literature review, we decided to use the rectified linear activation unit (ReLU) as activation function and the dropout type of regularization method for training the models (<xref rid="bib13" ref-type="bibr">Gulli and Sujit 2017</xref>; <xref rid="bib2" ref-type="bibr">Angermueller <italic>et al.</italic>, 2017</xref>; and <xref rid="bib6" ref-type="bibr">Chollet and Allaire 2017</xref>). The range of the remaining hyperparameters was determined by a few initial studies of a single fold (80% for training and 20% for testing), randomly selected from each data set; with these initial values, we implemented a full factorial design with 6 levels for the number of units and epochs and 3 levels for the number of layers. For more details on model selection in DL models, we suggest the companion paper of <xref rid="bib22" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2018)</xref>, where the authors evaluate the prediction performance of univariate DL models for multi-environment data. In Appendix B we provide the R code for implementing MTDL models, while the R package BMTME that is still under development is available at the following link: <ext-link ext-link-type="uri" xlink:href="https://github.com/frahik/BMTME">https://github.com/frahik/BMTME</ext-link>.</p></sec></sec><sec id="s5"><title>Experimental data sets</title><p>Three real data sets were analyzed, one data set comprising maize lines and two data sets comprising elite wheat lines. The three data sets included several environments.</p><sec id="s6"><title>Maize data set 1:</title><p>This data set was used by <xref rid="bib8" ref-type="bibr">Crossa <italic>et al.</italic> (2013)</xref> and <xref rid="bib21" ref-type="bibr">Montesinos-L&#x000f3;pez <italic>et al.</italic> (2016)</xref> and is made up of a total of 309 maize lines. Three traits were evaluated: grain yield (GY), anthesis-silking interval (ASI), and plant height (PH); each of these traits was measured in three environments (Env1, Env2, and Env3) on the same 309 lines. Phenotypes of each trait were pre-analyzed and adjusted for the experimental field design. The genotyping was done with Genotype by Sequencing (GBS) technology with a total of 681,257 single nucleotide polymorphisms (SNPs); after filtering for missing values and minor allele frequency, we used 158,281 SNPs. Markers that had 80% of the maize lines with missing values were removed, and markers with a minor allele frequency lower than or equal to 0.05 were deleted.</p></sec><sec id="s7"><title>Wheat data set 2:</title><p>This wheat data set is composed of 250 wheat lines that were extracted from a large set of 39 yield trials grown during the 2013-2014 crop season in Ciudad Obregon, Sonora, Mexico (<xref rid="bib25" ref-type="bibr">Rutkoski <italic>et al.</italic>, 2016</xref>). The measured traits were plant height (PH) recorded in centimeters and days to heading (DTH) recorded as the number of days from germination until 50% of spikes had emerged in each plot, in the first replicate of each trial. Both traits were measured in three environments and on the same 250 lines. Phenotypes were also adjusted by experimental design. Genomic information was obtained by genotype by sequencing (GBS) and we used a total of 12,083 markers that remained after quality control. Single nucleotide polymorphism calls were extracted and markers were filtered so that percent missing data did not exceed 80%. Individuals with 80% missing marker data were removed, and markers were recorded as -1, 0, and 1, indicating homozygous for the minor allele, heterozygous, and homozygous for the major allele, respectively. Next, markers with 0.01 minor allele frequency were removed, and missing data were imputed with the marker mean.</p></sec><sec id="s8"><title>Wheat Iranian data set 3:</title><p>This data set consists of 2374 wheat lines evaluated in a drought environment (D) and a heat environment (H) at the CIMMYT experiment station near Ciudad Obregon, Sonora, Mexico (27 &#x000b0; 20 &#x02032;N, 109 &#x000b0; 54 &#x02032;W, 38 meters above sea level) during the 2010-2011 cycle and was used in <xref rid="bib9" ref-type="bibr">Crossa <italic>et al.</italic> (2016)</xref>. Two traits were measured: days to maturity (DTM) and days to heading (DTH). Both traits were measured in the two environments and on the same 2374 lines. The number of markers used was 39,758 that remained after the quality control process from a total of 40,000 markers originally used.</p></sec></sec><sec id="s9"><title>Experiments evaluated</title><p>In this empirical evaluation, we compared the prediction accuracy of the two proposed models: the MTDL method and the BMTME model. Both methods were implemented in the R statistical software (<xref rid="bib24" ref-type="bibr">R Core Team 2018</xref>). The MTDL model was fitted with the Keras package (<xref rid="bib13" ref-type="bibr">Gulli and Sujit 2017</xref>; <xref rid="bib6" ref-type="bibr">Chollet and Allaire 2017</xref>) with a densely connected network architecture. In both MTDL and BMTME, we used two different sets of independent variables: the first set was composed of information on environments and genomes (that takes into account genomic information) ignoring genotype&#x000d7;environment interaction, while the second set included the genotype&#x000d7;environment term in addition to the main effects of environments and genomes. Under the MTDL model, we implemented a grid search for choosing the hyperparameters; this was done using a full factorial design with the following three factors: (a) number of units (U), (b) number of epochs (E), and (c) number of layers. These three factors are hyperparameters under the MTDL model. We studied the following values for the U and E hyperparameters: 50, 60, 70, 80, 90 and 100, and for the number of layers we used 1, 2 and 3. These values were chosen after the previous experiments were conducted. Thus 6<inline-formula><mml:math id="me89"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>6<inline-formula><mml:math id="me90"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>3 = 108 experiments were run for each data set with densely connected MTDL models.</p><p>It is important to point out that the 108 MTDL experiments used dropout regularization, which is one of the most effective and commonly used regularization techniques in neural networks; it was developed by <xref rid="bib30" ref-type="bibr">Srivastava <italic>et al.</italic> (2014)</xref> at the University of Toronto. Dropout regularization is applied to a layer and consists of randomly dropping out (setting to zero) a number of the hidden layer&#x02019;s during training. In our case, the dropout rate was 0.3 (30%); this meant that the percentage of features that were set to zero was 30% in each hidden layer (<xref rid="bib13" ref-type="bibr">Gulli and Sujit 2017</xref>; <xref rid="bib6" ref-type="bibr">Chollet and Allaire 2017</xref>).</p><sec id="s10"><title>Evaluation of prediction performance With cross-validation:</title><p>The prediction accuracy of both MTDL and BMTME models was evaluated with 10 random cross-validations (CV): the whole data set was divided into a training (TRN) and a testing (TST) set; 80% of the whole data set was assigned to TRN, and the remaining 20% was assigned to TST set. In our random CV, one observation can appear in more than one partition because we used sampling with replacement. However, the same observation is never included simultaneously in the training and testing sets of a random partition. In the design, some lines can be evaluated in some, but not all, target environments, which mimics a prediction problem faced by breeders in incomplete field trials. For this reason, our cross-validation strategy is exactly the same as that denoted by the CV2 proposed and implemented by <xref rid="bib16" ref-type="bibr">Jarqu&#x000ed;n <italic>et al.</italic> (2017)</xref>, where a certain portion of tested lines (genotypes) in a certain portion of tested environments are predicted since some tested lines that were evaluated in some tested environments are assumed missed in others. Since <inline-formula><mml:math id="me91"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> denotes the total number of records per each available trait, then to select lines in the TST data set, we fixed the percentage of data to be used for TST (PTesting = 20%). Then 0.20<inline-formula><mml:math id="me92"><mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> (lines) were chosen at random, and subsequently one environment per line was randomly picked from <inline-formula><mml:math id="me93"><mml:mi>I</mml:mi></mml:math></inline-formula> environments. The cells not selected through this algorithm were allocated to the TRN data set, while the selected cells (<inline-formula><mml:math id="me94"><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> were assigned to the TST data set. Lines were sampled with replacement if <inline-formula><mml:math id="me95"><mml:mrow><mml:mi>J</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mn>0.20</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, and without replacement otherwise (<xref rid="bib19" ref-type="bibr">L&#x000f3;pez-Cruz <italic>et al.</italic>, 2015</xref>). The metric used to measure the prediction accuracy of both models was the Pearson&#x02019;s correlation and it was calculated from each trait-environment combination for each testing set of each random partition; thus the average of all partitions was reported as a measure of prediction performance. This explained cross validation method is called the outer CV and was applied for both models. However, in the DL model we also applied an inner CV strategy for tunning the hyperparameters using the grid of hyperparameter values defined above (108 experiments). The inner CV strategy consists in spliting each training set of the outer CV, here 20% of data were assigned for testing-inner and 80% for training-inner.The training-inner data set was used to train the DL model using the grid of hyperparameters values. This inner CV strategy was facilitated by using the internal capabilities of Keras by means of the validation_split argument on the fit() function. The predictve power is assessed in the second part of the data set (testing-inner). With this, a set of best-fitting hyperparameters (best combination of units, epoch and layers) from the inner CV loop is obtained. Finally, these set of hyperparameters were used to predict the performance in the independent testing data set (testing-outer). Since different traits in different environments have different heritabilities, we report the accuracy in terms of Pearson&#x02019;s correlation divided by the square root of the heritability corresponding to each trait-environment combination.</p></sec></sec><sec id="s11"><title>Data availability</title><p>The phenotypic and genotypic data used in this study can be downloaded from the following link: <ext-link ext-link-type="uri" xlink:href="http://hdl.handle.net/11529/10548134">http://hdl.handle.net/11529/10548134.</ext-link></p></sec></sec><sec sec-type="results" id="s12"><title>Results</title><p>Our results are given in four sections. In the three first sections we report the performance of each real data set analyzed, and in the last section we compare the prediction performance of both models for all data sets. In each of the first three sections, first we present a figure with prediction performance in terms of Pearson&#x02019;s correlation under both models BMTME and MTDL with (I) and without (WI) the genotype&#x000d7;environment interaction term.</p><sec id="s13"><title>Maize data set 1</title><p>Next we describe the prediction performance of the BMTME model without genotype<inline-formula><mml:math id="me97"><mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mi mathvariant="bold-italic">&#x000a0;</mml:mi></mml:mrow></mml:math></inline-formula>environment interaction (WI). The prediction accuracy of this model ranged from 0.222 to 0.451. <xref ref-type="fig" rid="fig1">Figure 1</xref> gives the predictions under the MTDL model without the interaction term. Here Pearson&#x02019;s correlation ranged from 0.305 to 0.540 (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Next we present the prediction performance of the models including genotype<inline-formula><mml:math id="me98"><mml:mrow><mml:mi mathvariant="bold-italic">&#x000a0;</mml:mi><mml:mo>&#x000d7;</mml:mo></mml:mrow></mml:math></inline-formula>environment interaction (I). First, under the BMTME model the predictions ranged from 0.321 to 0.619 in terms of Pearson&#x02019;s correlation. The prediction performance of MTDL is shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>; with the interaction term ranged from 0.266 to 0.501 in terms of Pearson&#x02019;s correlation. The standard errors (SE) of the average Pearson correlation of this data set and of the following data sets are given in <xref rid="tC.1" ref-type="table">Table C1</xref> of Appendix C.</p><fig id="fig1" fig-type="figure" position="float"><label>Figure 1</label><caption><p>Maize data. Mean Pearson&#x02019;s correlation for each environments-trait combination for the MTDL and GBLUP models. The top horizontal sub-panel corresponds to the model with genotype<inline-formula><mml:math id="me99"><mml:mo>&#x02009;</mml:mo><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction (I), and the bottom horizontal sub-panel corresponds to the same model without genotype<inline-formula><mml:math id="me100"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction (WI).</p></caption><graphic xlink:href="3829f1"/></fig></sec><sec id="s14"><title>Wheat data set 2</title><p>Next we describe the prediction performance of the BMTME model without genotype<inline-formula><mml:math id="me101"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction (WI). In terms of Pearson&#x02019;s correlation, the range of predictions under this model was from -0.140 to 1.00 (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Under the MTDL model without the interaction term, the predictions ranged from 0.613 to 1.00 and are given in <xref ref-type="fig" rid="fig2">Figure 2</xref>. When genotype<inline-formula><mml:math id="me102"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction (I) was considered under the BMTME model, the range of Pearson&#x02019;s correlation was from 0.202 to 1.00 (<xref rid="tC.1" ref-type="table">Table C1</xref>). With the MTDL model the predictions ranged from 0.601 to 1.00 (<xref ref-type="fig" rid="fig2">Figure 2</xref>).</p><fig id="fig2" fig-type="figure" position="float"><label>Figure 2</label><caption><p>Wheat data. Means Pearson&#x02019;s correlation for each environment-trait combination for the MTDL and GBLUP models. The top horizontal sub-panel corresponds to the model with genotype<inline-formula><mml:math id="me103"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction (I), and the bottom horizontal sub-panel corresponds to the same model without genotype<inline-formula><mml:math id="me104"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction (WI).</p></caption><graphic xlink:href="3829f2"/></fig></sec><sec id="s15"><title>Wheat Iranian data set 3</title><p>The prediction performance of the BMTME model without genotype&#x000d7;environment interaction (WI) is presented first. The predictions of this model in terms of Pearson&#x02019;s correlation ranged from 0.331 to 0.763 (<xref ref-type="fig" rid="fig3">Figure 3</xref>). <xref ref-type="fig" rid="fig3">Figure 3</xref> gives also the predictions under the MTDL model without the interaction term for each environment-trait combination; the range of predictions with Pearson&#x02019;s correlation was from 0.574 to 0.784. Next the predictions with genotype&#x000d7;environment interaction (I) are provided. First, under the BMTME model, the range of predictions in terms of Pearson&#x02019;s correlation was from 0.998 to 1.00. The prediction performance of MTDL is shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>, with the interaction term they ranged from 0.738 to 1.00.</p><fig id="fig3" fig-type="figure" position="float"><label>Figure 3</label><caption><p>Iranian data. Mean Pearson&#x02019;s correlation for each environments-trait combination for the MTDL and GBLUP models. The top horizontal sub-panel corresponds to the model with genotype<inline-formula><mml:math id="me107"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction (I), and the bottom horizontal sub-panel corresponds to the same model without genotype<inline-formula><mml:math id="me108"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction (WI).</p></caption><graphic xlink:href="3829f3"/></fig></sec><sec id="s16"><title>Comparing the BMTME model to the MTDL model</title><p>To obtain a meta-picture of the prediction performance of the MTDL model against the BMTME model, we compared the average predictions across environments-traits of the MTDL model <italic>vs.</italic> those of the BMTME model for each data set. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows that when the genotype&#x000d7;environment interaction term was ignored in the three data sets under study, the best predictions were observed under the MTDL model, but when the genotype&#x000d7;environment interaction term was taken into account, the best predictions were obtained with the BMTME model. Finally, upon comparing the predictions for each data set with the four models resulting from the two models (BMTME and MTDL) and the two types of covariates used in the predictor (with and without the interaction term), we found that in maize data set 1, the best prediction of these four models corresponded to the BMTME model with the interaction term; this model was 4.61% better than the second best model, <italic>i.e.</italic>, MTDL without the interaction term. For wheat data set 2, the best prediction corresponded to the MTDL model without the genotype&#x000d7;environment interaction term; this model was 7.31% better than the second best model (BMTME with the interaction term). For the third data set, wheat Iranian data set 3, the best prediction corresponded to the BMTME model with the genotype&#x000d7;environment interaction term; this model was 16.32% better in terms of prediction accuracy than the second best model, MTDL with the interaction term.</p><fig id="fig4" fig-type="figure" position="float"><label>Figure 4</label><caption><p>Mean Pearson&#x02019;s correlation across environments-traits for the GBLUP and MTDL model conducted with (I) and without (WI) genotype<inline-formula><mml:math id="me113"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction for each data set.</p></caption><graphic xlink:href="3829f4"/></fig></sec></sec><sec sec-type="discussion" id="s17"><title>Discussion</title><p>The key objective of GS is to build an accurate prediction model based on training populations consisting of individuals with both genotypic and phenotypic data. For this reason, many univariate prediction models have been built and evaluated in the GS context. However, breeders usually select, at the same time, multiple traits that are often genetically correlated, with correlations that range from weak to strong. For this reason, in this paper we explored MTDL models for selecting candidate genotypes in GS that allow the simultaneous prediction of many traits measured in each experimental unit. We found evidence that MTDL models are very competitive in terms of prediction accuracy compared with BMTME models, since the prediction performance of MTDL models was competitive to that of the BMTME models. In general terms, the best predictions were produced by the BMTME model with the genotype&#x000d7;environment interaction term.</p><sec id="s18"><title>Computation efficiency of MTDL vs. BMTME</title><p>Additionally, we found that the MTDL model is more computational efficiency than the BMTME model since for the maize and wheat data set, on average the MTDL was 11.71 and 3.39 times faster, respectively, than the BMTME model. For the maize data set the BMTME model required 42.222 hr for its implementation, whereas the MTDL only required 3.604 hr. For the wheat set BMTME required around 13.86 hr, while the MTME model only need 4.079 hr. However, it is important to point out that this difference can be due to the fact that the MTDL model automatically parallelized the jobs and its efficiency depends on the number of available cores. Furthermore, when comparing the BMTME model with the univariate Bayesian GBLUP model the BMTME model is considerable more demanding in terms of implementation time; however, we have not performed a formal comparison in this respect.</p></sec><sec id="s19"><title>Models Without genotype&#x000d7;environment interaction</title><p>For the three data sets, when genotype&#x000d7;environment interaction was ignored in both models, the best predictions were observed with the MTDL models compared to the BMTME model. This can be explained in part by the fact that DL models use hidden layers that automatically capture complex interaction terms without the need to pre-specify <italic>a priori</italic> covariates that include the interaction terms. This means that, unlike the BMTME model (and most statistical mixed models), DL models can capture not only two- or three-way interaction terms, but also interactions of larger order without the need to specify in the predictor the covariates corresponding to these interactions. However, the interpretability of DL models is not as transparent nor as easy as the interpretability of some genomic models such as the GBLUP and BMTME.</p></sec><sec id="s20"><title>Models With genotype&#x000d7;environment interaction</title><p>We found that in the three data sets when taking into account genotype<inline-formula><mml:math id="me118"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction in both models, the BMTME model was better than the MTDL model in terms of prediction accuracy. This means that although we found evidence that the MTDL model was very competitive in terms of prediction accuracy, the BMTME model was superior. Our results indicate that conventional prediction models based on mixed models (the BMTME model, in our case) are very powerful tools, with the advantage that they offer a transparent building process and interpretability, and avoid the time consuming and tedious task of tuning the hyperparameters that DL models need. However, we need to point out that our results are valid only for the hyperparameters used in this research.</p></sec><sec id="s21"><title>General comments</title><p>The performance of the MTDL model depends on the set of hyperparameters used; these hyperparameters are data dependent, which was corroborated in the three data sets used in this research. These different combinations of hyperparameters for each data set corroborate the difficulties found when choosing an appropriate set of hyperparameters in the implementation of MTDL models and of course we are aware that exploring other sets of hyperparameters the prediction of the MTDL model can be improved.</p><p>It is important to point out that the models (MTDL and BMTME) used in this research are only appropriate for multiple continuous traits; of course, each trait can be on a different scale. However, to successfully implement both models, we recommend rescaling the response variable for each training data set and, after getting the corresponding predictions for each testing set, transforming each variable back to its original scale. There are many ways to rescale the variables, but we used the standardization method (subtracting the mean and dividing by the standard deviation). However, other types of rescaling methods can be implemented and many times produce similar results in terms of prediction accuracy. The rescaling process is more important in DL models than in the BMTME model, since the BMTME works well even when the traits are in different scales.</p><p>One possible explanation for why multi-trait models often perform better than univariate models is that they effectively increase the sample size that is used to train the models. As different traits have different noise patterns, a model that learns two or more traits simultaneously is able to learn a more general representation. Learning just trait A bears the risk of overfitting to trait A, while learning A and B jointly enables the model to obtain a better representation by averaging the noise patterns.</p><p>Some explanations of why MTDL models are less efficient in terms of prediction accuracy than BMTME models are: (a) it is documented that DL in general requires a large amount of data for training to be successful, (b) MTDL models do not have a strong known theoretical foundation, (c) determining the architecture and the hyperparameters for DL is a challenging process and the way to proceed so far is just by trial and error, with no theory to guide the researcher, (d) lack of interpretation of results is indeed a problem, and (e) the system is prone to overfitting the training data. However, DL models also have some advantages: (a) they are easy to adapt to classification or numeric prediction problems, (b) they are capable of modeling more complex patterns than nearly any algorithm with less intense computer requirements, (c) they make few assumptions about the data&#x02019;s underlying relationships, and (d) they are easy to adapt from univariate trait analysis to multi-trait analysis even with mixed phenotypes (binary, ordinal and continuous).</p><p>Finally, we would like to point out that our results are valid under a densely connected network architecture with the grid of hyperparameters used in the 108 experiments conducted. For this reason, we believe that with other types of network architecture and hyperparameters, it would be possible to achieve a better performance in terms of prediction accuracy of the MTDL models. For these reasons, we encourage conducting other studies to evaluate MTDL models in the context of genomic selection while exploring other network architectures and sets of hyperparameters.</p></sec></sec><sec sec-type="conclusions" id="s22"><title>Conclusions</title><p>In this paper we propose using MTDL models for prediction in genomic selection. We found that the best predictions correspond to the BMTME model, but the predictions of the MTDL model were very competitive with those of the BMTME model, since in one of the three data sets, the prediction accuracy of the MTDL model was better than that of the BMTME model. We also found that the MTDL model performed better when the covariates corresponding to genotype&#x000d7;environment interaction were ignored. The implementation of the MTDL model also required less computational resources than the BMTME model. For these reasons, we have empirical evidence in favor of the MTDL model and suggest including these models in the toolkit of breeding scientists for predicting multiple traits simultaneously in GS. Although training the MTDL models is challenging due to the number of hyperparameters involved, we found that implementing MTDL models is feasible and practical in the GS context. However, more research is needed to increase the reliability of our findings.</p></sec></body><back><ack><title>Acknowledgments</title><p>We thank all scientists, field workers, and lab assistances from National Programs and CIMMYT who collected the data used in this study. We thank financial support from CIMMYT CRP (maize and wheat), Bill and Melinda Gates Foundation as well the USAID projects (Cornell University and Kansas State University) that generated the CIMMYT maize and wheat data analyzed in this study. Funding for this work was received from the Foundation for Research Levy on Agricultural Products (FFL) and the Agricultural Agreement Research Fund (JA) in Norway through NFR grant 267806. The authors highly appreciate Dr. Emma Huang and anonymous reviewers for their time reading, correcting and suggesting changes that substantially improved the quality and readability of the article.</p><p><italic>Note added in proof:</italic> See Montesinos-L&#x000f3;pez et al. 2018 (pp. 3813&#x02013;3828) in this issue, for a related work.</p></ack><fn-group><fn id="fn1"><p>Communicating editor: E. Huang</p></fn></fn-group><app-group><app><title>APPENDIX A</title><sec id="s23"><title>Setting the hyperparameters for the prior distributions of the BMTME model</title><p>The hyperparameters for the BMTME model were set similar to those used in the BGLR software (<xref rid="bib39" ref-type="bibr">P&#x000e9;rez and de los Campos, 2014</xref>). These rules provide proper but weakly informative prior distributions so that we partitioned the total variance-covariance of the phenotypes into two components: (1) the error and (2) the linear predictor. First we provide the variance-covariance of the phenotypes<disp-formula id="eqB.1"><mml:math id="me120"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02297;</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>1</mml:mn><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><label>(B1)</label></disp-formula>Therefore, the variance-covariance of row <inline-formula><mml:math id="me121"><mml:mi>i</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="me122"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="me123"><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:math></inline-formula> is equal to<disp-formula id="eqB.2"><mml:math id="me124"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math><label>(B2)</label></disp-formula>Therefore, the average of the <inline-formula><mml:math id="me125"><mml:mi>n</mml:mi></mml:math></inline-formula> rows of equation (B2), called total variance, is equal to<disp-formula id="eq___1"><mml:math id="me126"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula><disp-formula id="eq___2"><mml:math id="me127"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula><disp-formula id="eqB.3"><mml:math id="me128"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math><label>(B3)</label></disp-formula>where: <inline-formula><mml:math id="me129"><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me130"><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me131"><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, and</p><disp-formula id="eqB.4"><mml:math id="me132"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><label>(B4)</label></disp-formula><disp-formula id="eqB.5"><mml:math id="me133"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><label>(B5)</label></disp-formula><disp-formula id="eqB.6"><mml:math id="me134"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><label>(B6)</label></disp-formula><sec id="s24"><title>Setting the hyperparameters for <inline-formula><mml:math id="me135"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>:</title><p>Since <inline-formula><mml:math id="me136"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>)=<inline-formula><mml:math id="me137"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and mode<inline-formula><mml:math id="me138"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="me139"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Therefore, from equation (B4),<disp-formula id="eqB.7"><mml:math id="me140"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><label>(B7)</label></disp-formula>Thus, if we replace the left-hand side of equation (B7) with the mode of <inline-formula><mml:math id="me141"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, then<disp-formula id="eqB.8"><mml:math id="me142"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><label>(B8)</label></disp-formula>From (B8) and solving we get <inline-formula><mml:math id="me143"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Then by setting <inline-formula><mml:math id="me144"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> as the proportion of the total variance-covariance (<inline-formula><mml:math id="me145"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) that is explained <italic>a priori</italic> by the traits, <inline-formula><mml:math id="me146"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we have that<disp-formula id="eqB.9"><mml:math id="me147"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>y</mml:mi></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><label>(B9)</label></disp-formula>Once we set <inline-formula><mml:math id="me149"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, we can set <inline-formula><mml:math id="me150"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as in (B9) and we only need to compute the phenotypic variance-covariance matrix (<inline-formula><mml:math id="me151"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), <inline-formula><mml:math id="me152"><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and set <inline-formula><mml:math id="me153"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> as the proportion of variance-covariance that is explained <italic>a priori</italic> by the traits. We set as default <inline-formula><mml:math id="me154"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s25"><title>Setting the hyperparameters for <inline-formula><mml:math id="me155"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi mathvariant="bold-italic">t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:</title><p>Also, since <inline-formula><mml:math id="me156"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:math></inline-formula><inline-formula><mml:math id="me157"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and mode<inline-formula><mml:math id="me158"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="me159"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and using equation (B5) and (B6), in a similar way as before<disp-formula id="eqB.10"><mml:math id="me160"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><label>(B10)</label></disp-formula>Thus, if we replace the left-hand side of equation (B10) with the mode of <inline-formula><mml:math id="me161"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, then<disp-formula id="eqB.11"><mml:math id="me162"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><label>(B11)</label></disp-formula>From (B11) and solving for <inline-formula><mml:math id="me163"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, then<disp-formula id="eqB.12"><mml:math id="me164"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>y</mml:mi></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>y</mml:mi></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><label>(B12)</label></disp-formula>for which we only need to compute the phenotypic variance-covariance matrix (<inline-formula><mml:math id="me165"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), <inline-formula><mml:math id="me166"><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="me167"><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and set <inline-formula><mml:math id="me168"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="me169"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> as the proportion of variance-covariance that <italic>a priori</italic> is explained by the traits in the genotype<inline-formula><mml:math id="me170"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>trait and genotype<inline-formula><mml:math id="me171"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment<inline-formula><mml:math id="me172"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>trait interaction terms. We set as default <inline-formula><mml:math id="me173"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>. In the balanced case, <inline-formula><mml:math id="me174"><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mtext>E</mml:mtext></mml:msub><mml:mo>&#x02297;</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mtext>E</mml:mtext></mml:msub><mml:mo>&#x02297;</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mtext>E</mml:mtext></mml:msub><mml:mo>&#x02297;</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>G</mml:mi></mml:mstyle><mml:mo>)</mml:mo></mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mtext>E</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, so to complete the setting value of <inline-formula><mml:math id="me175"><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, we take <inline-formula><mml:math id="me176"><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mtext>E</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>3</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me177"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the phenotypic variance of trait <inline-formula><mml:math id="me178"><mml:mi>l</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s26"><title>Setting the hyperparameters for <inline-formula><mml:math id="me179"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi mathvariant="bold-italic">E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:</title><p>Also, since <inline-formula><mml:math id="me180"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:math></inline-formula><inline-formula><mml:math id="me181"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>I</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and mode<inline-formula><mml:math id="me182"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="me183"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Let<inline-formula><mml:math id="me184"><mml:mrow><mml:mo>&#x000a0;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>y</mml:mi><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be the variance-covariance matrix of the matrix of phenotypic responses, <inline-formula><mml:math id="me185"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, that resulted from accommodating the information of the matrix of phenotypic responses (<inline-formula><mml:math id="me186"><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:math></inline-formula>) of order <inline-formula><mml:math id="me187"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="me188"><mml:mi>n</mml:mi></mml:math></inline-formula> = IJ, as a matrix of order <inline-formula><mml:math id="me189"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mo>&#x000d7;</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="me190"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, that is, the columns of <inline-formula><mml:math id="me191"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> correspond to environments instead of traits as in <inline-formula><mml:math id="me192"><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:math></inline-formula>. Then, in similar fashion, we can define<disp-formula id="eqB.13"><mml:math id="me193"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><label>(B13)</label></disp-formula>Thus, if we replace the left-hand side of equation (B13) with the mode of <inline-formula><mml:math id="me194"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, then<disp-formula id="eqB.14"><mml:math id="me195"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><label>(B14)</label></disp-formula>from (B14) and solving for <inline-formula><mml:math id="me196"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, then<disp-formula id="eqB.15"><mml:math id="me197"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>y</mml:mi><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><label>(B15)</label></disp-formula>with <inline-formula><mml:math id="me198"><mml:mrow><mml:mi>M</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>&#x02297;</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p></sec><sec id="s27"><title>Setting the hyperparameters for <inline-formula><mml:math id="me199"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi mathvariant="bold-italic">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:</title><p>Also, since <inline-formula><mml:math id="me200"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>)=<inline-formula><mml:math id="me201"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and mode<inline-formula><mml:math id="me202"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="me203"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Therefore, in similar fashion to the above hyperparameters, we set</p><disp-formula id="eqB.16"><mml:math id="me204"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>y</mml:mi></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><label>(B16)</label></disp-formula></sec></sec></app><app><title>APPENDIX B</title><sec id="s28"><title>R code for implementing MTDL models</title><p>setwd(&#x0201c;C:/TELEMATICA 2017/Deep Learning Multi-trait&#x0201d;)</p><p>rm(list = ls())</p><p>######Libraries required#################################</p><p>library(tensorflow)</p><p>library(keras)</p><p>#############Loading data################################</p><p>load(&#x0201c;Data_Maize_set_1.RData&#x0201d;)</p><p>ls()</p><p>####Genomic relationship matrix (GRM)) and phenotipic data######</p><p>G=G_maize_1to3</p><p>Pheno=Pheno_maize_1to3</p><p>head(Pheno)</p><p>###########Cholesky decomposition of the GRM######</p><p>LG=t(chol(G))</p><p>########Creating the desing matrices #################</p><p>Z1=model.matrix(&#x0223c;0+as.factor(Pheno$Line))</p><p>ZE=model.matrix(&#x0223c;0+as.factor(Pheno$Env))</p><p>Z1G=Z1%*%LG</p><p>Z2GE=model.matrix(&#x0223c;0+as.factor(Pheno$Line):as.factor(Pheno$Env))</p><p>G=data.matrix(G)</p><p>G2=kronecker(diag(3),G)</p><p>LG2=t(chol(G2))</p><p>Z2GE=Z2GE%*%LG2</p><p>###Defining the number of epoch and units#####################</p><p>units_M=50</p><p>epochs_M=50</p><p>##########Data for trait GY#################################</p><p>y = Pheno[,3:5]</p><p>X = cbind(ZE,Z1G,Z2GE)</p><p>head(y)</p><p>#############Training and testing sets###################</p><p>n=dim(X)[1]</p><p>nt=dim(y)[2]</p><p>Post_trn=sample(1:n,round(n*0.8))</p><p>X_tr = X[Post_trn,]</p><p>X_ts = X[-Post_trn,]</p><p>y_tr = scale(y[Post_trn,])</p><p>Mean_trn=apply(y[Post_trn,],2,mean)</p><p>SD_trn=apply(y[Post_trn,],2,sd)</p><p>y_ts=matrix(NA,ncol=nt,nrow=dim(X_ts)[1])</p><p>for (t in 1:nt){</p><p>y_ts[,t] =(y[-Post_trn,t]- Mean_trn[t])/SD_trn[t] }</p><p># add covariates (independent variables)</p><p>input &#x0003c;- layer_input(shape=dim(X_tr)[2],name=&#x0201c;covars&#x0201d;)</p><p># add hidden layers</p><p>base_model &#x0003c;- input %&#x0003e;%</p><p>layer_dense(units =units_M, activation=&#x02019;relu&#x02019;) %&#x0003e;%</p><p>layer_dropout(rate = 0.3) %&#x0003e;%</p><p>layer_dense(units = units_M, activation = &#x0201c;relu&#x0201d;) %&#x0003e;%</p><p>layer_dropout(rate = 0.3) %&#x0003e;%</p><p>layer_dense(units = units_M, activation = &#x0201c;relu&#x0201d;) %&#x0003e;%</p><p>layer_dropout(rate = 0.3)</p><p># add output 1</p><p>yhat1 &#x0003c;- base_model %&#x0003e;%</p><p>layer_dense(units = 1, name=&#x0201c;yhat1&#x0201d;)</p><p># add output 2</p><p>yhat2 &#x0003c;- base_model %&#x0003e;%</p><p>layer_dense(units = 1, name=&#x0201c;yhat2&#x0201d;)</p><p># add output 3</p><p>yhat3 &#x0003c;- base_model %&#x0003e;%</p><p>layer_dense(units = 1, name=&#x0201c;yhat3&#x0201d;)</p><p># build multi-output model</p><p>model &#x0003c;- keras_model(input,list(yhat1,yhat2,yhat3)) %&#x0003e;%</p><p>compile(optimizer = &#x0201c;rmsprop&#x0201d;,</p><p>loss=&#x0201d;mse&#x0201d;,</p><p>metrics=&#x0201d;mae&#x0201d;,</p><p>loss_weights=c(0.3333,0.3333,0.3333))</p><p># fit model</p><p>model_fit &#x0003c;- model %&#x0003e;%</p><p>fit(x=X_tr,</p><p>y=list(y_tr[,1],y_tr[,2],y_tr[,3]),</p><p>epochs=epochs_M,</p><p>batch_size = 50,</p><p>verbose=0)</p><p># predict values for test set</p><p>Yhat &#x0003c;- predict(model, X_ts) %&#x0003e;%</p><p>data.frame() %&#x0003e;%</p><p>setNames(colnames(y_tr))</p><p>predB=Yhat</p><p>y_p=predB</p><p>for (s in 1:nt){</p><p>y_p[,s]=y_p[,s]*SD_trn[s]+ Mean_trn[s]</p><p>y_ts[,s]=y_ts[,s]*SD_trn[s]+ Mean_trn[s]</p><p>}</p><p>#################Observed and predicted values############</p><p>Y_all_tst = data.frame(cbind(y_ts, y_p))</p><p>Y_all_tst</p><p>########Prediciton accuracy with Pearson Correlation######</p><p>Cor_Mat=cor(Y_all_tst)</p><p>Cor_Traits=diag(Cor_Mat[(nt+1):(2*nt),1:nt])</p><p>Cor_Traits</p><p>########Plots of observed and predicted values############</p><p>plot(Y_all_tst[,1],Y_all_tst[,4])</p><p>plot(Y_all_tst[,2],Y_all_tst[,5])</p><p>plot(Y_all_tst[,3],Y_all_tst[,6])</p></sec></app><app><title>APPENDIX C</title><sec id="s29"><title/><table-wrap id="tC.1" position="anchor"><label>Table C1.</label><caption><title>Standard errors (SE) of both models, BMTME and MTDL for each data set. WI denotes the scenarios that ignore the genotype<inline-formula><mml:math id="me205"><mml:mo>&#x000d7;</mml:mo></mml:math></inline-formula>environment interaction term, while I denotes the scenarios with the genotype<inline-formula><mml:math id="me206"><mml:mrow><mml:mo>&#x000d7;</mml:mo></mml:mrow></mml:math></inline-formula>environment interaction term. Env_Trait denotes the environment-trait combination</title></caption><table frame="border" rules="groups"><col width="8.28%" span="1"/><col width="20.48%" span="1"/><col width="12.61%" span="1"/><col width="10.92%" span="1"/><col width="12.61%" span="1"/><col width="11.1%" span="1"/><col width="12.61%" span="1"/><col width="11.39%" span="1"/><thead><tr><th valign="bottom" align="left" scope="col" rowspan="1" colspan="1"/><th valign="bottom" align="left" scope="col" rowspan="1" colspan="1"/><th valign="bottom" align="center" scope="colgroup" colspan="2" rowspan="1">Maize</th><th valign="bottom" colspan="2" align="center" scope="colgroup" rowspan="1">Wheat</th><th valign="bottom" colspan="2" align="center" scope="colgroup" rowspan="1">Iranian Wheat</th></tr><tr><th valign="bottom" align="center" scope="col" rowspan="1" colspan="1">Type</th><th valign="bottom" align="center" scope="col" rowspan="1" colspan="1">Env_Trait</th><th valign="bottom" align="center" scope="col" rowspan="1" colspan="1">BMTME</th><th valign="bottom" align="center" scope="col" rowspan="1" colspan="1">MTDL</th><th valign="bottom" align="center" scope="col" rowspan="1" colspan="1">BMTME</th><th valign="bottom" align="center" scope="col" rowspan="1" colspan="1">MTDL</th><th valign="bottom" align="center" scope="col" rowspan="1" colspan="1">BMTME</th><th valign="bottom" align="center" scope="col" rowspan="1" colspan="1">MTDL</th></tr></thead><tbody><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">WI</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env1_Trait_1</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.042</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.046</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.022</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.031</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.014</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.025</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">WI</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env1_Trait_2</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.047</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.030</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.052</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.061</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.018</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.033</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">WI</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env1_Trait_3</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.051</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.048</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">WI</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env2_Trait_1</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.045</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.048</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.013</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.020</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.018</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.029</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">WI</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env2_Trait_2</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.032</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.055</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.032</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.041</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.028</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.030</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">WI</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env2_Trait_3</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.036</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.052</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">WI</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env3_Trait_1</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.030</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.058</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.018</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.027</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">WI</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env3_Trait_2</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.046</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.053</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.027</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.039</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">WI</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env3_Trait_3</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.054</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.044</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">I</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env1_Trait_1</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.027</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.046</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.021</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.041</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.008</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.025</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">I</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env1_Trait_2</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.029</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.029</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.059</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.054</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.006</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.030</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">I</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env1_Trait_3</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.026</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.036</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">I</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env2_Trait_1</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.032</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.042</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.019</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.023</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.013</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.030</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">I</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env2_Trait_2</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.035</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.062</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.025</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.041</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.007</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.030</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">I</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env2_Trait_3</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.038</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.042</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">I</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env3_Trait_1</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.026</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.049</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.018</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.038</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">I</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env3_Trait_2</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.041</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.051</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.020</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.045</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td></tr><tr><td valign="bottom" align="left" scope="row" rowspan="1" colspan="1">I</td><td valign="bottom" align="left" rowspan="1" colspan="1">Env3_Trait_3</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.040</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.034</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td><td valign="bottom" align="center" rowspan="1" colspan="1">&#x02014;</td></tr></tbody></table></table-wrap></sec></app></app-group><ref-list><title>Literature Cited</title><ref id="bib1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alipanahi</surname><given-names>B.</given-names></name><name><surname>Delong</surname><given-names>A.</given-names></name><name><surname>Weirauch</surname><given-names>M. T.</given-names></name><name><surname>Frey</surname><given-names>B. J.</given-names></name></person-group>, <year>2015</year>&#x02003;<article-title>Predicting the sequence specificities of DNA- and RNA-binding proteins by deep learning.</article-title>
<source>Nat. Biotechnol.</source>
<volume>33</volume>: <fpage>831</fpage>&#x02013;<lpage>838</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3300</pub-id><pub-id pub-id-type="pmid">26213851</pub-id></mixed-citation></ref><ref id="bib2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angermueller</surname><given-names>C.</given-names></name><name><surname>Lee</surname><given-names>H.J.</given-names></name><name><surname>Reik</surname><given-names>W.</given-names></name><name><surname>Stegle</surname><given-names>O.</given-names></name></person-group>
<year>2017</year> &#x02003;DeepCpG: accurate prediction of single-cell DNA methylation states using deep learning. Genome Biology, 18:1:13.</mixed-citation></ref><ref id="bib3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertan</surname><given-names>I.</given-names></name><name><surname>Carvalho</surname><given-names>F. I. F.</given-names></name><name><surname>Oliveira</surname><given-names>A. C.</given-names></name><name><surname>Silva</surname><given-names>J. A. G.</given-names></name><name><surname>Benin</surname><given-names>G.</given-names></name><etal/></person-group>, <year>2009</year>&#x02003;<article-title>Efeitos da heterose e endogamia em caracteres de import&#x000e2;ncia agron&#x000f4;mica em trigo.</article-title>
<source>Rev. Ceres</source>
<volume>56</volume>: <fpage>753</fpage>&#x02013;<lpage>763</lpage>.</mixed-citation></ref><ref id="bib4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calus</surname><given-names>M. P.</given-names></name><name><surname>Veerkamp</surname><given-names>R. F.</given-names></name></person-group>, <year>2011</year>&#x02003;<article-title>Accuracy of multi-trait genomic selection using different methods. Genetics, Selection</article-title>. <source>Evolution&#x0202f;: GSE</source>
<volume>43</volume>: <fpage>26</fpage>
<pub-id pub-id-type="doi">10.1186/1297-9686-43-26</pub-id></mixed-citation></ref><ref id="bib5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castro</surname><given-names>A. F. N. M.</given-names></name><name><surname>Castro</surname><given-names>R. V. O.</given-names></name><name><surname>Oliveira</surname><given-names>A. C. O.</given-names></name><name><surname>Lima</surname><given-names>J. E.</given-names></name><name><surname>Santos</surname><given-names>R. C.</given-names></name><etal/></person-group>, <year>2013</year>&#x02003;<article-title>Multivariate analysis for the selection of eucalyptus clones destined for charcoal production.</article-title>
<source>Pesqui. Agropecu. Bras.</source>
<volume>48</volume>: <fpage>627</fpage>&#x02013;<lpage>635</lpage>. <pub-id pub-id-type="doi">10.1590/S0100-204X2013000600008</pub-id></mixed-citation></ref><ref id="bib6"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chollet</surname><given-names>F.</given-names></name><name><surname>Allaire</surname><given-names>J. J.</given-names></name></person-group>, <year>2017</year>&#x02003;<source><italic>Deep Learning with R. Manning Publications</italic>, <italic>Manning Early Access Program</italic></source>, <edition>Ed. 1st</edition>
<publisher-name>MEA</publisher-name>, <publisher-loc>New Delhi, India</publisher-loc>.</mixed-citation></ref><ref id="bib7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colleau</surname><given-names>J. J.</given-names></name><name><surname>Fritz</surname><given-names>S.</given-names></name><name><surname>Guillaume</surname><given-names>F.</given-names></name><name><surname>Baur</surname><given-names>A.</given-names></name><name><surname>Dupassieux</surname><given-names>D.</given-names></name><etal/></person-group>, <year>2009</year>&#x02003;<article-title>Simulating the potential of genomic selection in dairy cattle breeding. Rencontres, Recherches</article-title>. <source>Ruminants</source>
<volume>16</volume>: <fpage>419</fpage>.</mixed-citation></ref><ref id="bib8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Beyene</surname><given-names>Y.</given-names></name><name><surname>Kassa</surname><given-names>S.</given-names></name><name><surname>P&#x000e9;rez-Rodr&#x000ed;guez</surname><given-names>P.</given-names></name><name><surname>Hickey</surname><given-names>J.M.</given-names></name><etal/></person-group>
<italic>et al</italic>
<year>2013</year> &#x02003;Genomic prediction in maize breeding populations with genotyping-by-sequencing. G3: Genes|Genomes|Genetics (Bethesda) 3, <fpage>1903</fpage>&#x02013;<lpage>1926</lpage>. <pub-id pub-id-type="doi">10.1534/g3.113.008227</pub-id></mixed-citation></ref><ref id="bib9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Jarqu&#x000ed;n</surname><given-names>D.</given-names></name><name><surname>Franco</surname><given-names>J.</given-names></name><name><surname>P&#x000e9;rez-Rodr&#x000ed;guez</surname><given-names>P.</given-names></name><name><surname>Burgue&#x000f1;o</surname><given-names>J.</given-names></name><etal/></person-group>
<year>2016</year> &#x02003;Genomic Prediction of Gene Bank Wheat Landraces. G3: Genes|Genomes|Genetics (Bethesda) 6, <fpage>1819</fpage>&#x02013;<lpage>1834</lpage>. <pub-id pub-id-type="doi">10.1534/g3.116.029637</pub-id></mixed-citation></ref><ref id="bib10"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Everitt</surname><given-names>B. S.</given-names></name><name><surname>Dunn</surname><given-names>G.</given-names></name></person-group>, <year>1992</year>&#x02003;<source>Applied Multivariate Data Analysis</source>, <publisher-name>Oxford University Press</publisher-name>, <publisher-loc>New York, NY</publisher-loc>.</mixed-citation></ref><ref id="bib11"><mixed-citation publication-type="confproc"><comment>Fox, I., A. Lynn, J. Mamta, P.-B. Rodica, and W. Jenna, 2018&#x02003; Deep Multi-Output Forecasting: Learning to Accurately Predict Blood Glucose Trajectories. In KDD &#x02019;18: The 24th ACM SIGKDD International Conference on Knowledge Discovery &#x00026; Data Mining, August 19&#x02013;23, 2018, London, UK. ACM, New York, NY, USA</comment>
<pub-id pub-id-type="doi">10.1145/3219819</pub-id></mixed-citation></ref><ref id="bib12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilmour</surname><given-names>A.</given-names></name><name><surname>Thompson</surname><given-names>R.</given-names></name><name><surname>Cullis</surname><given-names>B.</given-names></name></person-group>, <year>1995</year>&#x02003;<article-title>Average Information REML: An Efficient Algorithm for Variance Parameter Estimation in Linear Mixed Models.</article-title>
<source>Biometrics</source>
<volume>51</volume>: <fpage>1440</fpage>&#x02013;<lpage>1450</lpage>. <pub-id pub-id-type="doi">10.2307/2533274</pub-id></mixed-citation></ref><ref id="bib13"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gulli</surname><given-names>A.</given-names></name><name><surname>Sujit</surname><given-names>P.</given-names></name></person-group>, <year>2017</year>&#x02003;<source>Deep Learning with Keras: Implementing deep learning models and neural networks with the power of Python</source>, <publisher-name>Packt Publishing Ltd.</publisher-name>, <publisher-loc>Birmingham, UK</publisher-loc>.</mixed-citation></ref><ref id="bib14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>D.</given-names></name><name><surname>Kuhn</surname><given-names>D.</given-names></name><name><surname>Parida</surname><given-names>L.</given-names></name></person-group>, <year>2016</year>&#x02003;<article-title>Novel applications of multitask learning and multiple output regression to multiple genetic trait prediction.</article-title>
<source>Bioinformatics</source>
<volume>32</volume>: <fpage>i37</fpage>&#x02013;<lpage>i43</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw249</pub-id><pub-id pub-id-type="pmid">27307640</pub-id></mixed-citation></ref><ref id="bib15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>M.</given-names></name><name><surname>Chen</surname><given-names>L.</given-names></name><name><surname>Chen</surname><given-names>Z.</given-names></name></person-group>
<year>2015</year> &#x02003;Diallel analysis of combining ability and heterosis for yield and yield components in rice by using positive loci. Euphytica, 205: 3 7&#x02013;50.</mixed-citation></ref><ref id="bib16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jarqu&#x000ed;n</surname><given-names>D.</given-names></name><name><surname>Lemes da Silva</surname><given-names>C.</given-names></name><name><surname>Gaynor</surname><given-names>R. C.</given-names></name><name><surname>Poland</surname><given-names>J.</given-names></name><name><surname>Fritz</surname><given-names>A.</given-names></name><etal/></person-group>, <year>2017</year>&#x02003;<article-title>Increasing Genomic-Enabled Prediction Accuracy by Modeling Genotype &#x000d7; Environment Interactions in Kansas Wheat.</article-title>
<source>Plant Genome</source>
<volume>10</volume>: <fpage>1</fpage>&#x02013;<lpage>15</lpage>. <pub-id pub-id-type="doi">10.3835/plantgenome2016.12.0130</pub-id></mixed-citation></ref><ref id="bib17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>Y.</given-names></name><name><surname>Jannink</surname><given-names>J.-L.</given-names></name></person-group>, <year>2012</year>&#x02003;<article-title>Multiple-Trait Genomic Selection Methods Increase Genetic Value Prediction Accuracy.</article-title>
<source>Genetics</source>
<volume>192</volume>: <fpage>1513</fpage>&#x02013;<lpage>1522</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.112.144246</pub-id><pub-id pub-id-type="pmid">23086217</pub-id></mixed-citation></ref><ref id="bib18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>J.</given-names></name><name><surname>Zhang</surname><given-names>Q.</given-names></name><name><surname>Ma</surname><given-names>L.</given-names></name><name><surname>Li</surname><given-names>J.</given-names></name><name><surname>Wang</surname><given-names>Z.</given-names></name><etal/></person-group>, <year>2015</year>&#x02003;<article-title>Joint prediction of multiple quantitative traits using a Bayesian multivariate antedependence model.</article-title>
<source>Heredity</source>
<volume>115</volume>: <fpage>29</fpage>&#x02013;<lpage>36</lpage>. <pub-id pub-id-type="doi">10.1038/hdy.2015.9</pub-id><pub-id pub-id-type="pmid">25873147</pub-id></mixed-citation></ref><ref id="bib19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>L&#x000f3;pez-Cruz</surname><given-names>M.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Bonnett</surname><given-names>D.</given-names></name><name><surname>Dreisigacker</surname><given-names>S.</given-names></name></person-group>, Poland, <italic>et al</italic>
<year>2015</year> &#x02003;Increased prediction accuracy in wheat breeding trials using a marker &#x000d7; environment interaction genomic selection model. G3: Genes|Genomes|Genetics (Bethesda), 5: <fpage>569</fpage>&#x02013;<lpage>82</lpage>. <pub-id pub-id-type="doi">10.1534/g3.114.016097</pub-id></mixed-citation></ref><ref id="bib20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menden</surname><given-names>M. P.</given-names></name><name><surname>Iorio</surname><given-names>F.</given-names></name><name><surname>Garnett</surname><given-names>M.</given-names></name><name><surname>McDermott</surname><given-names>U.</given-names></name><name><surname>Benes</surname><given-names>C. H.</given-names></name><etal/></person-group>, <year>2013</year>&#x02003;<article-title>Machine learning prediction of cancer cell sensitivity to drugs based on genomic and chemical properties.</article-title>
<source>PLoS One</source>
<volume>8</volume>: <fpage>e61318</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0061318</pub-id><pub-id pub-id-type="pmid">23646105</pub-id></mixed-citation></ref><ref id="bib21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montesinos-L&#x000f3;pez</surname><given-names>O. A.</given-names></name><name><surname>Montesinos-L&#x000f3;pez</surname><given-names>A.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Toledo</surname><given-names>F.</given-names></name><name><surname>P&#x000e9;rez-Hern&#x000e1;ndez</surname><given-names>O.</given-names></name><etal/></person-group>
<year>2016</year> &#x02003;A Genomic Bayesian Multi-trait and Multi-environment Model. G3: Genes|Genomes|Genetics (Bethesda), 6: <fpage>2725</fpage>&#x02013;<lpage>2744</lpage>. <pub-id pub-id-type="doi">10.1534/g3.116.032359</pub-id></mixed-citation></ref><ref id="bib22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montesinos-L&#x000f3;pez</surname><given-names>A.</given-names></name><name><surname>Montesinos-L&#x000f3;pez</surname><given-names>O. A.</given-names></name><name><surname>Gianola</surname><given-names>D.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Hern&#x000e1;ndez-Su&#x000e1;rez</surname><given-names>C.M.</given-names></name></person-group>
<year>2018</year> &#x02003;Multi-environment genomic prediction of plant traits using deep learners with a dense architecture. G3: Genes|Genomes|Genetics (Bethesda) 8:. <pub-id pub-id-type="doi">10.1534/g3.118.200740</pub-id></mixed-citation></ref><ref id="bib39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>P&#x000e9;rez</surname><given-names>P.</given-names></name><name><surname>de los Campos</surname><given-names>G.</given-names></name></person-group>, <year>2014</year>&#x02003;<article-title>Genome-wide regression &#x00026; prediction with the BGLR statistical package.</article-title>
<source>Genetics</source>
<volume>198</volume>: <fpage>483</fpage>&#x02013;<lpage>495</lpage>.<pub-id pub-id-type="pmid">25009151</pub-id></mixed-citation></ref><ref id="bib23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname><given-names>Y. J.</given-names></name><name><surname>Oja</surname><given-names>M.</given-names></name><name><surname>Weston</surname><given-names>J.</given-names></name><name><surname>Noble</surname><given-names>W. S.</given-names></name></person-group>, <year>2012</year>&#x02003;<article-title>A Unified Multitask Architecture for Predicting Local Protein Properties.</article-title>
<source>PLoS One</source>
<volume>7</volume>: <fpage>e32235</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0032235</pub-id><pub-id pub-id-type="pmid">22461885</pub-id></mixed-citation></ref><ref id="bib24"><mixed-citation publication-type="webpage">R Core Team, 2018. R: A language and environment for statistical computing. R Foundation for Statistical Computing. Vienna. Austria. ISBN 3&#x02013;900051&#x02013;07&#x02013;0. URL <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/">http://www.R-project.org/</ext-link>.</mixed-citation></ref><ref id="bib25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rutkoski</surname><given-names>J.</given-names></name><name><surname>Poland</surname><given-names>J.</given-names></name><name><surname>Mondal</surname><given-names>S.</given-names></name><name><surname>Autrique</surname><given-names>E.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><etal/></person-group>
<year>2016</year> &#x02003;Predictor traits from high-throughput phenotyping improve accuracy of pedigree and genomic selection for yield in wheat. G3: Genes|Genomes|Genetics (Bethesda), 6: <fpage>2799</fpage>&#x02013;<lpage>2808</lpage>. <pub-id pub-id-type="doi">10.1534/g3.116.032888</pub-id></mixed-citation></ref><ref id="bib26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaeffer</surname><given-names>L. R.</given-names></name></person-group>, <year>2001</year>&#x02003;<article-title>Multiple trait international bull comparisons.</article-title>
<source>Livest. Prod. Sci.</source>
<volume>69</volume>: <fpage>145</fpage>&#x02013;<lpage>153</lpage>. <pub-id pub-id-type="doi">10.1016/S0301-6226(00)00255-4</pub-id></mixed-citation></ref><ref id="bib27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulthess</surname><given-names>A. W.</given-names></name><name><surname>Zhao</surname><given-names>Y.</given-names></name><name><surname>Longin</surname><given-names>C. F. H.</given-names></name><name><surname>Reif</surname><given-names>J. C.</given-names></name></person-group>, <year>2017</year>&#x02003;<article-title>Advantages and limitations of multiple-trait genomic prediction for Fusarium head blight severity in hybrid wheat (<italic>Triticum aestivum</italic> L.).</article-title>
<source>Theor. Appl. Genet</source>. <pub-id pub-id-type="doi">10.1007/s00122-017-3029-7</pub-id></mixed-citation></ref><ref id="bib28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spencer</surname><given-names>M.</given-names></name><name><surname>Eickholt</surname><given-names>J.</given-names></name><name><surname>Cheng</surname><given-names>J. L.</given-names></name></person-group>, <year>2015</year>&#x02003;<article-title>A Deep Learning Network Approach to ab initio Protein Secondary Structure Prediction.</article-title>
<source>Ieee Acm T Comput Bi</source>
<volume>12</volume>: <fpage>103</fpage>&#x02013;<lpage>112</lpage>. <pub-id pub-id-type="doi">10.1109/TCBB.2014.2343960</pub-id></mixed-citation></ref><ref id="bib29"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Srivastava</surname><given-names>M. S.</given-names></name><name><surname>Khatri</surname><given-names>C. G.</given-names></name></person-group>, <year>1979</year>&#x02003;<source>An Introduction to Multivariate Statistics.</source>
<publisher-name>Elsevier North Holland</publisher-name>, <publisher-loc>New York, NY, USA</publisher-loc>.</mixed-citation></ref><ref id="bib30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srivastava</surname><given-names>N.</given-names></name><name><surname>Hinton</surname><given-names>G.</given-names></name><name><surname>Krizhevsky</surname><given-names>A.</given-names></name><name><surname>Sutskever</surname><given-names>I.</given-names></name><name><surname>Salakhutdinov</surname><given-names>R.</given-names></name></person-group>, <year>2014</year>&#x02003;<article-title>Dropout: A Simple Way to Prevent Neural Networks from Overfitting.</article-title>
<source>J. Mach. Learn. Res.</source>
<volume>15</volume>: <fpage>1929</fpage>&#x02013;<lpage>1958</lpage>.</mixed-citation></ref><ref id="bib31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>J.</given-names></name><name><surname>Rutkoski</surname><given-names>J.</given-names></name><name><surname>Poland</surname><given-names>J. A.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Jannink</surname><given-names>J. L.</given-names></name><etal/></person-group>, <year>2017</year>&#x02003;<article-title>Multi-trait, random regression, or simply repeatability model in high-throughput phenotyping data improve genomic prediction for grain yield in wheat.</article-title>
<source>Plant Genome</source>
<volume>18</volume>: <fpage>1</fpage>&#x02013;<lpage>12</lpage>. <pub-id pub-id-type="doi">10.3835/plantgenome2016.11.0111</pub-id></mixed-citation></ref><ref id="bib32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tavanaei</surname><given-names>A.</given-names></name><name><surname>Anandanadarajah</surname><given-names>N.</given-names></name><name><surname>Maida</surname><given-names>A. S.</given-names></name><name><surname>Loganantharaj</surname><given-names>R.</given-names></name></person-group>, <year>2017</year>&#x02003;<article-title>A Deep Learning Model for Predicting Tumor Suppressor Genes and Oncogenes from PDB Structure.</article-title>
<source>bioRxiv</source>
<fpage>1</fpage>&#x02013;<lpage>10</lpage>. <pub-id pub-id-type="doi">10.1101/177378</pub-id></mixed-citation></ref><ref id="bib33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>VanRaden</surname><given-names>P. M.</given-names></name></person-group>, <year>2008</year>&#x02003;<article-title>Efficient methods to compute genomic predictions.</article-title>
<source>J. Dairy Sci.</source>
<volume>91</volume>: <fpage>4414</fpage>&#x02013;<lpage>4423</lpage>. <pub-id pub-id-type="doi">10.3168/jds.2007-0980</pub-id><pub-id pub-id-type="pmid">18946147</pub-id></mixed-citation></ref><ref id="bib34"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y.</given-names></name><name><surname>Wipf</surname><given-names>D.</given-names></name><name><surname>Ling</surname><given-names>Q.</given-names></name><name><surname>Chen</surname><given-names>W.</given-names></name><name><surname>Wassell</surname><given-names>I.</given-names></name></person-group>, <year>2015</year> &#x02003;<article-title>Multitask learning for subspace segmentation.</article-title> In <source>ICML</source>, 2015, pp. <fpage>1209</fpage>&#x02013;<lpage>1217</lpage>.</mixed-citation></ref><ref id="bib35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xavier</surname><given-names>A.</given-names></name><name><surname>Hall</surname><given-names>B.</given-names></name><name><surname>Casteel</surname><given-names>S.</given-names></name><name><surname>Muir</surname><given-names>W.</given-names></name><name><surname>Rainey</surname><given-names>K. M.</given-names></name></person-group>, <year>2017</year>&#x02003;<article-title>Using unsupervised learning techniques to assess interactions among complex traits in soybeans.</article-title>
<source>Euphytica</source>
<volume>213</volume>: <fpage>200</fpage>
<pub-id pub-id-type="doi">10.1007/s10681-017-1975-4</pub-id></mixed-citation></ref><ref id="bib36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiong</surname><given-names>T.</given-names></name><name><surname>Bao</surname><given-names>Y.</given-names></name><name><surname>Hu</surname><given-names>Z.</given-names></name></person-group>, <year>2014</year>&#x02003;<article-title>Multiple-output support vector regression with a firefly algorithm for interval-valued stock price index forecasting.</article-title>
<source>Knowl. Base. Syst.</source>
<volume>55</volume>: <fpage>87</fpage>&#x02013;<lpage>100</lpage>. <pub-id pub-id-type="doi">10.1016/j.knosys.2013.10.012</pub-id></mixed-citation></ref><ref id="bib37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>Y.</given-names></name><name><surname>Ricci</surname><given-names>E.</given-names></name><name><surname>Subramanian</surname><given-names>G.</given-names></name><name><surname>Liu</surname><given-names>G.</given-names></name><name><surname>Lanz</surname><given-names>O.</given-names></name><etal/></person-group>, <year>2015</year>&#x02003;<article-title>A multi-task learning framework for head pose estimation under target motion.</article-title>
<source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
<volume>38</volume>: <fpage>1</fpage>&#x02013;<lpage>14</lpage>.</mixed-citation></ref><ref id="bib38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhen</surname><given-names>X.</given-names></name><name><surname>Wang</surname><given-names>Z.</given-names></name><name><surname>Islam</surname><given-names>A.</given-names></name><name><surname>Bhaduri</surname><given-names>M.</given-names></name><name><surname>Chan</surname><given-names>I.</given-names></name><etal/></person-group>, <year>2015</year>&#x02003;<article-title>Multi-scale deep networks and regression forests for direct biventricular volume estimation.</article-title>
<source>Med. Image Anal.</source>
<volume>30</volume>: <fpage>120</fpage>&#x02013;<lpage>129</lpage>. <pub-id pub-id-type="doi">10.1016/j.media.2015.07.003</pub-id><pub-id pub-id-type="pmid">26919699</pub-id></mixed-citation></ref></ref-list></back></article>