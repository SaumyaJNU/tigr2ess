<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Sci Rep</journal-id><journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id><journal-title-group><journal-title>Scientific Reports</journal-title></journal-title-group><issn pub-type="epub">2045-2322</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6134082</article-id><article-id pub-id-type="publisher-id">31899</article-id><article-id pub-id-type="doi">10.1038/s41598-018-31899-0</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Automatic detection and counting of urediniospores of <italic>Puccinia striiformis</italic> f. sp. <italic>tritici</italic> using spore traps and image processing</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Lei</surname><given-names>Yu</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Yao</surname><given-names>Zhifeng</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>He</surname><given-names>Dongjian</given-names></name><address><email>hdj168@nwsuaf.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1760 4150</institution-id><institution-id institution-id-type="GRID">grid.144022.1</institution-id><institution>College of Mechanical and Electronic Engineering, </institution><institution>Northwest A&#x00026;F University, </institution></institution-wrap>Yangling, Shaanxi 712100 China </aff><aff id="Aff2"><label>2</label>Key Laboratory of Agricultural Internet of Things, Ministry of Agriculture and Rural Affairs, Yangling, Shaanxi 712100 China </aff><aff id="Aff3"><label>3</label>Shaanxi Key Laboratory of Agricultural Information Perception and Intelligence Service, Yangling, Shaanxi 712100 China </aff></contrib-group><pub-date pub-type="epub"><day>11</day><month>9</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>11</day><month>9</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>8</volume><elocation-id>13647</elocation-id><history><date date-type="received"><day>21</day><month>9</month><year>2017</year></date><date date-type="accepted"><day>29</day><month>8</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">The quantitative monitoring of airborne urediniospores of <italic>Puccinia striiformis</italic> f. sp. <italic>tritici</italic> (<italic>Pst</italic>) using spore trap devices in wheat fields is an important process for devising strategies early and effectively controlling wheat stripe rust. The traditional microscopic spore counting method mainly relies on naked-eye observation. Because of the great number of trapped spores, this method is labour intensive and time-consuming and has low counting efficiency, sometimes leading to huge errors; thus, an alternative method is required. In this paper, a new algorithm was proposed for the automatic detection and counting of urediniospores of <italic>Pst</italic>, based on digital image processing. First, images of urediniospores were collected using portable volumetric spore traps in an indoor simulation. Then, the urediniospores were automatically detected and counted using a series of image processing approaches, including image segmentation using the <italic>K</italic>-means clustering algorithm, image pre-processing, the identification of touching urediniospores based on their shape factor and area, and touching urediniospore contour segmentation based on concavity and contour segment merging. This automatic counting algorithm was compared with the watershed transformation algorithm. The results show that the proposed algorithm is efficient and accurate for the automatic detection and counting of trapped urediniospores. It can provide technical support for the development of online airborne urediniospore monitoring equipment.</p></abstract><funding-group><award-group><funding-source><institution>The overall innovation project of science and technology of Shaanxi province (No. 2015KTZDNY01-06)</institution></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par2">Wheat stripe (yellow) rust, which is caused by <italic>Puccinia striiformis</italic> f. sp. <italic>tritici</italic> (<italic>Pst</italic>), is a wheat disease that is prevalent across the world, particularly in cool and moist regions<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. It is one of the most important and devastating airborne wheat diseases in China and has caused severe yield reduction, resulting in significant economic loss<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. Urediniospores of <italic>Pst</italic> are heteroecious macro-cyclic rust pathogens that require a living host (wheat/grasses, Berberis/Mahonia spp.) to complete the asexual and sexual phases of their life cycle<sup><xref ref-type="bibr" rid="CR4">4</xref>&#x02013;<xref ref-type="bibr" rid="CR6">6</xref></sup>. Urediniospores maintain the dominant asexual stage of the pathogen population on the primary hosts. This is the main period for the wide-scale stripe rust epidemics reported on wheat<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. Urediniospores have the capacity for long-distance dispersal by wind movement, which may extend to hundreds and perhaps thousands of kilometres from the centre of origin of <italic>Pst</italic><sup><xref ref-type="bibr" rid="CR7">7</xref>&#x02013;<xref ref-type="bibr" rid="CR9">9</xref></sup>. Urediniospores of <italic>Pst</italic> infect wheat as a result of urediniospore deposition by dispersed air or raindrops on the leaf surface<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Therefore, the aerial dispersal of <italic>Pst</italic> urediniospores is the main reason for the occurrence and prevalence of the disease of wheat stripe rust. The occurrence of the disease is closely related to the number of urediniospores in wheat field air. The efficient capturing and quantitative monitoring of urediniospores in the atmosphere of a wheat field can provide critical information for airborne wheat disease prediction.</p><p id="Par3">Because of the improvement and popularization of spore trap devices, airborne fungal spores are commonly collected by these devices<sup><xref ref-type="bibr" rid="CR11">11</xref>&#x02013;<xref ref-type="bibr" rid="CR13">13</xref></sup>. Previous studies have often used them for sampling onto microscope slides or plastic tape, which were coated with a thin film of petroleum jelly and then examined microscopically at hundredfold magnification. The traditional microscopic spore counting method mainly relies on naked-eye observation by professional and technical personnel in the laboratory. Because of the great number of trapped spores, this method is labour-intensive and time-consuming and has low efficiency, sometimes leading to huge errors. Thus, the timely identification and counting of trapped spores is hindered. Studies on the application of molecular-biological techniques to detect and quantify fungus have been reported<sup><xref ref-type="bibr" rid="CR14">14</xref>&#x02013;<xref ref-type="bibr" rid="CR16">16</xref></sup>. However, it is difficult to translate the techniques to practical applications because of the high technical requirements and great operational complexes.</p><p id="Par4">Machine vision techniques have been widely used in the automatic diagnosis and grading of plant diseases in recent years. Several algorithms for the digital image process have been used in studies on plant diseases. Image recognition of plant diseases<sup><xref ref-type="bibr" rid="CR17">17</xref>&#x02013;<xref ref-type="bibr" rid="CR19">19</xref></sup> and the automatic classification of disease severity<sup><xref ref-type="bibr" rid="CR20">20</xref>&#x02013;<xref ref-type="bibr" rid="CR22">22</xref></sup> can be achieved using appropriate image processing technologies. Recently, some studies on the automatic counting of fungal spores with using micro-image processing have been reported. Li <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> proposed a method based on the watershed transformation algorithm to count the urediniospores of <italic>Pst</italic>. However, the results appeared to incorrectly split the positions of the spores and demonstrated over-segmentation when the urediniospores had rough boundaries or a complicated touching condition. Chesmore <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> developed an image analysis system for rapidly discriminating between <italic>T</italic>. <italic>walkerii</italic> and <italic>T</italic>. <italic>indica</italic>. Principal components analysis was performed on many parameters, including the perimeter, surface area, number of spines, spine size, maximum and minimum ray radii, aspect ratio and roundness, to obtain a linear separation of species. The analysis system achieved 97% accuracy for separating <italic>T</italic>. <italic>walkerii</italic> and <italic>T</italic>. <italic>indica</italic>. Wang <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> proposed a new method based on image processing and artificial neural network to automatically detect powdery mildew spores. The 63.6% correct rate of testing pictures showed that it could achieve the automatic detection and counting of powdery mildew spores. Xu <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> used a computer-assisted digital image processing method, which obtained the spore image exterior outline characteristics for spore type analysis and automatic counting. All previous works demonstrated excellent performance. However, when the spores largely touched each other or there was no strong gradient existing in the touching spores, these studies usually had the problem of over-segmentation or under-segmentation. In reality, in-field trapped pathogen spores may touch or even overlap. Under the touching condition, it is difficult to separate the touching spores, which may affect the counting accuracy. Therefore, the touching spores in the image need to be split into separate spores. A variety of segmentation algorithms for touching objects in images, such as cells<sup><xref ref-type="bibr" rid="CR27">27</xref>&#x02013;<xref ref-type="bibr" rid="CR29">29</xref></sup>, fruits<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup>, and cereals<sup><xref ref-type="bibr" rid="CR32">32</xref>&#x02013;<xref ref-type="bibr" rid="CR34">34</xref></sup>, have been reported, and there have been some achievements in these fields. However, these algorithms are not suitable for the segmentation and counting of spores. Hence, it is necessary and urgent to develop a new method for the rapid and accurate identification and quantification of spores.</p><p id="Par5">On the basis of simulating the wheat field environment, this study develops a new algorithm for the automatic detection and counting of trapped pathogen urediniospores of <italic>Pst</italic>. First, the urediniospores are segmented using the <italic>K</italic>-means clustering algorithm and converted into a binary image. Second, to remove noise, pre-processing measures, including region filling, small area removal and open operations, are implemented to fill the spores, filter noise and smooth the urediniospore edges. Third, a feature combination of shape factor of target contour and area is selected as the basis for the discrimination of touching urediniospores. Fourth, the contour of touching urediniospores is extracted and divided into several contour segments based on concavity. Then, the contour segments that belong to the same urediniospores are merged, which is the main issue to solve. In this section, the distance measurement is proposed to eliminate the segments that have a low possibility of belonging to the same urediniospore. The candidate ellipse is then fitted using the least-squares ellipse fitting algorithm, and the deviation error measurement is used to determine its fitness evaluation. If the contour segments satisfy the conditions of the distance and the deviation error measurement, they are merged to create a new segment. Finally, the ellipses are fitted with these new segments as the best representative ellipses for the touching urediniospores. The objective of this study is to develop a new algorithm for the automatic detection and counting of trapped pathogen spores, and to assess the algorithm&#x02019;s detection accuracy by comparing the automatic counting algorithm with the watershed transformation algorithm.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><p id="Par6">To verify the validity and accuracy of the proposed automatic counting algorithm in this paper, the counting test was performed on a total of 120 urediniospore images. To accurately obtain the real number of urediniospores, the results of a manual counting method were used as the actual number of urediniospores. The performance of the proposed algorithm was compared with that of the watershed transformation algorithm<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. A personal computer with a 3.3&#x02009;GHz processor and 8 GB RAM was used as the hardware part of the computer vision system, and all the algorithms were developed in MATLAB R2014a (The MathWorks Inc, Natick, MA, USA). The examples are demonstrated below.</p><p id="Par7">A comparison of the results processed by the proposed algorithm and the watershed transformation algorithm is shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>. As shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>, there were not only individual urediniospores but also touching clumps and even some occluded urediniospores, which may not have been possible to separate correctly using previous techniques. Figure&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref> shows the result processed by the watershed transformation algorithm, in which the cases of two urediniospore adhesions and several urediniospores connected in series were well separated. However, it appeared to be over-segmented when the urediniospores had rough boundaries or under complicated touching/cluster conditions, and some of the segmentation locations were not accurate, which made the counting accuracy low. Figure&#x000a0;<xref rid="Fig1" ref-type="fig">1c</xref> shows the result processed by the proposed algorithm, in which the cases above were well separated. Moreover, the proposed algorithm was robust, because it performed well, even when the contours of touching urediniospores were irregular.<fig id="Fig1"><label>Figure 1</label><caption><p>Segmentation and counting results of the part of test images: (<bold>a</bold>) original digital image of urediospores; (<bold>b</bold>) segmentation effect and counting results based on the watershed segmentation algorithm; (<bold>c</bold>) segmentation effect and counting results based on the proposed algorithm.</p></caption><graphic xlink:href="41598_2018_31899_Fig1_HTML" id="d29e460"/></fig></p><p id="Par8">To evaluate both methods, the counting accuracy of detection was used, which was the ratio of the number of correctly detected urediniospores to the total number of urediniospores in the input image. Comparisons of the counting accuracy results are shown in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>. The lowest counting accuracy of the proposed method was 92.7%. The highest counting accuracy was 100%. The total average counting accuracy was 98.6%, which was an increase of 6 percentage points over that of the watershed transformation algorithm (92.6%). The experimental results of the lowest accuracy, highest accuracy and total average accuracy show that the proposed algorithm had better validity and correctness than the watershed transformation algorithm for urediniospore image segmentation and counting. Therefore, the proposed method is efficient and accurate for the automatic detection and counting of trapped urediniospores.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparisons of counting accuracy of two different segmentation algorithms.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Range of spores in one image</th><th rowspan="2">Number of samples</th><th colspan="3">Watershed transformation algorithm</th><th colspan="3">Proposed algorithm</th></tr><tr><th>Lowest accuracy/%</th><th>Highest accuracy/%</th><th>Average accuracy/%</th><th>Lowest accuracy/%</th><th>Highest accuracy/%</th><th>Average accuracy/%</th></tr></thead><tbody><tr><td>9 ~ 59</td><td>48</td><td>81.3</td><td>106</td><td>95.3</td><td>95.5</td><td>100</td><td>99.5</td></tr><tr><td>60 ~ 110</td><td>37</td><td>85.9</td><td>101</td><td>94.7</td><td>94.9</td><td>100</td><td>98.9</td></tr><tr><td>111 ~ 161</td><td>22</td><td>84.2</td><td>100</td><td>92.1</td><td>93.2</td><td>100</td><td>98.2</td></tr><tr><td>162 ~ 177</td><td>13</td><td>82.7</td><td>97.2</td><td>88.4</td><td>92.7</td><td>100</td><td>97.7</td></tr><tr><td>Total</td><td>120</td><td>83.5</td><td>101</td><td>92.6</td><td>93.6</td><td>100</td><td>98.6</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec3" sec-type="discussion"><title>Discussion</title><p id="Par9">It is inevitable that overlap will arise while capturing the urediniospores of wheat stripe rust. As shown in the red boxes in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a and c</xref>, the urediniospore in the upper part of the occluded urediniospores is blurred, because of the shallow depth of field under high optical magnification. In this case, the concave point may be lost at the contour of the concave object (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2a</xref>), which leads to a segmentation fault and affects the accuracy of automatic counting. From Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2b</xref>, two urediniospores are misdivided into one urediniospore by the ellipse fitting algorithm. Thus, further research is needed to solve the problem of the segmentation count for overlapping urediniospores.<fig id="Fig2"><label>Figure 2</label><caption><p>Example of overlapping urediniospore segmentation: (<bold>a</bold>) contour segments; <bold>(b</bold>) separation result.</p></caption><graphic xlink:href="41598_2018_31899_Fig2_HTML" id="d29e669"/></fig></p><p id="Par10">Currently, we mainly focus on the automatic detection and counting of pathogenic urediniospores of Pst that are trapped using a spore trap device via an indoor simulation. The scenarios are more complicated in a wheat field environment. Some atmospheric particles, such as pollen and other fungal spores, may also affect the accuracy of the automatic counting of urediniospores. Thus, further work is required to improve the counting accuracy of urediniospores that are collected in an actual farmland environment.</p></sec><sec id="Sec4" sec-type="materials|methods"><title>Materials and Methods</title><sec id="Sec5"><title>Materials</title><p id="Par11">Fresh urediniospores of Pst were selected as the experimental objects and obtained from the College of Plant Protection at Northwest A&#x00026;F University, Yangling, Shaanxi, China. The other materials and instruments included petroleum jelly, microscope slides, an aurilave, portable volumetric spore traps (TPBZ3, Zhejiang Top Instrument Co., Ltd, China), microscope (BX52, Olympus, Japan) and a desktop computer.</p></sec><sec id="Sec6"><title>Image acquisition</title><p id="Par12">The experiment was conducted in the laboratory of the College of Mechanical and Electronic Engineering at Northwest A&#x00026;F University, Yangling, Shaanxi, China. The collection of airborne fungal urediniospores was conducted by simulating the wheat field environment. Portable volumetric spore traps were used to collect airborne urediniospores of Pst. In the laboratory, an aurilave was used first to slowly and continuously blow the urediniospores above the trap to spread them into the air. Airborne particles were then deposited onto microscope slides that were uniformly coated with a thin film of petroleum jelly. To obtain different densities of urediniospores on the slides, urediniospores were collected continuously for 5, 10 or 15&#x02009;mins and repeated 10 times to obtain 30 slides containing different urediniospore densities. The fungal urediniospores on the slides were observed and photographed at the genus level with the aid of a light microscope under &#x000d7;200 magnification. All the 150 experimental images (4,140&#x02009;&#x000d7;&#x02009;3,096 pixels) of urediniospores (five points each slide under the microscope were randomly selected to take images) were acquired for the validation of the proposed algorithm using a digital imaging system (DP72, Olympus, Japan) of 72 dpi at 24 bits using the RGB model. Thirty images were randomly selected for algorithm training, and the remaining 120 images were used for testing. Partial original images are shown in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>. The urediniospores were broadly ellipsoidal to broadly obovoid, with a mean of 24.5&#x02009;&#x000d7;&#x02009;21.6 &#x003bc;m, and yellow to orange. A large number of urediniospores in the images touched each other, which made it difficult to automatically count them.<fig id="Fig3"><label>Figure 3</label><caption><p>Original RGB images for different capture times: (<bold>a</bold>) image after capturing for 5&#x02009;min; (<bold>b</bold>) image after capturing for 10&#x02009;min; (<bold>c</bold>) image after capturing for 15&#x02009;min.</p></caption><graphic xlink:href="41598_2018_31899_Fig3_HTML" id="d29e705"/></fig></p></sec><sec id="Sec7"><title>Segmentation of the urediniospore images using the <italic>K</italic>-means clustering algorithm</title><p id="Par13">Image segmentation from the background is an important step in the image processing technique. Urediniospore target segmentation can be viewed as a clustering problem in the case in which the classification of the pixel points is unknown and the image can be divided into several regions based on the characteristic value of the pixel points. The <italic>K</italic>-means clustering algorithm is an unsupervised partitioning algorithm that divides data into a predetermined class <italic>k</italic> to minimise the error function and is widely used in image segmentation fields<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup>. It is accurate and highly efficient for largescale data processing, which makes it more suitable to segmenting urediniospore images in this work. Because only the urediniospore region was required in this research, <italic>k</italic>&#x02009;=&#x02009;2 was used, and the original image was divided into two classes: the urediniospore region and the background region.</p><p id="Par14">The size of images we acquired was large, and it was time consuming to process and segment them. First, we resized them to 911&#x02009;&#x000d7;&#x02009;682 pixels. The colour space was transformed from the RGB colour space to the L*a*b* colour space. The <italic>K</italic>means clustering algorithm was then used to cluster the urediniospore images into two classifications based on the a* and b* colour components. Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3c</xref> is the original image. Figure&#x000a0;<xref rid="Fig4" ref-type="fig">4a</xref> shows the processing results of <italic>K</italic>-means clustering, demonstrating that it could be applied for image segmentation. Figure&#x000a0;<xref rid="Fig4" ref-type="fig">4b</xref> is the binary image of Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4a</xref> using the fixed-threshold algorithm based on the threshold of 0.2. From Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4b</xref>, we can observe that it contained noise, such as holes and spurs, which affected the accuracy of the subsequent contour detection and urediniospore count. Therefore, further processing was needed.<fig id="Fig4"><label>Figure 4</label><caption><p>Results of the urediniospore image after the <italic>K</italic>means algorithm and preprocessing: (<bold>a</bold>) extracted image of urediniospores after the <italic>K</italic>-means algorithm with <italic>k</italic>&#x02009;=&#x02009;2; (<bold>b</bold>) binary image of the extracted urediniospores using the fixed threshold algorithm; (<bold>c</bold>) binary image after morphology preprocessing.</p></caption><graphic xlink:href="41598_2018_31899_Fig4_HTML" id="d29e781"/></fig></p></sec><sec id="Sec8"><title>Pre-processing of the urediniospore image</title><p id="Par15">To remove noise, pre-processing measures, including region filling, small-area removal and open operations, were implemented to fill the spores, filter noise and smooth the spore edges. First, the holes in the urediniospores were filled using the operation of region filling. Second, the areas of less than 190 pixels, that is, small particles, were removed using the area opening operation. At the moment when the areas of the urediniospores on the boundary of the image were less than 190 pixels, the urediniospores were removed from the binary image and counted as the urediniospores of the other images. Finally, the morphological opening operation with a &#x02018;disk&#x02019;-shaped structural element with a radius of 5 pixels was performed to remove spurs and smooth the urediniospore contour. As a result, the processed image (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4c</xref>) showed no noise and the contour became smoother, which was helpful in subsequent processing.</p></sec><sec id="Sec9"><title>The identification of touching urediniospores based on the shape factor and area</title><p id="Par16">Figure&#x000a0;<xref rid="Fig4" ref-type="fig">4c</xref> shows that the binary image included not only individual urediniospores but also two or more touching urediniospores. The regional contour of the touching urediniospores was more complex and larger than that of the individual urediniospores. Thus, a feature combination of the shape factor of the target contour and area was selected as the basis for the discrimination of touching urediniospores. The shape factor (<italic>SF</italic>) formulas<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> can be defined as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SF=4\pi S/{L}^{2},$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>S</mml:mi><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>S</italic> is the area pixel value of a connected region and <italic>L</italic> is the perimeter pixel value of a connected region.</p><p id="Par17">The contour of the touching urediniospores was larger and more complicated than that of the individual urediniospores after sampling statistics because it was concave, and the shape factor was smaller. When 0.9080&#x02009;&#x0003c;&#x02009;<italic>SF</italic>&#x02009;&#x0003c;&#x02009;1.0912 and 200&#x02009;&#x0003c;&#x02009;<italic>S</italic>&#x02009;&#x0003c;&#x02009;523, the objects were identified as individual urediniospores. When 0.2625&#x02009;&#x0003c;&#x02009;<italic>SF</italic>&#x02009;&#x0003c;&#x02009;0.7606 and 600&#x02009;&#x0003c;&#x02009;<italic>S</italic>&#x02009;&#x0003c;&#x02009;2301, the objects were identified as touching urediniospores. Thus, <italic>SF</italic> and <italic>S</italic> were set to be 0.8 and 560 according to various tests. Let <italic>i</italic> be a connected region. If<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S{F}_{i} &#x0003e; S{F}_{0}\,\&#x00026; \,{S}_{i} &#x0003c; {S}_{{\rm{\max }}}.$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mspace width=".25em"/><mml:mo>&#x00026;</mml:mo><mml:mspace width=".25em"/><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>is satisfied, region <italic>i</italic> is assessed to be an individual urediniospore, otherwise it is assessed to be touching urediniospores. Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> shows the result of touching urediniospore identification for Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4c</xref>, where the individual urediniospores and touching urediniospores were correctly discriminated.<fig id="Fig5"><label>Figure 5</label><caption><p>Binary images of individual and touching urediniospores: (<bold>a</bold>) binary image of individual urediniospores; (<bold>b</bold>) binary image of touching urediniospores.</p></caption><graphic xlink:href="41598_2018_31899_Fig5_HTML" id="d29e948"/></fig></p></sec><sec id="Sec10"><title>Touching urediniospore contour segmentation based on concavity</title><p id="Par18">From the above processing step, if the region was identified as an individual urediniospore in the binary image, then the ellipse number was directly counted by the least-squares ellipse fitting method. To automatically count the spores precisely, these touching urediniospores must be separated, which is the main contribution of this work.</p><p id="Par19">As an example, the contour of the touching urediniospores in the red rectangular box in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5b</xref> was extracted by the canny edge detector, which is shown after enlargement in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6b</xref>, and the contour points were stored in an ordered list. The following detection method for the concavity was used.<fig id="Fig6"><label>Figure 6</label><caption><p>Processing example of the proposed algorithm: (<bold>a</bold>) binary image after pre-processing; (<bold>b</bold>) contour of touching urediniospores; (<bold>c</bold>) red concave points on the contour; (<bold>d</bold>) contour segments; (<bold>e</bold>) candidate ellipses; (<bold>f</bold>) best representative ellipse of one urediniospores; (<bold>g</bold>) final separation result.</p></caption><graphic xlink:href="41598_2018_31899_Fig6_HTML" id="d29e992"/></fig></p><p id="Par20">Let <italic>p</italic><sub><italic>t</italic></sub>(<italic>x</italic><sub><italic>t</italic></sub>, <italic>y</italic><sub><italic>t</italic></sub>) be a contour point, and the angle between the vectors <bold><italic>p</italic></bold><sub><italic>t</italic></sub><bold><italic>p</italic></bold><sub><italic>t&#x02212;h</italic></sub> and <bold><italic>p</italic></bold><sub><italic>t</italic></sub><bold><italic>p</italic></bold><sub><italic>t</italic>+<italic>h</italic></sub> be defined as the concavity of <italic>p</italic><sub><italic>t</italic></sub>, where <italic>p</italic><sub><italic>t&#x02212;h</italic></sub> and <bold><italic>p</italic></bold><sub><italic>t</italic>+<italic>h</italic></sub> denote the <italic>h</italic>th adjacent contour points of <bold><italic>p</italic></bold><sub><italic>t</italic></sub>; <italic>h</italic> was set to 3 according to the pretest. The formula for concavity can be expressed as<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{concavity}}\,({p}_{t})={\rm{angle}}\,({p}_{t-h}{\boldsymbol{,}}\,{p}_{t}{\boldsymbol{,}}\,{p}_{t+h})=\arccos \frac{{{\boldsymbol{p}}}_{t}{{\boldsymbol{p}}}_{t-h}\cdot {{\boldsymbol{p}}}_{t}{{\boldsymbol{p}}}_{t+h}}{||{{\boldsymbol{p}}}_{t}{{\boldsymbol{p}}}_{t-h}||\cdot ||{{\boldsymbol{p}}}_{t}{{\boldsymbol{p}}}_{t+h}||}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi mathvariant="normal">concavity</mml:mi><mml:mspace width=".25em"/><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">angle</mml:mi><mml:mspace width=".25em"/><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mspace width=".25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mspace width=".25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>arccos</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>&#x022c5;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>||</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>||</mml:mo></mml:mrow></mml:mrow><mml:mo>&#x022c5;</mml:mo><mml:mrow><mml:mo>||</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>||</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>If the point is determined to be the concave point, then it needs to meet the following two conditions (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6c</xref>): concavity(<italic>p</italic><sub><italic>t</italic></sub>) is in the range angle(<italic>&#x003b4;</italic><sub>1</sub>,<italic>&#x003b4;</italic><sub>2</sub>); line <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{p}_{t-h}{p}_{t+h}}$$\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41598_2018_31899_Article_IEq1.gif"/></alternatives></inline-formula> does not traverse the touching urediniospores.</p><p id="Par21">With 30 urediniospore image samples for statistical analyses, the angles of the concave point <italic>p</italic><sub><italic>t</italic></sub> between the vectors <bold><italic>p</italic></bold><sub><italic>t</italic></sub><bold><italic>p</italic></bold><sub><italic>t</italic>&#x02212;<italic>h</italic></sub> and <bold><italic>p</italic></bold><sub><italic>t</italic></sub><bold><italic>p</italic></bold><sub><italic>t</italic> + <italic>h</italic></sub> were in the range of 50&#x000b0; to 150&#x000b0;. Thus, the values of <italic>&#x003b4;</italic><sub>1</sub> and <italic>&#x003b4;</italic><sub>2</sub> were set to 50&#x000b0; and 150&#x000b0;, respectively.</p><p id="Par22">With these concave points, the contour (<italic>C</italic>) of the touching urediniospores was divided into <italic>N</italic> contour segments and <italic>K</italic> concave points (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4d</xref>):<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}={C}{{S}}_{1}+\ldots +{C}{{S}}_{i}+\ldots +{C}{{S}}_{N}+{c}{{p}}_{1}+\ldots +{c}{{p}}_{j}+\ldots +{c}{{p}}_{K}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mi mathvariant="italic">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par23">The contours of the touching urediniospores were stored in an ordered cell structure using the 8-connected boundary tracking method and then used for subsequent urediniospore contour segment merging.</p></sec><sec id="Sec11"><title>Touching urediniospore contour segment merging</title><p id="Par24">After segmentation in the above processing step, one contour of the same urediniospores may be divided into several contour segments. The aim of this subsection is to merge the contour segments that belong to the same urediniospores. First, several measurements and the ellipse fitting algorithm are proposed, and then the merging steps are explained.</p><sec id="Sec12"><title>Distance measurement between contour segments</title><p id="Par25">If the distance between two contour segments is large, then the possibility that these two segments belong to the same urediniospore is low and vice versa. Thus, according to this theory, a method based on the distance measurement is used to express the relevance between these contour segments to eliminate the segments that had a low probability of belonging to the same urediniospore. The distance between two contour segments can be described by as<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$DM({C}{{S}}_{{i}}{\boldsymbol{,}}{C}{{S}}_{{j}})=\frac{[d({p}_{i1}{\boldsymbol{,}}{p}_{j1})+d({p}_{i1}{\boldsymbol{,}}{p}_{j{M}_{j}})+d({p}_{i{m}_{i}}{\boldsymbol{,}}{p}_{j{m}_{j}})+d({p}_{i{M}_{i}}{\boldsymbol{,}}{p}_{j1})+d({p}_{i{M}_{i}}{\boldsymbol{,}}{p}_{j{M}_{j}})]}{5},$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mi>D</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>5</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>d</italic>(<italic>p</italic><sub><italic>i</italic>1</sub>,<italic>p</italic><sub><italic>j</italic>1</sub>), <inline-formula id="IEq2"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d({p}_{i1}{\boldsymbol{,}}{p}_{j{M}_{j}})$$\end{document}</tex-math><mml:math id="M14"><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2018_31899_Article_IEq2.gif"/></alternatives></inline-formula>, <inline-formula id="IEq3"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d({p}_{i{M}_{i}}{\boldsymbol{,}}{p}_{j1})$$\end{document}</tex-math><mml:math id="M16"><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2018_31899_Article_IEq3.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq4"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d({p}_{i{M}_{i}}{\boldsymbol{,}}{p}_{j{M}_{j}})$$\end{document}</tex-math><mml:math id="M18"><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2018_31899_Article_IEq4.gif"/></alternatives></inline-formula> are the Euclidian distances between the end points of contours <italic>CS</italic><sub><italic>i</italic></sub> and <italic>CS</italic><sub><italic>j</italic></sub>, and <inline-formula id="IEq5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d({p}_{i{m}_{i}}{\boldsymbol{,}}{p}_{j{m}_{j}})$$\end{document}</tex-math><mml:math id="M20"><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2018_31899_Article_IEq5.gif"/></alternatives></inline-formula> is the Euclidian distance between the middle points of contours <italic>CS</italic><sub><italic>i</italic></sub> and <italic>CS</italic><sub><italic>j</italic></sub>.</p></sec><sec id="Sec13"><title>Ellipse fitting</title><p id="Par26">Because the urediniospores in the image resembled an ellipsoidal shape, to separate the touching urediniospores, the least-squares ellipse fitting algorithm proposed by Fitzgibbon <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> was implemented to fit the contour of the urediniospores. A general ellipse can be described by an implicit second-order polynomial:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F({\boldsymbol{\alpha }},{\boldsymbol{X}})={\boldsymbol{X}}\cdot {\boldsymbol{\alpha }}=a{x}^{2}+bxy+c{y}^{2}+dx+ey+f=0,$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>with an ellipse constraint:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4ac-{b}^{2}=1,$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mn>4</mml:mn><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq6"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{X}}=[\begin{array}{ccccc}{x}^{2} &#x00026; xy &#x00026; {y}^{2} &#x00026; x &#x00026; \begin{array}{cc}y &#x00026; 1\end{array}\end{array}]$$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mi>x</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>y</mml:mi></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2018_31899_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{\alpha }}={[\begin{array}{ccccc}a &#x00026; b &#x00026; c &#x00026; d &#x00026; \begin{array}{cc}e &#x00026; f\end{array}\end{array}]}^{T}$$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd><mml:mtd><mml:mi>b</mml:mi></mml:mtd><mml:mtd><mml:mi>c</mml:mi></mml:mtd><mml:mtd><mml:mi>d</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>e</mml:mi></mml:mtd><mml:mtd><mml:mi>f</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2018_31899_Article_IEq7.gif"/></alternatives></inline-formula> are the coefficients of the ellipse, and <italic>x</italic> and <italic>y</italic> are coordinates of sample points lying on it.</p><p id="Par27">Equation (<xref rid="Equ7" ref-type="">7</xref>) can be represented in vector form:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\boldsymbol{\alpha }}}^{T}C{\boldsymbol{\alpha }}=1,$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>C</mml:mi><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where the constraint matrix <bold><italic>C</italic></bold> is of size 6&#x02009;&#x000d7;&#x02009;6, and<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{C}}{\boldsymbol{=}}[\begin{array}{cccccc}0 &#x00026; 0 &#x00026; 2 &#x00026; 0 &#x00026; 0 &#x00026; 0\\ 0 &#x00026; -1 &#x00026; 0 &#x00026; 0 &#x00026; 0 &#x00026; 0\\ 2 &#x00026; 0 &#x00026; 0 &#x00026; 0 &#x00026; 0 &#x00026; 0\\ 0 &#x00026; 0 &#x00026; 0 &#x00026; 0 &#x00026; 0 &#x00026; 0\\ 0 &#x00026; 0 &#x00026; 0 &#x00026; 0 &#x00026; 0 &#x00026; 0\\ 0 &#x00026; 0 &#x00026; 0 &#x00026; 0 &#x00026; 0 &#x00026; 0\end{array}].$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo mathvariant="bold-italic">=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>2</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par28">Polynomial <italic>F</italic>(<bold><italic>&#x003b1;</italic></bold>, <bold><italic>X</italic></bold><sub><italic>i</italic></sub>) is called the algebraic distance of data point (<italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>) to ellipse <italic>F</italic>(<italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>) = 0. Because of sample point errors, the deviation resulted in <italic>F</italic>(<italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>) &#x02260; 0. The fitting problem of the ellipse can be resolved by minimising the sum of the squared algebraic distances of the set of <italic>N</italic> data points to the ellipse:<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E={\sum _{i=1}^{m}F({x}_{i}{\boldsymbol{,}}{y}_{i})}^{2},$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>which can be reformulated in vector form:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E={\Vert D{\boldsymbol{\alpha }}\Vert }^{2},$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>&#x02016;</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:mrow><mml:mo>&#x02016;</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where the design matrix <bold><italic>D</italic></bold> of size N&#x02009;&#x000d7;&#x02009;6 is<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{D}}=[\begin{array}{cccccc}{x}_{1}^{2} &#x00026; {x}_{1}{y}_{1} &#x00026; {y}_{1}^{2} &#x00026; {x}_{1} &#x00026; {y}_{1} &#x00026; 1\\ \vdots  &#x00026; \vdots  &#x00026; \vdots  &#x00026; \vdots  &#x00026; \vdots  &#x00026; \vdots \\ {x}_{i}^{2} &#x00026; {x}_{i}{y}_{i} &#x00026; {y}_{i}^{2} &#x00026; {x}_{i} &#x00026; {y}_{i} &#x00026; 1\\ \vdots  &#x00026; \vdots  &#x00026; \vdots  &#x00026; \vdots  &#x00026; \vdots  &#x00026; \vdots \\ {x}_{m}^{2} &#x00026; {x}_{m}{y}_{m} &#x00026; {y}_{m}^{2} &#x00026; {x}_{m} &#x00026; {y}_{m} &#x00026; 1\end{array}].$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par29">Vector <bold><italic>&#x003b1;</italic></bold> can be calculated using the Lagrange coefficient and differential based on Equations (<xref rid="Equ8" ref-type="">8</xref>) and (<xref rid="Equ11" ref-type="">11</xref>), which leads to the following:<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\begin{array}{c}W{\boldsymbol{\alpha }}=\lambda {\boldsymbol{C}}{\boldsymbol{\alpha }}\\ {{\boldsymbol{\alpha }}}^{T}{\boldsymbol{C}}{\boldsymbol{\alpha }}=1\end{array},$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>W</mml:mi><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>where <bold><italic>W</italic></bold> is the scatter matrix of size 6&#x02009;&#x000d7;&#x02009;6, and <italic>&#x003bb;</italic> is an eigenvalue for <bold><italic>W</italic></bold>:<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{W}}={{\boldsymbol{D}}}^{T}{\boldsymbol{D}}.$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par30">Equation (<xref rid="Equ13" ref-type="">13</xref>) is a generalised eigenvector system. According to the generalised eigenvalue, the solution method can derive the following:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\boldsymbol{\alpha }}}_{i}=(\sqrt{\frac{1}{{{\boldsymbol{u}}}_{i}^{T}{\boldsymbol{C}}{{\boldsymbol{u}}}_{i}}})\,{{\boldsymbol{u}}}_{i}=(\sqrt{\frac{{\lambda }_{i}}{{{\boldsymbol{u}}}_{i}^{T}{\boldsymbol{S}}{{\boldsymbol{u}}}_{i}}}){{\boldsymbol{u}}}_{i},$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mspace width=".25em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <italic>&#x003bb;</italic><sub><italic>i</italic></sub> and <bold><italic>u</italic></bold><sub><italic>i</italic></sub> are the eigenvalue and eigenvector for Equation (<xref rid="Equ13" ref-type="">13</xref>).</p><p id="Par31">The sum of the squared algebraic distances of the points to the ellipse can be derived as<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E={\Vert {\boldsymbol{D}}{\boldsymbol{\alpha }}\Vert }^{2}={{\boldsymbol{\alpha }}}^{T}{{\boldsymbol{D}}}^{T}{\boldsymbol{D}}{\boldsymbol{\alpha }}={{\boldsymbol{\alpha }}}^{T}{\boldsymbol{W}}{\boldsymbol{\alpha }}=\lambda {{\boldsymbol{\alpha }}}^{T}{\boldsymbol{C}}{\boldsymbol{\alpha }}=\lambda .$$\end{document}</tex-math><mml:math id="M46" display="block"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>&#x02016;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:mrow><mml:mo>&#x02016;</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par32">Thus, the chosen eigenvector <bold><italic>&#x003b1;</italic></bold><sub><italic>i</italic></sub> (<italic>i</italic> is the eigenvector number) that corresponds to the minimal positive eigenvalue <italic>&#x003bb;</italic><sub><italic>i</italic></sub> represents the best-fit ellipse for the given set of points.</p></sec><sec id="Sec14"><title>Deviation error measurement from the contour segments to the fitted ellipse</title><p id="Par33">When elliptical fitting is conducted using the candidate contour segments, the fitting degree between the candidate contour segments and fitted ellipse is not considered, which will result in a great deviation from the actual ellipse. In this work, to exclude the wrong candidate contour segments, the deviation error measurement is proposed to determine its fitness evaluation from the contour segments to the fitted ellipse. Thus, the deviation error measurement can be represented as<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$DEM(C{S}^{\#}{\boldsymbol{,}}CE)=E/{M}^{\#}=\lambda /{M}^{\#},$$\end{document}</tex-math><mml:math id="M48" display="block"><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo>#</mml:mo></mml:msup><mml:mo mathvariant="bold">,</mml:mo><mml:mi>C</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>#</mml:mo></mml:msup></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>&#x003bb;</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>#</mml:mo></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>where <italic>CS</italic><sup>#</sup> denotes the data points of given contour segments, <italic>CE</italic> is the candidate ellipse, <italic>E</italic> is the sum of the least-squares algebraic distances of the data points to the ellipse and <italic>M</italic><sup>#</sup> is the total number of points on <italic>CS</italic><sup>#</sup>.</p><p id="Par34">If the value of the deviation error is less than the threshold, then the contour segment belongs to the contour of the same urediniospore; otherwise, it does not.</p></sec><sec id="Sec15"><title>Steps of contour segment merging</title><p id="Par35">Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6d</xref> shows an example that illustrates the merging steps. As shown in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6d</xref>, the contour of the touching urediniospores was divided into eight contour segments. The merging steps of the contour segments of the touching urediniospores are as follows:<list list-type="bullet"><list-item><p id="Par36">Step 1: Select the longest segment of these contour segments <italic>CS</italic><sub>8</sub>.</p></list-item><list-item><p id="Par37">Step 2: Set a distance measurement threshold <italic>&#x003c9;</italic><sub>DM</sub> and measure the distance between the selected segment <italic>CS</italic><sub>8</sub> and each of the remaining segments <italic>CS</italic><sub><italic>i</italic></sub>. Build a set <italic>CS</italic><sup>*</sup> if DM(<italic>CS</italic><sub>8</sub>,<italic>CS</italic><sub><italic>i</italic></sub>) &#x0003c; <italic>&#x003c9;</italic><sub>DM</sub> is satisfied; that is,</p></list-item></list><disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}{{S}}^{\ast }=\{{C}{{S}}_{i}|{\rm{DM}}({C}{{S}}_{8}{\boldsymbol{,}}{C}{{S}}_{i}) &#x0003c; {\omega }_{{\rm{DM}}},i=1,2,\ldots ,k\}.$$\end{document}</tex-math><mml:math id="M50" display="block"><mml:mi mathvariant="italic">C</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mo>&#x0204e;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mi mathvariant="normal">DM</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c9;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DM</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>Thus, a set <italic>CS</italic><sup>*</sup> is constructed with <italic>CS</italic><sub>4</sub>, <italic>CS</italic><sub>5</sub>, <italic>CS</italic><sub>6</sub> and <italic>CS</italic><sub>7</sub> because their distance measurements are smaller than <italic>&#x003c9;</italic><sub><italic>DM</italic></sub>.<list list-type="bullet"><list-item><p id="Par38">Step 3: Fit ellipses with <italic>CS</italic><sub>8</sub> and each segment in <italic>CS</italic><sup>*</sup> using the least-squares ellipse fitting algorithm, which is shown as the ellipses in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6e</xref>. Calculate the DEMs between these two contour segments (<italic>CS</italic><sub>8</sub> and <italic>CS</italic><sub>4</sub>, <italic>CS</italic><sub>8</sub> and <italic>CS</italic><sub>5</sub>, <italic>CS</italic><sub>8</sub> and <italic>CS</italic><sub>6</sub>, and <italic>CS</italic><sub>8</sub> and <italic>CS</italic><sub>7</sub>) and their corresponding fitted ellipses. Merge <italic>CS</italic><sub>8</sub> with all <italic>CS</italic><sub><italic>i</italic></sub> whose DEMs are smaller than <italic>&#x003c3;</italic><sub>DEM</sub> to create <italic>CS</italic><sub>new</sub>, which can be represented as</p></list-item></list><disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}{{S}}_{{\rm{n}}{\rm{e}}{\rm{w}}}=\{{C}{{S}}_{8}+{C}{{S}}_{i}|{\rm{DEM}}({C}{{S}}_{8}{\boldsymbol{,}}{C}{{S}}_{i}) &#x0003c; {\sigma }_{{\rm{DEM}}}{\boldsymbol{,}}i=1{\boldsymbol{,}}2{\boldsymbol{,}}\ldots {\boldsymbol{,}}k\}.$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mi mathvariant="normal">DEM</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="italic">C</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DEM</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:mn>2</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2018_31899_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>Because there are no segments to satisfy the condition, <italic>CS</italic><sub>8</sub> is merged as a new contour segment.<list list-type="bullet"><list-item><p id="Par39">Step 4: Fit the ellipse with this new segment <italic>CS</italic><sub>new</sub> as the correct ellipse for one of the touching urediniospores shown as Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6f</xref>, where the number of urediniospores is Num&#x02009;+&#x02009;1, and delete <italic>CS</italic><sub>new</sub>.</p></list-item><list-item><p id="Par40">Step 5: Delete <italic>CS</italic><sub>new</sub> from the contour segment list <italic>CS</italic><sub><italic>N</italic></sub>. Check if all <italic>CS</italic><sub><italic>N</italic></sub> are deleted. If so, output all correct ellipses and end the program. If not, go back to Step 1, and the steps are iterated until all the contour segments are selected to fit the best representative ellipses (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6g</xref>).</p></list-item></list></p><p id="Par41">With 30 urediniospore image samples for statistical analyses, when the parameter <italic>&#x003c9;</italic><sub>DM</sub> was less than 40, all contour segments of the same spore were included in <italic>CS</italic><sup>*</sup>, and when the parameter <italic>&#x003c3;</italic><sub>DEM</sub> was less than 95, the wrong candidate contour segments were excluded. Thus, <italic>&#x003c9;</italic><sub>DM</sub> and <italic>&#x003c3;</italic><sub>DEM</sub> were set to 40 and 95, respectively. The results of the proposed algorithm for segmenting and counting the image in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> are shown in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>. This shows that the touching urediniospores were well divided.<fig id="Fig7"><label>Figure 7</label><caption><p>Segmentation effect and counting results of the original image of urediniospores under different capture times: (<bold>a</bold>) image after capturing for 5&#x02009;min; (<bold>b</bold>) image after capturing for 10&#x02009;min; (<bold>c</bold>) image after capturing for 15&#x02009;min.</p></caption><graphic xlink:href="41598_2018_31899_Fig7_HTML" id="d29e3614"/></fig></p></sec></sec></sec></body><back><fn-group><fn><p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><ack><title>Acknowledgements</title><p>This research was supported by the overall innovation project of science and technology of Shaanxi province (No. 2015KTZDNY01-06). The authors thank Huaibo Song, Dandan Wang, and Gangming Zhan for their helpful suggestions.</p></ack><notes notes-type="author-contribution"><title>Author Contributions</title><p>Y.L. and D.J.H. conceived and designed the research. Y.L. carried out the experiments and image processing, wrote the main manuscript text and prepared figures. Z.F.Y. contributed to the data processing and critical revision of the manuscript. All authors reviewed the manuscript.</p></notes><notes notes-type="COI-statement"><sec id="FPar1"><title>Competing Interests</title><p>The authors declare no competing interests.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wellings</surname><given-names>CR</given-names></name></person-group><article-title>Global status of stripe rust: a review of historical and current threats</article-title><source>Euphytica</source><year>2011</year><volume>179</volume><fpage>129</fpage><lpage>141</lpage><pub-id pub-id-type="doi">10.1007/s10681-011-0360-y</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>WQ</given-names></name><name><surname>Wellings</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>XM</given-names></name><name><surname>Kang</surname><given-names>ZS</given-names></name><name><surname>Liu</surname><given-names>TG</given-names></name></person-group><article-title>Wheat stripe (yellow) rust caused by Puccinia striiformis f. sp.tritici</article-title><source>Mol. Plant Pathol.</source><year>2014</year><volume>15</volume><fpage>433</fpage><lpage>446</lpage><pub-id pub-id-type="doi">10.1111/mpp.12116</pub-id><?supplied-pmid 24373199?><pub-id pub-id-type="pmid">24373199</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wan</surname><given-names>AM</given-names></name><etal/></person-group><article-title>Wheat stripe rust epidemic and virulence of Puccinia striiformis f. sp tritici in China in 2002</article-title><source>Plant Dis.</source><year>2004</year><volume>88</volume><fpage>896</fpage><lpage>904</lpage><pub-id pub-id-type="doi">10.1094/PDIS.2004.88.8.896</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wellings</surname><given-names>CR</given-names></name></person-group><article-title>Puccinia striiformis in Australia: a review of the incursion, evolution, and adaptation of stripe rust in the period 1979&#x02013;2006</article-title><source>Aust. J. Agric. Res.</source><year>2007</year><volume>58</volume><fpage>567</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1071/AR07130</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>Y</given-names></name><name><surname>Szabo</surname><given-names>LJ</given-names></name><name><surname>Carson</surname><given-names>M</given-names></name></person-group><article-title>Century-Old Mystery of Puccinia striiformis Life History Solved with the Identification of Berberis as an Alternate Host</article-title><source>Phytopathology</source><year>2010</year><volume>100</volume><fpage>432</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1094/PHYTO-100-5-0432</pub-id><?supplied-pmid 20373963?><pub-id pub-id-type="pmid">20373963</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>MN</given-names></name><name><surname>Chen</surname><given-names>XM</given-names></name></person-group><article-title>First Report of Oregon Grape (Mahonia aquifolium) as an Alternate Host for the Wheat Stripe Rust Pathogen (Puccinia striiformis f. sp tritici) Under Artificial Inoculation</article-title><source>Plant Dis.</source><year>2013</year><volume>97</volume><fpage>839</fpage><lpage>839</lpage><pub-id pub-id-type="doi">10.1094/PDIS-09-12-0864-PDN</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>JKM</given-names></name><name><surname>Hovmoller</surname><given-names>MS</given-names></name></person-group><article-title>Epidemiology - Aerial dispersal of pathogens on the global and continental scales and its impact on plant disease</article-title><source>Science</source><year>2002</year><volume>297</volume><fpage>537</fpage><lpage>541</lpage><pub-id pub-id-type="doi">10.1126/science.1072678</pub-id><?supplied-pmid 12142520?><pub-id pub-id-type="pmid">12142520</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>S-M</given-names></name><name><surname>Luo</surname><given-names>Y</given-names></name></person-group><article-title>Long-distance spread and interregional epidemics of wheat stripe rust in China</article-title><source>Plant Dis.</source><year>2006</year><volume>90</volume><fpage>980</fpage><lpage>988</lpage><pub-id pub-id-type="doi">10.1094/PD-90-0980</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Penman</surname><given-names>L</given-names></name><name><surname>Wan</surname><given-names>A</given-names></name><name><surname>Cheng</surname><given-names>P</given-names></name></person-group><article-title>Virulence races of Puccinia striiformis f. sp tritici in 2006 and 2007 and development of wheat stripe rust and distributions, dynamics, and evolutionary relationships of races from 2000 to 2007 in the United States</article-title><source>Can. J. Plant Pathol.</source><year>2010</year><volume>32</volume><fpage>315</fpage><lpage>333</lpage><pub-id pub-id-type="doi">10.1080/07060661.2010.499271</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Yang</surname><given-names>XB</given-names></name><name><surname>Ma</surname><given-names>Z</given-names></name></person-group><article-title>Long-Distance Spore Transport of Wheat Stripe Rust Pathogen from Sichuan, Yunnan, and Guizhou in Southwestern China</article-title><source>Plant Dis.</source><year>2010</year><volume>94</volume><fpage>873</fpage><lpage>880</lpage><pub-id pub-id-type="doi">10.1094/PDIS-94-7-0873</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Isard</surname><given-names>SA</given-names></name><etal/></person-group><article-title>Predicting Soybean Rust Incursions into the North American Continental Interior Using Crop Monitoring, Spore Trapping, and Aerobiological Modeling</article-title><source>Plant Dis.</source><year>2011</year><volume>95</volume><fpage>1346</fpage><lpage>1357</lpage><pub-id pub-id-type="doi">10.1094/PDIS-01-11-0034</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choudhury</surname><given-names>RA</given-names></name><etal/></person-group><article-title>Season-Long Dynamics of Spinach Downy Mildew Determined by Spore Trapping and Disease Incidence</article-title><source>Phytopathology</source><year>2016</year><volume>106</volume><fpage>1311</fpage><lpage>1318</lpage><pub-id pub-id-type="doi">10.1094/PHYTO-12-15-0333-R</pub-id><?supplied-pmid 27442537?><pub-id pub-id-type="pmid">27442537</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prados-Ligero</surname><given-names>AM</given-names></name><name><surname>Melero-Vara</surname><given-names>JM</given-names></name><name><surname>Corpas-Hervias</surname><given-names>C</given-names></name><name><surname>Basallote-Ureba</surname><given-names>MJ</given-names></name></person-group><article-title>Relationships between weather variables, airborne spore concentrations and severity of leaf blight of garlic caused by Stemphylium vesicarium in Spain</article-title><source>Eur. J. Plant Pathol.</source><year>2003</year><volume>109</volume><fpage>301</fpage><lpage>310</lpage><pub-id pub-id-type="doi">10.1023/A:1023519029605</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kunjeti</surname><given-names>S</given-names></name><etal/></person-group><article-title>Detection and quantification of Bremia lactucae by spore trapping and quantitative PCR</article-title><source>Phytopathology</source><year>2016</year><volume>106</volume><fpage>22</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1094/PHYTO-03-16-0143-R</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meitz-Hopkins</surname><given-names>JC</given-names></name><name><surname>von Diest</surname><given-names>SG</given-names></name><name><surname>Koopman</surname><given-names>TA</given-names></name><name><surname>Bahramisharif</surname><given-names>A</given-names></name><name><surname>Lennox</surname><given-names>CL</given-names></name></person-group><article-title>A method to monitor airborne Venturia inaequalis ascospores using volumetric spore traps and quantitative PCR</article-title><source>Eur. J. Plant Pathol.</source><year>2014</year><volume>140</volume><fpage>527</fpage><lpage>541</lpage><pub-id pub-id-type="doi">10.1007/s10658-014-0486-6</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glynn</surname><given-names>NC</given-names></name><name><surname>Haudenshield</surname><given-names>JS</given-names></name><name><surname>Hartman</surname><given-names>GL</given-names></name><name><surname>Raid</surname><given-names>RN</given-names></name><name><surname>Comstock</surname><given-names>JC</given-names></name></person-group><article-title>Monitoring sugarcane rust spore concentrations by real-time qPCR and passive spore trapping</article-title><source>Phytopathology</source><year>2011</year><volume>101</volume><fpage>S61</fpage><lpage>S61</lpage></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deng</surname><given-names>X</given-names></name><etal/></person-group><article-title>Detection of citrus Huanglongbing based on image feature extraction and two-stage BPNN modeling</article-title><source>Int. J. Agric. Biol. Eng.</source><year>2016</year><volume>9</volume><fpage>20</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1186/s13036-015-0018-8</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">Wang, H., Li, G., Ma, Z. &#x00026; Li, X. Image Recognition of Plant Diseases Based on Backpropagation Networks. <italic>2012 5th International Congress on Image and Signal Processing (Cisp)</italic> 894&#x02013;900 (2012).</mixed-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barbedo</surname><given-names>JGA</given-names></name><name><surname>Koenigkan</surname><given-names>LV</given-names></name><name><surname>Santos</surname><given-names>TT</given-names></name></person-group><article-title>Identifying multiple plant diseases using digital image processing</article-title><source>Biosys. Eng.</source><year>2016</year><volume>147</volume><fpage>104</fpage><lpage>116</lpage><pub-id pub-id-type="doi">10.1016/j.biosystemseng.2016.03.012</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>You</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name></person-group><article-title>Leaf image based cucumber disease recognition using sparse representation classification</article-title><source>Comput. Electron. Agric.</source><year>2017</year><volume>134</volume><fpage>135</fpage><lpage>141</lpage><pub-id pub-id-type="doi">10.1016/j.compag.2017.01.014</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shrivastava</surname><given-names>S</given-names></name><name><surname>Singh</surname><given-names>SK</given-names></name><name><surname>Hooda</surname><given-names>DS</given-names></name></person-group><article-title>Color sensing and image processing-based automatic soybean plant foliar disease severity detection and estimation</article-title><source>Multimed. Tools Appl.</source><year>2015</year><volume>74</volume><fpage>11467</fpage><lpage>11484</lpage><pub-id pub-id-type="doi">10.1007/s11042-014-2239-0</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Parikh, A., Raval, M. S., Parmar, C., Chaudhary, S. &#x00026; Ieee Disease Detection and Severity Estimation in Cotton Plant from Unconstrained Images. <italic>Proceedings of 3rd Ieee/Acm International Conference on Data Science and Advanced Analytics, (Dsaa 2016)</italic>, 594&#x02013;601 (2016).</mixed-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>XL</given-names></name><etal/></person-group><article-title>Development of automatic counting system for urediospores of wheat stripe rust based on image processing</article-title><source>Int. J. Agric. Biol. Eng.</source><year>2017</year><volume>10</volume><fpage>134</fpage><lpage>143</lpage></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chesmore</surname><given-names>D</given-names></name><name><surname>Bernard</surname><given-names>T</given-names></name><name><surname>Inman</surname><given-names>AJ</given-names></name><name><surname>Bowyer</surname><given-names>RJ</given-names></name></person-group><article-title>Image analysis for the identification of the quarantine pest Tilletia indica</article-title><source>EPPO Bulletin</source><year>2003</year><volume>33</volume><fpage>495</fpage><lpage>499</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2338.2003.00686.x</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Yan</surname><given-names>Y</given-names></name></person-group><article-title>The identification of powdery mildew spores image based on the integration of intelligent spore image sequence capture device</article-title><source>2013 Ninth International Conference on Intelligent Information Hiding and Multimedia Signal Processing (Iih-Msp 2013)</source><year>2013</year><volume>2013</volume><fpage>177</fpage><lpage>180</lpage></element-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="other">Xu, P. Y. &#x00026; Li, J. G. Computer assistance image processing spores counting, Loach, K. ed. <italic>2009 International Asia Conference on Informatics in Control, Automation, and Robotics, Proceedings</italic><bold>2009</bold>, 203&#x02013;206 (2009).</mixed-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>DG</given-names></name><name><surname>Pham</surname><given-names>TD</given-names></name><name><surname>Zhou</surname><given-names>XB</given-names></name></person-group><article-title>Analysis and recognition of touching cell images based on morphological structures</article-title><source>Comput. Biol. Med.</source><year>2009</year><volume>39</volume><fpage>27</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1016/j.compbiomed.2008.10.006</pub-id><?supplied-pmid 19084831?><pub-id pub-id-type="pmid">19084831</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gharipour</surname><given-names>A</given-names></name><name><surname>Liew</surname><given-names>AW-C</given-names></name></person-group><article-title>Segmentation of cell nuclei in fluorescence microscopy images: An integrated framework using level set segmentation and touching-cell splitting</article-title><source>Pattern Recogn.</source><year>2016</year><volume>58</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1016/j.patcog.2016.03.030</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>P</given-names></name><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name></person-group><article-title>Automatic cell nuclei segmentation and classification of breast cancer histopathology images</article-title><source>Math. Comput. Modell.</source><year>2016</year><volume>122</volume><fpage>1</fpage><lpage>13</lpage></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>D</given-names></name><name><surname>Song</surname><given-names>H</given-names></name><name><surname>Tie</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>He</surname><given-names>D</given-names></name></person-group><article-title>Recognition and localization of occluded apples using K-means clustering algorithm and convex hull theory: a comparison</article-title><source>Multimed. Tools Appl.</source><year>2016</year><volume>75</volume><fpage>3177</fpage><lpage>3198</lpage><pub-id pub-id-type="doi">10.1007/s11042-014-2429-9</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yue</surname><given-names>X</given-names></name><name><surname>Yinghui</surname><given-names>L</given-names></name><name><surname>Huaibo</surname><given-names>S</given-names></name><name><surname>Dongjian</surname><given-names>H</given-names></name></person-group><article-title>Segmentation method of overlapped double apples based on Snake model and corner detectors</article-title><source>Transactions of the CSAE</source><year>2015</year><volume>31</volume><fpage>196</fpage><lpage>203</lpage></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>L</given-names></name><name><surname>Park</surname><given-names>CW</given-names></name><name><surname>Lee</surname><given-names>SR</given-names></name><name><surname>Lee</surname><given-names>CY</given-names></name></person-group><article-title>New separation algorithm for touching grain kernels based on contour segments and ellipse fitting</article-title><source>J. Zhejiang Univ. Sci. Comput. Electron.</source><year>2011</year><volume>12</volume><fpage>54</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1631/jzus.C0910797</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mebatsion</surname><given-names>HK</given-names></name><name><surname>Paliwal</surname><given-names>J</given-names></name></person-group><article-title>A Fourier analysis based algorithm to separate touching kernels in digital images</article-title><source>Biosys. Eng.</source><year>2011</year><volume>108</volume><fpage>66</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1016/j.biosystemseng.2010.10.011</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>P</given-names></name><name><surname>Chen</surname><given-names>YM</given-names></name><name><surname>He</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>GW</given-names></name></person-group><article-title>A novel matching algorithm for splitting touching rice kernels based on contour curvature analysis</article-title><source>Comput. Electron. Agric.</source><year>2014</year><volume>109</volume><fpage>124</fpage><lpage>133</lpage><pub-id pub-id-type="doi">10.1016/j.compag.2014.09.015</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">Cheng, H., Peng, H. &#x00026; Liu, S. An improved K-means clustering algorithm in agricultural image segmentation. <italic>In</italic>: Tan H. Piageng 2013: Image Processing and Photonics for Agricultural Engineeringed., vol. 8761 (2013).</mixed-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>H</given-names></name><name><surname>Duan</surname><given-names>Q</given-names></name><name><surname>Li</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><article-title>An improved K-means clustering algorithm for fish image segmentation</article-title><source>Math. Comput. Modell.</source><year>2013</year><volume>58</volume><fpage>784</fpage><lpage>792</lpage></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>MJ</given-names></name><etal/></person-group><article-title>A deep convolutional neural network for classification of red blood cells in sickle cell anemia</article-title><source>PLoS Comp. Biol.</source><year>2017</year><volume>13</volume><fpage>27</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005746</pub-id></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitzgibbon</surname><given-names>A</given-names></name><name><surname>Pilu</surname><given-names>M</given-names></name><name><surname>Fisher</surname><given-names>RB</given-names></name></person-group><article-title>Direct least square fitting of ellipses</article-title><source>IEEE T. Patteron Anal.</source><year>1999</year><volume>21</volume><fpage>476</fpage><lpage>480</lpage><pub-id pub-id-type="doi">10.1109/34.765658</pub-id></element-citation></ref></ref-list></back></article>