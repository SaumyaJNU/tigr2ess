<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Plant Methods</journal-id><journal-id journal-id-type="iso-abbrev">Plant Methods</journal-id><journal-title-group><journal-title>Plant Methods</journal-title></journal-title-group><issn pub-type="epub">1746-4811</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6238276</article-id><article-id pub-id-type="publisher-id">369</article-id><article-id pub-id-type="doi">10.1186/s13007-018-0369-5</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>A method to calculate the number of wheat seedlings in the 1st to the 3rd leaf growth stages</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6788-1330</contrib-id><name><surname>Liu</surname><given-names>Tao</given-names></name><address><email>34626459@qq.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Tianle</given-names></name><address><email>5997643@qq.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Li</surname><given-names>Chunyan</given-names></name><address><email>licy@yzu.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Li</surname><given-names>Rui</given-names></name><address><email>ruili023@163.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Wu</surname><given-names>Wei</given-names></name><address><email>weiwu327@qq.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Zhong</surname><given-names>Xiaochun</given-names></name><address><email>Zhongxiaochun@caas.cn</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Sun</surname><given-names>Chengming</given-names></name><address><email>cmsun@yzu.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Guo</surname><given-names>Wenshan</given-names></name><address><email>Guows@yzu.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.268415.c</institution-id><institution>Jiangsu Key Laboratory of Crop Genetics and Physiology/Co-Innovation Center for Modern Production Technology of Grain Crops, </institution><institution>Yangzhou University, </institution></institution-wrap>Yangzhou, 225009 China </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0369 6250</institution-id><institution-id institution-id-type="GRID">grid.418524.e</institution-id><institution>Key Laboratory of Agro-information Services Technology, </institution><institution>Ministry of Agriculture, </institution></institution-wrap>Beijing, 100081 China </aff></contrib-group><pub-date pub-type="epub"><day>16</day><month>11</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>16</day><month>11</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>14</volume><elocation-id>101</elocation-id><history><date date-type="received"><day>12</day><month>11</month><year>2017</year></date><date date-type="accepted"><day>12</day><month>11</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p id="Par1">The number of cultivated wheat seedlings per unit area allows calculation of plant density. Wheat seedling density provides emergence data and this is useful for improving crop management. The number of wheat seedlings is typically determined by visual counts but this is time-consuming and laborious.</p></sec><sec><title>Results</title><p id="Par2">We obtained field digital images of 1st to 3rd leaf stage wheat seedlings. The seedlings were extracted using an image analysis technique that calculated the coverage degree of the seedlings and the number of angular points of overlapping leaves. The wheat seedling quantity estimation model was constructed using multivariate regression analysis. The model parameters included coverage degree, number of angular points, variety coefficient, and leaf age. Introduction of the number of angular points increased the accuracy of the single coverage degree model. The R<sup>2</sup> value was consistently&#x02009;&#x0003e;&#x02009;0.95 when the model was applied to different varieties, indicating that the model was adaptable for different varieties. As the leaf stage or density increased, the accuracy of the model declined, but the minimum R<sup>2</sup> remained&#x02009;&#x0003e;&#x02009;0.87, indicating good adaptability of the model to seedlings with different leaf ages and densities.</p></sec><sec><title>Conclusions</title><p id="Par3">This method is an effective means for counting wheat seedlings in the 1st to the 3rd leaf stages.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Wheat seedling numbers</kwd><kwd>1st to the 3rd leaf stages</kwd><kwd>Image processing</kwd><kwd>Models</kwd><kwd>Multivariate analysis</kwd></kwd-group><funding-group><award-group><funding-source><institution>The National Natural Science Foundation of China</institution></funding-source><award-id>31701355</award-id><award-id>31671615</award-id><principal-award-recipient><name><surname>Liu</surname><given-names>Tao</given-names></name><name><surname>Sun</surname><given-names>Chengming</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002858</institution-id><institution>China Postdoctoral Science Foundation</institution></institution-wrap></funding-source><award-id>2016M600448</award-id><principal-award-recipient><name><surname>Liu</surname><given-names>Tao</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution>The National Key Research and Development Program of China</institution></funding-source><award-id>2016YFD0300107</award-id><principal-award-recipient><name><surname>Li</surname><given-names>Chunyan</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p id="Par4">Wheat yield and quality are affected by planting density [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. An optimal density of wheat seedlings provides the best canopy structure and yield. Determining the number of wheat seedlings per unit area provides information on seedling emergence and is the basis for subsequent cultivation and management [<xref ref-type="bibr" rid="CR3">3</xref>]. The number of seedlings is usually determined manually but manual count is laborious.</p><p id="Par5">Image analysis techniques have been applied to several aspects of plant production. Common applications include estimation of crop biomass [<xref ref-type="bibr" rid="CR4">4</xref>], diagnosis of nutritional status [<xref ref-type="bibr" rid="CR5">5</xref>], analysis of growth [<xref ref-type="bibr" rid="CR6">6</xref>], monitoring of fertility processes [<xref ref-type="bibr" rid="CR7">7</xref>], analysis of crop structure [<xref ref-type="bibr" rid="CR8">8</xref>], and monitoring of diseases, insects, pests, and weeds [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Image analysis has also been used to study plant quantitative traits [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], such as fruit counts [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], crop grain counts [<xref ref-type="bibr" rid="CR15">15</xref>], and pest counts [<xref ref-type="bibr" rid="CR16">16</xref>]. For the wheat crop, some researchers analyzed the phenotypic traits by image processing technology [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. There are, however, few reports on the use of image analysis for wheat seedling counts. Recently, researchers have proposed a method for wheat plant counting at the emergence stage based on high spatial resolution RGB images taken from the ground level either from a rover system or from hand held cameras [<xref ref-type="bibr" rid="CR19">19</xref>]. For reaching the high throughput required for field phenotyping, Jin et al. [<xref ref-type="bibr" rid="CR20">20</xref>]. proposed a plant counting method from very low altitude unmanned aerial vehicle (UAV) imagery. Although these studies are very useful at the emergence stage of wheat crops, it may be unable to count plants at other leaf stages. Wheat seedlings are not as regular in shape as crop grains or fruits. As a result, overlapping objects are difficult to separate. For the reason of curled leaves, the posture of seedlings are diverse. It also add to the difficulty of segmentation. Finally, there are differences between different varieties of wheat seedlings. Therefore, the image segmentation and counting methods used in previous studies are not useful for counting wheat seedlings.</p><p id="Par6">We optimized the skeleton structure of wheat seedlings using the freeman chain code [<xref ref-type="bibr" rid="CR21">21</xref>]. Wheat seedlings in the 1st leaf stage were reconstructed into segments to accurately identify each wheat seedling and to complete counting [<xref ref-type="bibr" rid="CR22">22</xref>]. However, this counting method was restricted to wheat at the 1st leaf stage, the individuals of which can be easily overlooked. Studies on seedling emergence are generally performed during the 1st to the 3rd leaf stages. This provides knowledge of the areas where seedlings are at low density and facilitates additional seeding. In this study, an image analysis technique was used to study methods for rapidly assessing seedling quantity during the 1st&#x02013;3rd leaf stages, and to analyze differences in the counting of wheat seedlings of different varieties, different leaf ages, and different planting density. We used these data to construct a model for estimating the number of wheat seedlings.</p></sec><sec id="Sec2"><title>Methods</title><sec id="Sec3"><title>Field experiment and image acquisition</title><p id="Par7">Three wheat varieties, YM23, YF4, and HM7, were manually planted. Two sites in China were studied in 2016: Huaian, Yangzhou. The treatments at sites were the same. The date of sowing was 11 November 2016. The wheat cultivar and experimental design are shown in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>.The size of all the plots is 3&#x000a0;m&#x02009;&#x000d7;&#x02009;4&#x000a0;m, all the treatments were repeated once. The N rate was 240&#x000a0;kg&#x000a0;ha<sup>&#x02212;1</sup>. Here, 50%, 10%, 20%, and 20% total nitrogen treatments were applied at the sowing, tillering, jointing, and booting stages, respectively. As noted in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>, three common seedling types were selected for the experiments. Coverage of these wheat varieties with different seedling types is different. Coverage of lax seedlings is more than the half erect seedlings when the numbers of leaves are the same, and coverage of erect seedlings is the minimum among these three seedling types [<xref ref-type="bibr" rid="CR23">23</xref>]. So, the variety parameters (<italic>Va</italic>) were selected to reduce the impact of the coverage difference among varieties.<table-wrap id="Tab1"><label>Table&#x000a0;1</label><caption><p>Basic information of the experiments</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cultivars</th><th align="left">Seedlings type</th><th align="left">Density (10<sup>4</sup>&#x000a0;plants ha<sup>&#x02212;1</sup>)</th></tr></thead><tbody><tr><td align="left" rowspan="4">YM23</td><td align="left" rowspan="4">Half erect</td><td char="." align="char">75</td></tr><tr><td char="." align="char">150</td></tr><tr><td char="." align="char">225</td></tr><tr><td char="." align="char">300</td></tr><tr><td align="left" rowspan="4">HM7</td><td align="left" rowspan="4">Lax</td><td char="." align="char">75</td></tr><tr><td char="." align="char">150</td></tr><tr><td char="." align="char">225</td></tr><tr><td char="." align="char">300</td></tr><tr><td align="left" rowspan="4">YF4</td><td align="left" rowspan="4">Erect</td><td char="." align="char">75</td></tr><tr><td char="." align="char">150</td></tr><tr><td char="." align="char">225</td></tr><tr><td char="." align="char">300</td></tr></tbody></table></table-wrap>
</p><p id="Par8">A Sony Nex5r digital camera was used to capture field images in the late afternoon with dim sunlight or on cloudy days. The camera was set to shutter speed priority with auto adjustment of the ISO up to a maximum of ISO&#x02009;=&#x02009;1200. The image capture height was approximately 1.5&#x000a0;m, and the counting area was marked by a 1&#x000a0;m&#x02009;&#x000d7;&#x02009;1&#x000a0;m square. During the 1st&#x02013;3rd leaf stages, imaging was performed every 3&#x000a0;days and was repeated five times per treatments. The captured images were 6000&#x02009;&#x000d7;&#x02009;4000 pixels. Image transformation, cutting, characteristics extracting and regression analysis were made using MATLAB software (version 2015b, MathWorks, USA). Reference seedling numbers were computed from manual visual counts by PhotoShop (version CS6, Adobe Systems Software Ireland Ltd, USA). The flowchart of data processing and wheat seedling counts is shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig.&#x000a0;1</label><caption><p>Flowchart of data processing and wheat seedling counting</p></caption><graphic xlink:href="13007_2018_369_Fig1_HTML" id="MO1"/></fig>
</p></sec><sec id="Sec4"><title>Extraction of target area</title><p id="Par9">To calculate the number of wheat seedlings, the unit area was extracted first. We selected the area marked by the white quadrangle as the target area (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a, which was corrected using the steps below:<fig id="Fig2"><label>Fig.&#x000a0;2</label><caption><p>Extraction and rectification of target area: <bold>a</bold> original image; <bold>b</bold> frame extraction and corner detection; <bold>c</bold> perspective transformation; <bold>d</bold> target area extraction</p></caption><graphic xlink:href="13007_2018_369_Fig2_HTML" id="MO2"/></fig>
<list list-type="order"><list-item><p id="Par10">The white quadrangles in the original images were extracted using Eq.&#x000a0;<xref rid="Equ1" ref-type="">1</xref>. With F(x, y) as the white quadrangle, the color components of red, green, and blue in the RGB images are represented by r, g, and b, respectively. The parameters in Eq.&#x000a0;<xref rid="Equ1" ref-type="">1</xref> were got by color Features of white quadrangles, wheat seedlings, soil and straws.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{F}}\left( {{\text{x}},{\text{y}}} \right) = \left\{ {\begin{array}{*{20}l} {r\left( {x,y} \right) + g\left( {x,y} \right) + b\left( {x,y} \right) &#x0003e; 2.1} \hfill \\ {r\left( {x,y} \right) - b\left( {x,y} \right) &#x0003c; 0.05} \hfill \\ \end{array} } \right\}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mtext>F</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>x</mml:mtext><mml:mo>,</mml:mo><mml:mtext>y</mml:mtext></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>r</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x0003e;</mml:mo><mml:mn>2.1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mi>r</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x0003c;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13007_2018_369_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p></list-item><list-item><p id="Par11">Four inflection points of the white quadrangle were extracted. The curvature of the boundary points of the white quadrangle were calculated using Eq.&#x000a0;<xref rid="Equ2" ref-type="">2</xref>, and the 4 angular points were acquired through the variations of the curvature. <italic>C</italic><sub>(<italic>k</italic>,<italic>i</italic>)</sub> represents the k neighborhood chain code at the boundary point I; <italic>&#x003b8;i</italic> is the difference of the tangent inclination at the boundary point; and <italic>&#x003c6;</italic><sub><italic>i</italic></sub> is the preliminary curvature at the boundary point i. The preliminary curvature value <italic>&#x003c6;</italic><sub><italic>i</italic></sub> of the inflection point and its nearby points were relatively large. For this reason, the curvature value <italic>e</italic><sub><italic>i</italic></sub> represents the inflection point. k is the chain code of the pixel.<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\begin{array}{*{20}l} {\uptheta_{i} = \left| {C_{{\left( {k, i + \frac{k}{8}} \right)}} - C_{{\left( {k,i} \right)}} } \right|} \hfill \\ {\varphi_{i} = \left\{ {\begin{array}{*{20}l} {\uptheta_{i} } \hfill &#x00026; {\uptheta_{i} \le k /2} \hfill \\ {k -\uptheta_{i} } \hfill &#x00026; {\uptheta_{i} &#x0003e; k /2} \hfill \\ \end{array} } \right.} \hfill \\ {e_{i} = \varphi_{i} \mathop \sum \limits_{j = - 1}^{1} \varphi_{i + j} } \hfill \\ \end{array} } \right.$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x003b8;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>8</mml:mn></mml:mfrac></mml:mrow></mml:mfenced></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi mathvariant="normal">&#x003b8;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x003b8;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x003b8;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x003b8;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:munderover><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13007_2018_369_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p></list-item><list-item><p id="Par12">For the image perspective transformation, the different imaging positions distorted the white-quadrangle area which could influence post-processing. Therefore, a perspective transformation was applied to the images using Eq.&#x000a0;<xref rid="Equ3" ref-type="">3</xref>. The point <italic>u</italic>, <italic>v</italic> was at the right side of the original image. The coordinates after transformation were <italic>x&#x02009;</italic>=&#x02009;<italic>x</italic>&#x02032;<italic>/w</italic>&#x02032;, <italic>y&#x02009;</italic>=&#x02009;<italic>y</italic>&#x02032;<italic>/w</italic>&#x02032;. The matrix indicates linear transformation and translation. Equation coefficients were solved using the 4 known points.<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[ {x^{\prime } ,y^{\prime } ,w^{\prime } } \right] = \left[ {u,v,w} \right]\left[ {\begin{array}{*{20}c} {a_{11} } &#x00026; {a_{12} } &#x00026; {a_{13} } \\ {a_{21} } &#x00026; {a_{22} } &#x00026; {a_{23} } \\ {a_{31} } &#x00026; {a_{32} } &#x00026; {a_{33} } \\ \end{array} } \right]$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>23</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mn>31</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>32</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>33</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13007_2018_369_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p></list-item><list-item><p id="Par13">For image cutting, the original white quadrangle was converted to a square in the transformed image. The target area is the inside of the white quadrangle. All the target areas were changed to 800&#x02009;&#x000d7;&#x02009;800 pixels.</p></list-item></list>
</p><p id="Par14">The extraction results of measurement region are shown in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>. The white quadrangles in the original images (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a) were extracted successfully (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b), and four inflection points of the white quadrangle were extracted successfully by the boundary curvature (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b). Perspective transformation was solved by 4 known points in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b, and the transformative image is shown in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>c. A 1-m<sup>2</sup> region was obtained after cutting processing (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>d). The distortion of the image caused during the photography could be eliminated properly. The results showed that a normative 1-m<sup>2</sup> region could be obtained accurately by the white squares and image processing methods in Sect.&#x000a0;<xref rid="Sec4" ref-type="sec">2.2</xref>.</p></sec><sec id="Sec5"><title>Extraction of wheat seedlings</title><p id="Par15">Otsu&#x02019;s method uses a threshold to transform an original image to a foreground and background [<xref ref-type="bibr" rid="CR24">24</xref>]. In this study, we combined ExG (Eq.&#x000a0;<xref rid="Equ4" ref-type="">4</xref>) and Otsu&#x02019;s method to extract wheat seedling information. The complete wheat seedlings were extracted by morphologic corrosion, expansion, and hole filling [<xref ref-type="bibr" rid="CR7">7</xref>]. The MATLAB functions strel, imopen and imfill were used in this step.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ExG = 1.8 * {\text{g}} - {\text{r}} - {\text{b}}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mi>E</mml:mi><mml:mi>x</mml:mi><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mn>1.8</mml:mn><mml:mrow/><mml:mo>&#x02217;</mml:mo><mml:mtext>g</mml:mtext><mml:mo>-</mml:mo><mml:mtext>r</mml:mtext><mml:mo>-</mml:mo><mml:mtext>b</mml:mtext></mml:mrow></mml:math><graphic xlink:href="13007_2018_369_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>
</p></sec><sec id="Sec6"><title>Extraction of characteristic values</title><p id="Par16">Images of wheat seedlings with different leaf ages and overlapping situations are shown in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>. The coverage degree and the number of angular points in the area increased with increased leaf age and the number of overlapping wheat seedlings.<fig id="Fig3"><label>Fig.&#x000a0;3</label><caption><p>Images of wheat seedlings with different quantities and leaf ages</p></caption><graphic xlink:href="13007_2018_369_Fig3_HTML" id="MO7"/></fig>
</p><p id="Par17">The greater the density of wheat seedlings in a unit area, the greater the degree of coverage. However, the estimation model is inadequate when constructed using only the coverage degree. The reasons for this are: (1) Coverage degree is affected by overlapped wheat seedlings, and only the reduction of this affect can improve the adaptability of the model. (2) The angular point was the point of the leaf which has a local extremum, it includes leaf tip, the intersection of two leaves (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>) and distorted leaves (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>). Angular points will occur on the leaves when the wheat seedlings overlap. The greater the overlap, the more angular points there are. Therefore, the number of angular points can reflect the overlap degree of wheat seedlings. (3) The optimal period to study the number of wheat seedlings is during the 1st&#x02013;3rd leaf stages. The coverage degree is affected by the difference in leaf age, so the leaf age should be considered when establishing a model. (4) Different varieties of wheat have seedlings with different leaf sizes and this will also influence the degree of coverage. Wheat variety is a key factor in developing an estimation model. For these reasons, we believe that a model that accurately estimates the number of wheat seedlings per unit area should include the following: coverage degree of wheat seedlings (Co), number of angular points (Ha) that reflect the degree of overlap, leaf age (La), and wheat variety (Va). The leaf age and variety were acquired manually.<fig id="Fig4"><label>Fig.&#x000a0;4</label><caption><p>Characteristics of leaves with varying degrees of overlap (only one samples)</p></caption><graphic xlink:href="13007_2018_369_Fig4_HTML" id="MO8"/></fig>
<fig id="Fig5"><label>Fig.&#x000a0;5</label><caption><p>Coverage and corners number of distorted leaves(only one samples)</p></caption><graphic xlink:href="13007_2018_369_Fig5_HTML" id="MO9"/></fig>
</p><p id="Par18">The coverage degree is the ratio of pixels of leaves to total pixels per unit area. It is calculated by Eq.&#x000a0;<xref rid="Equ5" ref-type="">5</xref> [<xref ref-type="bibr" rid="CR6">6</xref>].<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Co = \frac{Seedling Area}{\text{Image area}}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">SeedlingArea</mml:mi></mml:mrow><mml:mrow><mml:mtext>Image area</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13007_2018_369_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>
</p><p id="Par19">The angular points in the images were detected by Eqs.&#x000a0;<xref rid="Equ6" ref-type="">6</xref>&#x02013;<xref rid="Equ8" ref-type="">8</xref>. E(u, v) is the change value of grayscale; u and v are the movement amount of horizontal and vertical directions; <italic>Ix</italic>, <italic>Iy</italic> is the grayscale value of the image; w(x, y) is the window function; and R is the response function of angular points [<xref ref-type="bibr" rid="CR25">25</xref>]. When the displacements of the window along x and y direction were <italic>u</italic> and <italic>v</italic>, respectively, the grayscale change can be given by Eqs.&#x000a0;(<xref rid="Equ6" ref-type="">6</xref>, <xref rid="Equ7" ref-type="">7</xref>).<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\rm E}(u,v) &#x00026; = \sum\limits_{x,y} {w(x,y)} \left[ {{\rm I}\left( {x + u,y + \nu } \right) - {\rm I}\left( {x,y} \right)} \right]^{2} \\ &#x00026; = [u,\nu ]\sum\limits_{x,y} {w(x,y)} \left[ {\begin{array}{*{20}c} {I_{x}^{2} } &#x00026; {I_{x} I_{y} } \\ {I_{x} I_{y} } &#x00026; {I_{y}^{2} } \\ \end{array} } \right]\left[ {\begin{array}{*{20}c} u \\ \nu \\ \end{array} } \right]\,{ = }[u,\nu ]M\left[ {\begin{array}{*{20}c} u \\ \nu \\ \end{array} } \right] \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003bd;</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003bd;</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>u</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>&#x003bd;</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="0.166667em"/><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003bd;</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>M</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>u</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>&#x003bd;</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13007_2018_369_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M\,{ = }\sum\limits_{x,y} {w(x,y)} \left[ {\begin{array}{*{20}c} {I_{x}^{2} } &#x00026; {I_{x} I_{y} } \\ {I_{x} I_{y} } &#x00026; {I_{y}^{2} } \\ \end{array} } \right]$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mi>M</mml:mi><mml:mspace width="0.166667em"/><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13007_2018_369_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>
</p><p id="Par20">In the processing of corner points detection, <italic>E</italic>(<italic>u</italic>, <italic>v</italic>) will change significantly how regardless of the (<italic>u</italic>, <italic>v</italic>) do change, these points are corner points. The value of <italic>M</italic> is the determining factor in corner point detection. Hence, the function of corner can be expressed as<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{R}} = \det \left( {\text{M}} \right) - {\text{k}}*trace^{2} \left( M \right)$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mrow><mml:mtext>R</mml:mtext><mml:mo>=</mml:mo><mml:mo movablelimits="true">det</mml:mo><mml:mfenced close=")" open="("><mml:mtext>M</mml:mtext></mml:mfenced><mml:mo>-</mml:mo><mml:mtext>k</mml:mtext><mml:mrow/><mml:mo>&#x02217;</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="("><mml:mi>M</mml:mi></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13007_2018_369_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <italic>det</italic>(<italic>M</italic>) is the determinant of <italic>M</italic>, <italic>trace</italic>(<italic>M</italic>) is the trace of <italic>M. k</italic> is constant, and it takes 0.04 here. <italic>k</italic> is and empirical constant, it takes 0.04&#x02013;0.06. It depends on the size of the image.</p></sec><sec id="Sec7"><title>Influence of leaf morphology on coverage degree and the number of angular points</title><p id="Par21">Normally, the accuracy of wheat seedling estimation is not high when only use coverage alone to model. This is mainly due to the overlapped and curled leaves. Leaves in the images are either independent or overlapping. As shown in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>, when four identical leaves were present in the same area in the form of non-overlapped, slightly overlapped, and highly overlapped, the coverage degree decreased, and the number of angular points increased. For a given number of leaves, the coverage degree and the number of angular points were negatively correlated. Curling of leaf blades affects the degree of coverage. Because of leaf curling, the number of angular points increased while the coverage degree decreased (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>). Thus, the number of angular points is an important parameter reflecting the overlap of wheat seedlings and the curling of leaves. Combining the number of angular points with coverage degree can improve the accuracy of wheat seedling estimation.</p></sec><sec id="Sec8"><title>Model construction</title><p id="Par22">The datasets (images) were separated into two sub-datasets for model training (720 observations in Huaian) and model validation (720 observations in Yangzhou). As the first step for model calibration, correlation analysis was performed between coverage degree (<italic>Co</italic>) and the number of wheat seedlings. The number of angular points (<italic>Ha</italic>) was also increased with the number of wheat seedlings. As the relationship between <italic>Co</italic> and seedlings number was found to be significantly different among leaf stages and varieties, the parameters of leaf age (La) and variety (Va) should be considered to count seedlings number more correctly. Thus, the stepwise multiple linear regression (SMLR) analysis was adopted to calibrate models to count the number of wheat seedlings by using <italic>Co</italic>, <italic>Ha</italic>, La and Va as predictor variables. SMLR method is based on the assumption that linear relationship exists between the number of wheat seedlings and Co. The performance of model equations derived from SMLR analysis was evaluated by the coefficients of determination (R<sup>2</sup>), adjusted R<sup>2</sup> (A-R<sup>2</sup>), the root mean square error in prediction (RMSE), and the relative error in prediction (REP). R<sup>2</sup> and RMSE were used to describe the stability of the model and the mean deviation between the measured value and the true value. Adjusted R<sup>2</sup> and REP were used to evaluate the prediction accuracy of the model. In addition, variety, leaf age, and density were verified.</p></sec></sec><sec id="Sec9"><title>Results and analysis</title><sec id="Sec10"><title>Extraction of wheat seedlings</title><p id="Par23">The wheat seedlings in the target area were extracted using Eq.&#x000a0;<xref rid="Equ4" ref-type="">4</xref>. Some inclusions (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>a) were eliminated using morphologic corrosion and expansion (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>b) to improve the calculation accuracy of the coverage degree and detection of angular points. Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>c shows that the inflection point of wheat seedlings in the images can be detected accurately by Eqs.&#x000a0;<xref rid="Equ6" ref-type="">6</xref>&#x02013;<xref rid="Equ8" ref-type="">8</xref>, providing accurate basic parameters for later model construction. The results suggested that accurate extraction of seedlings should combine color indices and mathematical morphology operation. Further, accurate extraction is the basis for measurement of the coverage degree and detection of angular points.<fig id="Fig6"><label>Fig.&#x000a0;6</label><caption><p>Wheat seedling extraction and angular point detection: <bold>a</bold> segmentation results by ExG; <bold>b</bold> morphological processing results; <bold>c</bold> corner point detection results</p></caption><graphic xlink:href="13007_2018_369_Fig6_HTML" id="MO14"/></fig>
</p></sec><sec id="Sec11"><title>Single-factor coverage degree model</title><p id="Par24">The coverage degree of wheat seedlings is highly correlated to their quantity at the 1st&#x02013;3rd leaf stages. The effect of the wheat seedling estimation model at different periods constructed solely using the coverage degree is shown in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>. R<sup>2</sup> of the estimation model reached a peak at the 1st stage, but declined with an increase in density or leaf age. R<sup>2</sup> ranged from 0.57 to 0.89. Even though the coverage degree can be used to predict trends in the number of wheat seedlings, the accuracy was relatively low, especially during the late growth stage and under conditions of high seedling density. The results indicate that there are large differences among the estimation models at different leaf ages when only the coverage degree is used to construct the model. These differences will complicate applications.<fig id="Fig7"><label>Fig.&#x000a0;7</label><caption><p>Estimation of the number of wheat seedlings with different leaf ages and densities using the coverage degree. The datasets are these images for model training (720 observations), and each treatment has 60 data. The densities of images from the first line to the fourthly are 75&#x02009;&#x000d7;&#x02009;10<sup>4</sup>&#x000a0;plants&#x000a0;ha<sup>&#x02212;1</sup>, 150&#x02009;&#x000d7;&#x02009;10<sup>4</sup>&#x000a0;plants&#x000a0;ha<sup>&#x02212;1</sup>, 225&#x02009;&#x000d7;&#x02009;10<sup>4</sup>&#x000a0;plants&#x000a0;ha<sup>&#x02212;1</sup>, 300&#x02009;&#x000d7;&#x02009;10<sup>4</sup>&#x000a0;plants&#x000a0;ha<sup>&#x02212;1</sup></p></caption><graphic xlink:href="13007_2018_369_Fig7_HTML" id="MO15"/></fig>
</p></sec><sec id="Sec12"><title>Multi-factor comprehensive model</title><p id="Par25">There was unsatisfactory accuracy of wheat seedling estimation using coverage alone, especially when planting density was high and after the 1st leaf stage. By combining the angular points (<italic>Ha</italic>) with the coverage degree (<italic>Co</italic>), and using the data of 3 varieties at the 1st, 2nd, and 3rd stages, an estimation model was constructed for wheat seedlings of different varieties and with different leaf ages (<italic>La</italic>) using SMLR (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>). Compared with estimation using only <italic>Co</italic>, the introduction of Ha significantly increased the R<sup>2</sup> value and lowered the RMSE and Rep values. The models in Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> could get high R<sup>2</sup> (more than 0.95) and low RMSE (less than 18) when all the data of sowing densities was pooled together to calibrate and validate the model. The results showed that the proposed angular points could reduce the influences of overlapped leaves and distorted leaves when estimating seedling numbers by the coverage degree. However, the estimation model of different varieties and leaf ages varied, which does not support its application.<table-wrap id="Tab2"><label>Table&#x000a0;2</label><caption><p>Model equations for estimating seedling number (SN) of different leaf ages using coverage degree and angular points</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Varieties</th><th align="left">La</th><th align="left">Models</th><th align="left">R<sup>2</sup></th><th align="left">Adjusted-R<sup>2</sup></th><th align="left">RMSE</th><th align="left">Rep (%)</th></tr></thead><tbody><tr><td align="left" rowspan="3">YM23</td><td char="." align="char">1</td><td align="left">SN<sub>1</sub>&#x02009;=&#x02009;0.47&#x02009;&#x000d7;&#x02009;Ha&#x02009;+&#x02009;119.37&#x02009;&#x000d7;&#x02009;Co&#x02009;+&#x02009;5.65</td><td char="." align="char">0.9867</td><td char="." align="char">0.9864</td><td char="." align="char">10.31</td><td char="." align="char">7.72</td></tr><tr><td char="." align="char">2</td><td align="left">SN<sub>2</sub>&#x02009;=&#x02009;0.22&#x02009;&#x000d7;&#x02009;Ha&#x02009;+&#x02009;58.64&#x02009;&#x000d7;&#x02009;Co&#x02009;+&#x02009;18.43</td><td char="." align="char">0.9781</td><td char="." align="char">0.9775</td><td char="." align="char">12.16</td><td char="." align="char">8.79</td></tr><tr><td char="." align="char">3</td><td align="left">SN<sub>3</sub>&#x02009;=&#x02009;0.15&#x02009;&#x000d7;&#x02009;Ha&#x02009;+&#x02009;37.65&#x02009;&#x000d7;&#x02009;Co&#x02009;+&#x02009;14.73</td><td char="." align="char">0.9706</td><td char="." align="char">0.9698</td><td char="." align="char">12.98</td><td char="." align="char">8.91</td></tr><tr><td align="left" rowspan="3">HM7</td><td char="." align="char">1</td><td align="left">SN<sub>1</sub>&#x02009;=&#x02009;0.41&#x02009;&#x000d7;&#x02009;Ha&#x02009;+&#x02009;97.13&#x02009;&#x000d7;&#x02009;Co&#x02009;+&#x02009;11.37</td><td char="." align="char">0.9765</td><td char="." align="char">0.9759</td><td char="." align="char">11.86</td><td char="." align="char">9.22</td></tr><tr><td char="." align="char">2</td><td align="left">SN<sub>2</sub>&#x02009;=&#x02009;0.19&#x02009;&#x000d7;&#x02009;Ha&#x02009;+&#x02009;43.93&#x02009;&#x000d7;&#x02009;Co&#x02009;+&#x02009;6.94</td><td char="." align="char">0.9611</td><td char="." align="char">0.9601</td><td char="." align="char">13.13</td><td char="." align="char">10.63</td></tr><tr><td char="." align="char">3</td><td align="left">SN<sub>3</sub>&#x02009;=&#x02009;0.13&#x02009;&#x000d7;&#x02009;Ha&#x02009;+&#x02009;31.05&#x02009;&#x000d7;&#x02009;Co&#x02009;+&#x02009;17.72</td><td char="." align="char">0.9508</td><td char="." align="char">0.9495</td><td char="." align="char">17.32</td><td char="." align="char">12.49</td></tr><tr><td align="left" rowspan="3">YF4</td><td char="." align="char">1</td><td align="left">SN<sub>1</sub>&#x02009;=&#x02009;0.52&#x02009;&#x000d7;&#x02009;Ha&#x02009;+&#x02009;125.21&#x02009;&#x000d7;&#x02009;Co&#x02009;+&#x02009;2.71</td><td char="." align="char">0.9806</td><td char="." align="char">0.9801</td><td char="." align="char">9.67</td><td char="." align="char">8.12</td></tr><tr><td char="." align="char">2</td><td align="left">SN<sub>2</sub>&#x02009;=&#x02009;0.25&#x02009;&#x000d7;&#x02009;Ha&#x02009;+&#x02009;59.35&#x02009;&#x000d7;&#x02009;Co&#x02009;+&#x02009;6.21</td><td char="." align="char">0.9713</td><td char="." align="char">0.9705</td><td char="." align="char">12.59</td><td char="." align="char">9.19</td></tr><tr><td char="." align="char">3</td><td align="left">SN<sub>3</sub>&#x02009;=&#x02009;0.16&#x02009;&#x000d7;&#x02009;Ha&#x02009;+&#x02009;39.11&#x02009;&#x000d7;&#x02009;Co&#x02009;+&#x02009;11.51</td><td char="." align="char">0.9549</td><td char="." align="char">0.9537</td><td char="." align="char">16.39</td><td char="." align="char">11.31</td></tr></tbody></table></table-wrap>
</p><p id="Par26">Among the different leaf age models in Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>, the <italic>Ha</italic> and <italic>Co</italic> coefficients declined with increasing leaf age. To normalize the model, the model transition from the 1st to the 3rd stage was transformed into<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{SN}} = \frac{{Va \times \left( {a \times Ha + b \times Co + c} \right)}}{d \times La}.$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mrow><mml:mtext>SN</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>H</mml:mi><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="13007_2018_369_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where SN is seedlings number, <italic>Va</italic> is the variety coefficient, <italic>Ha</italic> is the overlap degree of leaves, <italic>La</italic> is leaf age, <italic>a</italic>, <italic>b</italic> and <italic>c</italic> are the coefficient. The value of <italic>La</italic> should be confirmed after investigating the proportion of different leaf stages seedlings, and it&#x02019;s a non-integer. Based on the wheat seedling data of different varieties and leaf ages, <italic>a&#x02009;</italic>=&#x02009;0.44, <italic>b&#x02009;</italic>=&#x02009;110.43, <italic>c&#x02009;</italic>=&#x02009;3.35, and <italic>d&#x02009;</italic>=&#x02009;1.11, which were obtained by regression analysis. The modeling and validation results of the different varieties are shown in Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>. The R<sup>2</sup> value was always&#x02009;&#x0003e;&#x02009;0.95, and RMSE remained in a small range in both the modeling process and validation process. Adjustment of the variety parameter <italic>Va</italic> made the difference insignificant when the model was applied to different varieties. Compared with separate modeling, the accuracy of the overall model declined slightly, but its application scope and period increased.<table-wrap id="Tab3"><label>Table&#x000a0;3</label><caption><p>Calibration and validation results of the seedling number estimation model (Eq.&#x000a0;<xref rid="Equ9" ref-type="">9</xref>)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Varieties</th><th align="left" rowspan="2">
<italic>Va</italic>
</th><th align="left" colspan="4">Training</th><th align="left" colspan="4">Validation</th></tr><tr><th align="left">R<sup>2</sup></th><th align="left">A-R<sup>2</sup></th><th align="left">RMSE</th><th align="left">Rep (%)</th><th align="left">R<sup>2</sup></th><th align="left">A-R<sup>2</sup></th><th align="left">RMSE</th><th align="left">Rep (%)</th></tr></thead><tbody><tr><td align="left">YM23</td><td char="." align="char">1.05</td><td char="." align="char">0.9626</td><td char="." align="char">0.9620</td><td char="." align="char">18.4</td><td char="." align="char">8.17</td><td char="." align="char">0.9386</td><td char="." align="char">0.9370</td><td char="." align="char">20.27</td><td char="." align="char">9.72</td></tr><tr><td align="left">HM7</td><td char="." align="char">0.86</td><td char="." align="char">0.9533</td><td char="." align="char">0.9525</td><td char="." align="char">21.84</td><td char="." align="char">12.31</td><td char="." align="char">0.9183</td><td char="." align="char">0.9162</td><td char="." align="char">22.23</td><td char="." align="char">12.79</td></tr><tr><td align="left">YF4</td><td char="." align="char">1.12</td><td char="." align="char">0.9537</td><td char="." align="char">0.9529</td><td char="." align="char">23.06</td><td char="." align="char">14.25</td><td char="." align="char">0.9129</td><td char="." align="char">0.9106</td><td char="." align="char">22.99</td><td char="." align="char">15.01</td></tr></tbody></table></table-wrap>
</p></sec><sec id="Sec13"><title>Validation of leaf ages and densities</title><p id="Par27">There are differences in the model application, with respect to seedlings, at different densities and leaf ages. The accuracy of low density was higher than that of high density, and the R<sup>2</sup> of 75&#x02009;&#x000d7;&#x02009;10<sup>4</sup> density was always&#x02009;&#x0003e;&#x02009;0.95, while the R<sup>2</sup> of 300&#x02009;&#x000d7;&#x02009;10<sup>4</sup> density was approximately 0.9 (Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>). The accuracy in the 1st leaf stage was the highest, and its mean value was&#x02009;&#x0003e;&#x02009;0.95. Accuracy was lowest in the 3rd leaf stage, with a mean R<sup>2</sup> value of 0.91, and the R<sup>2</sup> values of 225&#x02009;&#x000d7;&#x02009;10<sup>4</sup> and 300&#x02009;&#x000d7;&#x02009;10<sup>4</sup> were&#x02009;&#x0003c;&#x02009;0.9. The above R<sup>2</sup> values were very high and the value of RMSE was small, indicating the reliability and high precision of the results. These results indicate that it is best to get images at the 1st or 2nd leaf stages, especially when plant densities are high.<fig id="Fig8"><label>Fig.&#x000a0;8</label><caption><p>Validation results of seedling counting model of different densities and leaf ages. The datasets are these images for model validation (720 observations), and each treatment has 60 data. The densities of images from the first line to the fourthly are 75&#x02009;&#x000d7;&#x02009;10<sup>4</sup>&#x000a0;plants&#x000a0;ha<sup>&#x02212;1</sup>, 150&#x02009;&#x000d7;&#x02009;10<sup>4</sup>&#x000a0;plants&#x000a0;ha<sup>&#x02212;1</sup>, 225&#x02009;&#x000d7;&#x02009;10<sup>4</sup>&#x000a0;plants&#x000a0;ha<sup>&#x02212;1</sup>, 300&#x02009;&#x000d7;&#x02009;10<sup>4</sup>&#x000a0;plants&#x000a0;ha<sup>&#x02212;1</sup></p></caption><graphic xlink:href="13007_2018_369_Fig8_HTML" id="MO17"/></fig>
</p></sec></sec><sec id="Sec14"><title>Discussion</title><p id="Par28">A multivariate model consisting of coverage degree, angular points, leaf age and variety coefficients was used to estimate the quantity of wheat seedling (Eq.&#x000a0;<xref rid="Equ9" ref-type="">9</xref>). The coverage degree was selected as the main parameter of this model because it is highly correlated with the number of wheat seedlings. The changes in the quantity can be reflected to some extent by solely using coverage degree, which is similar to previous results where coverage degree was used to estimate agronomic parameters [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. However, the overlap and degree of leaf curl were not considered in those studies. In the present study, the number of angular points strongly reflected the overlap and degree of leaf curl thereby improving the accuracy of estimation compared to a system that solely uses the coverage degree.</p><p id="Par29">Plant density is the most important factor that affects the accuracy rate of seedling counting. Our results show that the errors increase with the plant density because of the increased overlap between leaves. This result is consistent with a previous study [<xref ref-type="bibr" rid="CR19">19</xref>]. However, the angular points (<italic>Ha</italic>) proposed in this study attenuate the increase in errors caused by plant density. As presented in Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>, the effect of Ha on improving the accuracy increases with plant density. Although the accuracy of the proposed model decreased slightly with plant density, a low RMSE was maintained to ensure the reliability of the estimation results.<fig id="Fig9"><label>Fig.&#x000a0;9</label><caption><p>The effect of angular points on improving the accuracy of different plant density: <bold>a</bold> the effect of angular points on RMSE, <bold>b</bold> the effect of angular points on A-R<sup>2</sup></p></caption><graphic xlink:href="13007_2018_369_Fig9_HTML" id="MO18"/></fig>
</p><p id="Par30">Three wheat varieties were selected for this study and the leaf shapes of these differed from the 1st to the 3rd stages. The differences between varieties were in leaf size and degree of curl [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. High accuracy was obtained using the coverage degree and angular points to estimate the number of wheat seedlings of different varieties and leaf ages, respectively (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>). However, this led to an excessive number of models and a lack of applicability. Therefore, the variety coefficient Va was introduced into the model, increasing its adaptability for different varieties. As in Fig.&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref>, the RMSE and REP between the measured and estimated values of the 3 varieties increased when Va was not introduced, especially for HM7 and YF4. Thus, the variety should be considered to improve model accuracy. We determined the Va value of 3 wheat varieties. To apply the model to other varieties, the specific Va value should be determined and used.<fig id="Fig10"><label>Fig.&#x000a0;10</label><caption><p>Validation results of the model without variety parameter Va</p></caption><graphic xlink:href="13007_2018_369_Fig10_HTML" id="MO19"/></fig>
</p><p id="Par31">The leaf age at image acquisition is critical for obtaining an accurate estimation of seedling numbers [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. In previous research, each wheat seedling was reconstructed into a separate line segment by optimizing the 1st-stage seedling structure using the chain code, thus accurately estimating the number of wheat seedlings [<xref ref-type="bibr" rid="CR22">22</xref>]. In the application, however, it was discovered that the 1st stage persisted only a short time and was easy to miss. The accuracy rate was only 42.36% when the previous algorithm was used to count seedlings numbers at 2nd leaf stage, and 32.12% at 3rd leaf stage. The 1st&#x02013;3rd leaf stages, which usually last for a total of 25 d, are a useful period to study seedling emergence in the field. There is ample time for follow-up operations, such as seedling supplements, to be performed. The proposed angular points (Ha) greatly reduce the error. Figure&#x000a0;<xref rid="Fig11" ref-type="fig">11</xref> shows that the RMSE decreases and R<sup>2</sup> increases consistently when Ha is used to count seedlings. The effect of Ha on improving the accuracy increases with leaf age. Although the accuracy of the proposed model decreased slightly with leaf age, a low RMSE could be maintained to ensure the reliability of the estimation results. Thus, the model can be applied to the quantity estimation of wheat seedlings of different varieties from the 1st to the 3rd leaf stages.<fig id="Fig11"><label>Fig.&#x000a0;11</label><caption><p>The effect of angular points on improving the accuracy of different leaf ages: <bold>a</bold> the effect of angular points on RMSE, <bold>b</bold> the effect of angular points on A-R<sup>2</sup></p></caption><graphic xlink:href="13007_2018_369_Fig11_HTML" id="MO20"/></fig>
</p><p id="Par32">Seedling number (plant density) is a key factor influencing wheat production with effects on yield, water and fertilizer requirements as well as susceptibility to environmental change [<xref ref-type="bibr" rid="CR20">20</xref>]. Wheat researchers can obtain an accurate estimate of seedling number using the proposed method and they can then study the influence of external factors or varietal characteristics on seedling emergence (Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>). Wheat producers can investigate the status of seedling emergence using the proposed method and then make necessary adjustments in their crop management schemes (Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>). The application flow of the proposed method is shown in Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>. A 1-m<sup>2</sup> white square and an image capturing device (digital camera, smart phone, and surveillance camera are all practicable) can be used when original images are needed.<fig id="Fig12"><label>Fig.&#x000a0;12</label><caption><p>Application flow and the seedling counting method proposed in this study</p></caption><graphic xlink:href="13007_2018_369_Fig12_HTML" id="MO21"/></fig>
</p></sec><sec id="Sec15"><title>Conclusion</title><p id="Par33">A wheat seedling estimation model was constructed based on coverage degree and angular points. Its application scope was expanded, and the application period was prolonged using a variety coefficient and leaf age coefficient. The new model explained the unsatisfactory accuracy of a previous estimation model that only used degree of coverage. The new model was improved by the introduction of angular points. The new model could be used to estimate the quantity of wheat seedlings in the 1st to the 3rd stages, and it provides a basis for timely seedling supplements and subsequent crop management.</p></sec></body><back><ack><title>Authors&#x02019; contributions</title><p>TL and WG performed all experiments and analyzed the data. TY, XZ and RL performed some experiments and analyzed the data. WW and CL contributed the conceptual design and provided supervision. LT and CS wrote the main manuscript text and prepared all figures. All authors were involved in preparing and revising the manuscript. All authors read and approved the final manuscript.</p><sec id="FPar1"><title>Acknowledgements</title><p id="Par34">We thank LetPub (<ext-link ext-link-type="uri" xlink:href="http://www.letpub.com">www.letpub.com</ext-link>) for linguistic assistance during manuscript preparation.</p></sec><sec id="FPar2"><title>Competing interests</title><p id="Par35">The authors declare that they have no competing interests.</p></sec><sec id="FPar3"><title>Availability of data and materials</title><p id="Par36">All data analyzed during this study are presented in this published article.</p></sec><sec id="FPar4"><title>Consent for publication</title><p id="Par37">Yes. All authors have seen the manuscript and approved to submit to your journal. All authors agree to publish.</p></sec><sec id="FPar5"><title>Ethics approval and consent to participate</title><p id="Par38">Not applicable.</p></sec><sec id="FPar6"><title>Funding</title><p id="Par39">This research was mainly supported by the National Key Research and Development Program of China (2016YFD0300107), the National Natural Science Foundation of China (31701355, 31771711, 31671615), China Postdoctoral Science Foundation (2016M600448), the Yangzhou Science Foundation for Excellent Youths (YZ2017098) and the Priority Academic Program Development of Jiangsu Higher Education Institutions (PAPD).</p></sec><sec id="FPar7"><title>Publisher&#x02019;s Note</title><p id="Par40">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spink</surname><given-names>JH</given-names></name><name><surname>Semere</surname><given-names>T</given-names></name><name><surname>Sparkes</surname><given-names>DL</given-names></name><name><surname>Whaley</surname><given-names>JM</given-names></name><name><surname>Foulkes</surname><given-names>MJ</given-names></name><name><surname>Clare</surname><given-names>RW</given-names></name><name><surname>Scott</surname><given-names>RK</given-names></name></person-group><article-title>Effect of sowing date on the optimum plant density of winter wheat</article-title><source>Ann Appl Biol</source><year>2000</year><volume>137</volume><issue>2</issue><fpage>179</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1111/j.1744-7348.2000.tb00049.x</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>P</given-names></name><name><surname>Guo</surname><given-names>WS</given-names></name><name><surname>Yue-Ming</surname><given-names>XU</given-names></name><name><surname>Feng</surname><given-names>CN</given-names></name><name><surname>Zhu</surname><given-names>XK</given-names></name><name><surname>Peng</surname><given-names>YX</given-names></name></person-group><article-title>Effect of planting density on grain yield and quality of weak-gluten and medium-gluten wheat</article-title><source>J Triticeae Crops</source><year>2006</year><volume>26</volume><issue>5</issue><fpage>117</fpage><lpage>121</lpage></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soltani</surname><given-names>A</given-names></name><name><surname>Robertson</surname><given-names>MJ</given-names></name><name><surname>Torabi</surname><given-names>B</given-names></name><name><surname>Yousefidaz</surname><given-names>M</given-names></name><name><surname>Sarparast</surname><given-names>R</given-names></name></person-group><article-title>Modelling seedling emergence in chickpea as influenced by temperature and sowing depth</article-title><source>Agric For Meteorol</source><year>2006</year><volume>138</volume><issue>1&#x02013;4</issue><fpage>156</fpage><lpage>167</lpage><pub-id pub-id-type="doi">10.1016/j.agrformet.2006.04.004</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bendig</surname><given-names>J</given-names></name><name><surname>Yu</surname><given-names>K</given-names></name><name><surname>Aasen</surname><given-names>H</given-names></name><name><surname>Bolten</surname><given-names>A</given-names></name><name><surname>Bennertz</surname><given-names>S</given-names></name><name><surname>Broscheit</surname><given-names>J</given-names></name><name><surname>Gnyp</surname><given-names>ML</given-names></name><name><surname>Bareth</surname><given-names>G</given-names></name></person-group><article-title>Combining UAV-based plant height from crop surface models, visible, and near infrared vegetation indices for biomass monitoring in barley</article-title><source>Int J Appl Earth Obs</source><year>2015</year><volume>39</volume><fpage>79</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1016/j.jag.2015.02.012</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Shi</surname><given-names>P</given-names></name><name><surname>Zhang</surname><given-names>G</given-names></name><name><surname>Ran</surname><given-names>J</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>D</given-names></name></person-group><article-title>A critical nitrogen dilution curve for japonica rice based on canopy images</article-title><source>Field Crop Res.</source><year>2016</year><volume>198</volume><fpage>93</fpage><lpage>100</lpage><pub-id pub-id-type="doi">10.1016/j.fcr.2016.08.032</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>KJ</given-names></name><name><surname>Lee</surname><given-names>BW</given-names></name></person-group><article-title>Estimation of rice growth and nitrogen nutrition status using color digital camera image analysis</article-title><source>Eur J Agron</source><year>2013</year><volume>48</volume><issue>3</issue><fpage>57</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1016/j.eja.2013.02.011</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>Z</given-names></name><name><surname>Cao</surname><given-names>Z</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Bai</surname><given-names>X</given-names></name><name><surname>Qin</surname><given-names>Y</given-names></name><name><surname>Zhuo</surname><given-names>W</given-names></name><name><surname>Xiao</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Xue</surname><given-names>H</given-names></name></person-group><article-title>Automatic image-based detection technology for two critical growth stages of maize: emergence and three-leaf stage</article-title><source>Agric For Meteorol</source><year>2013</year><volume>174</volume><issue>12</issue><fpage>65</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1016/j.agrformet.2013.02.011</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Makdessi</surname><given-names>NA</given-names></name><name><surname>Jean</surname><given-names>P</given-names></name><name><surname>Ecarnot</surname><given-names>M</given-names></name><name><surname>Gorretta</surname><given-names>N</given-names></name><name><surname>Rabatel</surname><given-names>G</given-names></name><name><surname>Roumet</surname><given-names>P</given-names></name></person-group><article-title>How plant structure impacts the biochemical leaf traits assessment from in-field hyperspectral images: a simulation study based on light propagation modeling in 3D virtual wheat scenes</article-title><source>Field Crop Res</source><year>2017</year><volume>205</volume><fpage>95</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1016/j.fcr.2017.02.001</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Espinoza</surname><given-names>K</given-names></name><name><surname>Valera</surname><given-names>DL</given-names></name><name><surname>Torres</surname><given-names>JA</given-names></name><name><surname>L&#x000f3;pez</surname><given-names>A</given-names></name><name><surname>Molina-Aiz</surname><given-names>FD</given-names></name></person-group><article-title>Combination of image processing and artificial neural networks as a novel approach for the identification of <italic>Bemisia tabaci</italic> and <italic>Frankliniella occidentalis</italic> on sticky traps in greenhouse agriculture</article-title><source>Comput Electron Agric.</source><year>2016</year><volume>127</volume><fpage>495</fpage><lpage>505</lpage><pub-id pub-id-type="doi">10.1016/j.compag.2016.07.008</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bakhshipour</surname><given-names>A</given-names></name><name><surname>Jafari</surname><given-names>A</given-names></name><name><surname>Nassiri</surname><given-names>SM</given-names></name><name><surname>Zare</surname><given-names>D</given-names></name></person-group><article-title>Weed segmentation using texture features extracted from wavelet sub-images</article-title><source>Biosyst Eng</source><year>2017</year><volume>157</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1016/j.biosystemseng.2017.02.002</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foroughi</surname><given-names>H</given-names></name><name><surname>Ray</surname><given-names>N</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name></person-group><article-title>Robust people counting using sparse representation and random projection</article-title><source>Pattern Recognit</source><year>2015</year><volume>48</volume><issue>10</issue><fpage>3038</fpage><lpage>3052</lpage><pub-id pub-id-type="doi">10.1016/j.patcog.2015.02.009</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Komyshev</surname><given-names>E</given-names></name><name><surname>Genaev</surname><given-names>M</given-names></name><name><surname>Afonnikov</surname><given-names>D</given-names></name></person-group><article-title>Evaluation of the seed counter, a mobile application for grain phenotyping</article-title><source>Front Plant Sci</source><year>2016</year><volume>7</volume><fpage>5691825</fpage></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Payne</surname><given-names>AB</given-names></name><name><surname>Walsh</surname><given-names>KB</given-names></name><name><surname>Subedi</surname><given-names>PP</given-names></name><name><surname>Jarvis</surname><given-names>D</given-names></name></person-group><article-title>Estimation of mango crop yield using image analysis&#x02014;segmentation method</article-title><source>Comput Electron Agric</source><year>2013</year><volume>91</volume><issue>2</issue><fpage>57</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.1016/j.compag.2012.11.009</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Font</surname><given-names>D</given-names></name><name><surname>Pallej&#x000e0;</surname><given-names>T</given-names></name><name><surname>Tresanchez</surname><given-names>M</given-names></name><name><surname>Teixid&#x000f3;</surname><given-names>M</given-names></name><name><surname>Martinez</surname><given-names>D</given-names></name><name><surname>Moreno</surname><given-names>J</given-names></name><name><surname>Palac&#x000ed;n</surname><given-names>J</given-names></name></person-group><article-title>Counting red grapes in vineyards by detecting specular spherical reflection peaks in RGB images obtained at night with artificial illumination</article-title><source>Comput Electron Agric</source><year>2014</year><volume>108</volume><fpage>105</fpage><lpage>111</lpage><pub-id pub-id-type="doi">10.1016/j.compag.2014.07.006</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mussadiq</surname><given-names>Z</given-names></name><name><surname>Laszlo</surname><given-names>B</given-names></name><name><surname>Helyes</surname><given-names>L</given-names></name><name><surname>Gyuricza</surname><given-names>C</given-names></name></person-group><article-title>Evaluation and comparison of open source program solutions for automatic seed counting on digital images</article-title><source>Comput Electron Agric</source><year>2015</year><volume>117</volume><fpage>194</fpage><lpage>199</lpage><pub-id pub-id-type="doi">10.1016/j.compag.2015.08.010</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barbedo</surname><given-names>JGA</given-names></name></person-group><article-title>Using digital image processing for counting whiteflies on soybean leaves</article-title><source>J Asia-Pac Entomol</source><year>2014</year><volume>17</volume><issue>17</issue><fpage>685</fpage><lpage>694</lpage><pub-id pub-id-type="doi">10.1016/j.aspen.2014.06.014</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duan</surname><given-names>T</given-names></name><name><surname>Chapman</surname><given-names>SC</given-names></name><name><surname>Holland</surname><given-names>E</given-names></name><name><surname>Rebetzke</surname><given-names>GJ</given-names></name><name><surname>Guo</surname><given-names>Y</given-names></name><name><surname>Zheng</surname><given-names>B</given-names></name></person-group><article-title>Dynamic quantification of canopy structure to characterize early plant vigour in wheat genotypes</article-title><source>J Exp Bot</source><year>2016</year><volume>67</volume><issue>15</issue><fpage>4523</fpage><lpage>4534</lpage><pub-id pub-id-type="doi">10.1093/jxb/erw227</pub-id><pub-id pub-id-type="pmid">27312669</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kipp</surname><given-names>S</given-names></name><name><surname>Mistele</surname><given-names>B</given-names></name><name><surname>Baresel</surname><given-names>P</given-names></name><name><surname>Schmidhalter</surname><given-names>U</given-names></name></person-group><article-title>High-throughput phenotyping early plant vigour of winter wheat</article-title><source>Eur J Agron</source><year>2014</year><volume>52</volume><fpage>271</fpage><lpage>278</lpage><pub-id pub-id-type="doi">10.1016/j.eja.2013.08.009</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Baret</surname><given-names>F</given-names></name><name><surname>Andrieu</surname><given-names>B</given-names></name><name><surname>Burger</surname><given-names>P</given-names></name><name><surname>Hemmerl&#x000e9;</surname><given-names>M</given-names></name></person-group><article-title>Estimation of wheat plant density at early stages using high resolution imagery</article-title><source>Front Plant Sci</source><year>2017</year><volume>8</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="pmid">28220127</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Baret</surname><given-names>F</given-names></name><name><surname>Hemerl&#x000e9;</surname><given-names>M</given-names></name><name><surname>Comar</surname><given-names>A</given-names></name></person-group><article-title>Estimates of plant density of wheat crops at emergence from very low altitude UAV imagery</article-title><source>Remote Sens Environ</source><year>2017</year><volume>198</volume><fpage>105</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1016/j.rse.2017.06.007</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>K</given-names></name><name><surname>Gao</surname><given-names>XW</given-names></name><name><surname>Yang</surname><given-names>WB</given-names></name><name><surname>Dai</surname><given-names>YL</given-names></name><name><surname>Tian</surname><given-names>ZD</given-names></name></person-group><article-title>Multiple fault diagnosis of down-hole conditions of sucker-rod pumping wells based on Freeman chain code and DCA</article-title><source>Pet Sci</source><year>2013</year><volume>10</volume><issue>3</issue><fpage>347</fpage><lpage>360</lpage><pub-id pub-id-type="doi">10.1007/s12182-013-0283-4</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Wu</surname><given-names>W</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Sun</surname><given-names>C</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name><name><surname>Guo</surname><given-names>W</given-names></name></person-group><article-title>Automated image-processing for counting seedlings in a wheat field</article-title><source>Precis Agric</source><year>2016</year><volume>17</volume><issue>4</issue><fpage>392</fpage><lpage>406</lpage><pub-id pub-id-type="doi">10.1007/s11119-015-9425-6</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>WY</given-names></name><name><surname>Tang</surname><given-names>L</given-names></name><name><surname>Yao</surname><given-names>XF</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Cao</surname><given-names>WX</given-names></name><name><surname>Zhu</surname><given-names>Y</given-names></name></person-group><article-title>Process-based simulation model for growth dynamics of plant type index in wheat</article-title><source>Sci Agric Sin</source><year>2012</year><volume>12</volume><issue>45</issue><fpage>2364</fpage><lpage>2374</lpage></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otsu</surname><given-names>N</given-names></name></person-group><article-title>A threshold selection method from gray-level histograms</article-title><source>IEEE Trans Syst Man Cybern B</source><year>2007</year><volume>9</volume><issue>1</issue><fpage>62</fpage><lpage>66</lpage><pub-id pub-id-type="doi">10.1109/TSMC.1979.4310076</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">Harris C. A combined corner and edge detector. In Proceedings Alvey Vision Conference, no. 3; 1988. p. 147&#x02013;151</mixed-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>D</given-names></name><name><surname>Walker</surname><given-names>CN</given-names></name><name><surname>Angus</surname><given-names>JF</given-names></name></person-group><article-title>Estimating the nitrogen status of crops using a digital camera</article-title><source>Field Crop Res</source><year>2010</year><volume>118</volume><issue>3</issue><fpage>221</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1016/j.fcr.2010.05.011</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qualset</surname><given-names>CO</given-names></name><name><surname>Fick</surname><given-names>GN</given-names></name><name><surname>Constantin</surname><given-names>MJ</given-names></name><name><surname>Osborne</surname><given-names>TS</given-names></name></person-group><article-title>Mutation in internode length affects wheat plant-type</article-title><source>Science</source><year>1970</year><volume>169</volume><issue>3950</issue><fpage>1090</fpage><lpage>1091</lpage><pub-id pub-id-type="doi">10.1126/science.169.3950.1090</pub-id><pub-id pub-id-type="pmid">17832272</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>S</given-names></name><name><surname>He</surname><given-names>D</given-names></name><name><surname>Nan</surname><given-names>G</given-names></name><name><surname>Guo</surname><given-names>Y</given-names></name></person-group><article-title>3D reconstruction of wheat lamina shape based on image processing</article-title><source>TCSAE</source><year>2007</year><volume>23</volume><issue>1</issue><fpage>150</fpage><lpage>154</lpage></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>L</given-names></name><name><surname>Tian</surname><given-names>LF</given-names></name></person-group><article-title>Real-time crop row image reconstruction for automatic emerged corn plant spacing measurement</article-title><source>Trans ASABE</source><year>2008</year><volume>51</volume><issue>3</issue><fpage>1079</fpage><lpage>1087</lpage><pub-id pub-id-type="doi">10.13031/2013.24510</pub-id></element-citation></ref></ref-list></back></article>