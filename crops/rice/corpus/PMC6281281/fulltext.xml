<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6281281</article-id><article-id pub-id-type="publisher-id">PONE-D-18-18975</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0207624</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Artificial Intelligence</subject><subj-group><subject>Artificial Neural Networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Computational Biology</subject><subj-group><subject>Computational Neuroscience</subject><subj-group><subject>Artificial Neural Networks</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational Neuroscience</subject><subj-group><subject>Artificial Neural Networks</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Plants</subject><subj-group><subject>Grasses</subject><subj-group><subject>Rice</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Animal Studies</subject><subj-group><subject>Experimental Organism Systems</subject><subj-group><subject>Plant and Algal Models</subject><subj-group><subject>Rice</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Artificial Intelligence</subject><subj-group><subject>Machine Learning</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Artificial Intelligence</subject><subj-group><subject>Machine Learning</subject><subj-group><subject>Support Vector Machines</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Mathematical and Statistical Techniques</subject><subj-group><subject>Statistical Methods</subject><subj-group><subject>Regression Analysis</subject><subj-group><subject>Linear Regression Analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical Methods</subject><subj-group><subject>Regression Analysis</subject><subj-group><subject>Linear Regression Analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied Mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Simulation and Modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Management Engineering</subject><subj-group><subject>Decision Analysis</subject><subj-group><subject>Decision Trees</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Decision Analysis</subject><subj-group><subject>Decision Trees</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth Sciences</subject><subj-group><subject>Seasons</subject></subj-group></subj-group></article-categories><title-group><article-title>Estimation of paddy rice leaf area index using machine learning methods based on hyperspectral data from multi-year experiments</article-title><alt-title alt-title-type="running-head">Rice LAI ML remote sensing estimation</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Li</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Data curation</role><role content-type="http://credit.casrai.org/">Writing &#x02013; original draft</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib><contrib contrib-type="author"><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7154-6068</contrib-id><name><surname>Chang</surname><given-names>Qingrui</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="corresp" rid="cor001">*</xref></contrib><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Jing</given-names></name><role content-type="http://credit.casrai.org/">Data curation</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Xiaohua</given-names></name><role content-type="http://credit.casrai.org/">Data curation</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="aff" rid="aff002"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Li</surname><given-names>Fenling</given-names></name><role content-type="http://credit.casrai.org/">Funding acquisition</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib></contrib-group><aff id="aff001">
<label>1</label>
<addr-line>College of Natural Resources and Environment, Northwest A&#x00026;F University, Yangling, Shaanxi, China</addr-line>
</aff><aff id="aff002">
<label>2</label>
<addr-line>Surveying and Mapping Institute of China Nuclear Industry CO., LTD., Xi&#x02019;an, Shaanxi, China</addr-line>
</aff><contrib-group><contrib contrib-type="editor"><name><surname>Xu</surname><given-names>Yangyang</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">
<addr-line>Texas A&#x00026;M University, UNITED STATES</addr-line>
</aff><author-notes><fn fn-type="COI-statement" id="coi001"><p><bold>Competing Interests: </bold>The authors declare no conflicts of interest. The authors also declare that the author Xiaohua Zhang is employed by a commercial company, &#x0201c;Surveying and Mapping Institute of China Nuclear Industry CO., LTD., Xi&#x02019;an, Shaanxi, China.&#x0201d; This does not alter our adherence to PLOS ONE policies on sharing data and materials.</p></fn><corresp id="cor001">* E-mail: <email>changqr@nwsuaf.edu.cn</email></corresp></author-notes><pub-date pub-type="collection"><year>2018</year></pub-date><pub-date pub-type="epub"><day>5</day><month>12</month><year>2018</year></pub-date><volume>13</volume><issue>12</issue><elocation-id>e0207624</elocation-id><history><date date-type="received"><day>26</day><month>6</month><year>2018</year></date><date date-type="accepted"><day>2</day><month>11</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; 2018 Wang et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Wang et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0207624.pdf"/><abstract><p>The performance of three machine learning methods (support vector regression, random forests and artificial neural network) for estimating the LAI of paddy rice was evaluated in this study. Traditional univariate regression models involving narrowband NDVI with optimized band combinations as well as linear multivariate calibration partial least squares regression models were also evaluated for comparison. A four year field-collected dataset was used to test the robustness of LAI estimation models against temporal variation. The partial least squares regression and three machine learning methods were built on the raw hyperspectral reflectance and the first derivative separately. Two different rules were used to determine the models&#x02019; key parameters. The results showed that the combination of the red edge and NIR bands (766 nm and 830 nm) as well as the combination of SWIR bands (1114 nm and 1190 nm) were optimal for producing the narrowband NDVI. The models built on the first derivative spectra yielded more accurate results than the corresponding models built on the raw spectra. Properly selected model parameters resulted in comparable accuracy and robustness with the empirical optimal parameter and significantly reduced the model complexity. The machine learning methods were more accurate and robust than the VI methods and partial least squares regression. When validating the calibrated models against the standalone validation dataset, the VI method yielded a validation <italic>RMSE</italic> value of 1.17 for <italic>NDVI</italic><sub>(766,830)</sub> and 1.01 for <italic>NDVI</italic><sub>(1114,1190)</sub>, while the best models for the partial least squares, support vector machine and artificial neural network methods yielded validation <italic>RMSE</italic> values of 0.84, 0.82, 0.67 and 0.84, respectively. The RF models built on the first derivative spectra with <italic>mtry</italic> = 10 showed the highest potential for estimating the LAI of paddy rice.</p></abstract><funding-group><award-group id="award001"><funding-source><institution-wrap><institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source><award-id>41701398</award-id><principal-award-recipient><name><surname>Li</surname><given-names>Fenling</given-names></name></principal-award-recipient></award-group><award-group id="award002"><funding-source><institution>Fundamental Research Funds for the Central Universities</institution></funding-source><award-id>2452017108</award-id><principal-award-recipient><name><surname>Li</surname><given-names>Fenling</given-names></name></principal-award-recipient></award-group><award-group id="award003"><funding-source><institution>Hi-Tech Research and Development Program of China</institution></funding-source><award-id>2013AA102401-2</award-id><principal-award-recipient><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7154-6068</contrib-id><name><surname>Chang</surname><given-names>Qingrui</given-names></name></principal-award-recipient></award-group><funding-statement>This work is supported by the Natural Science Foundation of China (41701398 to F.L.), the Hi-Tech Research and Development Program (863) of China (2013AA102401-2 to Q.C.) and the Fundamental Research Funds for the Central Universities (2452017108 to F.L.). We acknowledge the support given by the Institute of Agricultural Resources and Environment, Ningxia Academy of Agro-forestry science, Yinchuan. The funder provided support in the form of salaries for authors, but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are articulated in the &#x02018;author contributions&#x02019; section.</funding-statement></funding-group><counts><fig-count count="5"/><table-count count="6"/><page-count count="16"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>All relevant data are within the manuscript and its Supporting Information files.</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>All relevant data are within the manuscript and its Supporting Information files.</p></notes></front><body><sec sec-type="intro" id="sec001"><title>Introduction</title><p>Leaf area index (LAI), which is defined as half of the all-sided green leaf area per unit ground area [<xref rid="pone.0207624.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0207624.ref002" ref-type="bibr">2</xref>], is a key biophysical parameter that is commonly used as a surrogate for vegetation foliar cover, biomass, productivity and plant variability in precision agriculture (PA) and is widely used in plant growth and climate models [<xref rid="pone.0207624.ref003" ref-type="bibr">3</xref>&#x02013;<xref rid="pone.0207624.ref005" ref-type="bibr">5</xref>]. Remote sensing is a reliable, fast and non-destructive way to measure regional and global LAI [<xref rid="pone.0207624.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0207624.ref007" ref-type="bibr">7</xref>]. Hyperspectral remote sensing, which provides a continuous reflectance spectrum with narrow contiguous wavebands, can characterize vegetation with a far greater amount of information than traditional multispectral techniques [<xref rid="pone.0207624.ref008" ref-type="bibr">8</xref>&#x02013;<xref rid="pone.0207624.ref011" ref-type="bibr">11</xref>].</p><p>There are two main approaches to building relationships between remote sensing data and LAI&#x02014;the empirical statistical approach and the radiative transform models (RTM) approach [<xref rid="pone.0207624.ref002" ref-type="bibr">2</xref>, <xref rid="pone.0207624.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0207624.ref013" ref-type="bibr">13</xref>]. The former approach includes univariate regression models built on a vegetation index (VI) as well as multivariate regression models using the full spectrum, various transformations and selected features of the raw spectrum. Multivariate calibration techniques include traditional multilinear regression (MLR) methods, partial least squares regression (PLS) methods and modern machine learning (ML) methods such as support vector regression (SVR), random forests (RF) and artificial neural networks (ANN). The latter approach usually combines RTM with different inversion techniques. The RTM approach suffers from ill-posed problems and is highly reliant on the realism of the RTM simulation and appropriate RTM parameter initialization [<xref rid="pone.0207624.ref009" ref-type="bibr">9</xref>, <xref rid="pone.0207624.ref013" ref-type="bibr">13</xref>].</p><p>The traditional multispectral vegetation index, which usually calculated using the red and near infrared (NIR) bands, is criticized as asymptotically approaching saturation levels in scenes with dense canopy. However, the narrowband normalized difference vegetation index (NDVI) with specific band combinations optimized for specific cases could improve the LAI estimation accuracy and avoid the saturation problem [<xref rid="pone.0207624.ref014" ref-type="bibr">14</xref>&#x02013;<xref rid="pone.0207624.ref016" ref-type="bibr">16</xref>]. Zhao <italic>et al</italic>. [<xref rid="pone.0207624.ref014" ref-type="bibr">14</xref>] found that NDVI calculated using the 690 nm&#x02013;710 nm and 750&#x02013;900 nm bands yielded high <italic>R</italic><sup>2</sup> values when regressed against LAI. Hansen <italic>et al</italic>. [<xref rid="pone.0207624.ref015" ref-type="bibr">15</xref>] concluded that red edge (RE) bands are important in formulating narrowband NDVIs for quantity per unit surface area-based variables such as LAI for exploring field-collected winter wheat data over different growth stages and cultivars. Delegido <italic>et al</italic>. [<xref rid="pone.0207624.ref016" ref-type="bibr">16</xref>] reported that <italic>NDVI</italic><sub>(674<italic>nm</italic>, 712<italic>nm</italic>)</sub> exhibited the highest linear relationship with LAI by studying a field-collected dataset on nine crop types.</p><p>Univariate regression models based on VIs, which usually use two to three bands, are considered too simple to capture the intrinsic relationships between the observed remote sensing data (especially hyperspectral data) and biochemical or biophysical parameters of interest, and lack the ability to parameterize spatial-temporal variability [<xref rid="pone.0207624.ref017" ref-type="bibr">17</xref>]. PLS has been considered a powerful alternative to univariate methods and provides better performance in most cases [<xref rid="pone.0207624.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0207624.ref019" ref-type="bibr">19</xref>], although some studies have reported the opposite results [<xref rid="pone.0207624.ref015" ref-type="bibr">15</xref>]. Hansen and Schjoerring [<xref rid="pone.0207624.ref015" ref-type="bibr">15</xref>] concluded that the relationship between optimized narrowband NDVI and winter wheat LAI and could not be further improved significantly by PLS using information on all hyperspectral bands. Several studies [<xref rid="pone.0207624.ref020" ref-type="bibr">20</xref>&#x02013;<xref rid="pone.0207624.ref024" ref-type="bibr">24</xref>] have explored the potential performance of state-of-art ML methods such as SVR, RF and ANN for LAI estimation. Wang <italic>et al</italic>. [<xref rid="pone.0207624.ref020" ref-type="bibr">20</xref>] showed that SVR performed better than PLS and MLR for paddy rice LAI estimation with 15 selected bands from field-collected 350 nm&#x02013;2500 nm hyperspectral data. In Yuan <italic>et al</italic>. [<xref rid="pone.0207624.ref023" ref-type="bibr">23</xref>], an RF model built on whole growth stages outperformed PLS, SVR and ANN methods for retrieving soybean LAI, while the ANN method performed best in the single-growth stage models. Kira <italic>et al</italic>. [<xref rid="pone.0207624.ref022" ref-type="bibr">22</xref>] built ANN and PLS models on selected bands from field-collected hyperspectral data on two different crop types (maize and soybean) and found that the ANN method outperformed the PLS method regardless of whether using the model with the two crops was combined without re-parameterization or the models for each crop. Kiala <italic>et al</italic>. [<xref rid="pone.0207624.ref021" ref-type="bibr">21</xref>] reported that PLS provided higher accuracy for heterogeneous grassland LAI prediction than SVR at lower vegetation density, while SVR slightly outperformed PLS at higher vegetation density.</p><p>In general, ML techniques appear to be more efficient than VI and PLS methods in most LAI estimation cases. However, previous studies have reported contrasting results on the accuracy of different ML techniques. Most of these studies were based on limited datasets with a single growth stage or within one seasonal lifecycle, and thus, the robustness of the ML techniques under temporal variation still require further exploration. The object of this study was to comparatively assess the performance of three machine learning techniques&#x02014;SVR, RF and ANN&#x02014;in estimating paddy rice LAI in comparison to the VI and PLS methods. A multi-stage and multi-year dataset was used to assess the robustness of these methods under temporal variation.</p></sec><sec sec-type="materials|methods" id="sec002"><title>Materials and methods</title><sec id="sec003"><title>Study area and experimental setup</title><p>The study was conducted during the 2014&#x02013;2017 growth seasons on a farmland located in the Ningxia Yellow River irrigation region, China (38&#x000b0;7&#x02032;25&#x02033; N, 106&#x000b0;11&#x02032;35&#x02033; E). The farmland owned by Ningxia Zhengxinyuan modern agricultural development group CO. LTD. The company have given the permission for data collection. We confirm that the field studies did not involve endangered or protected species. This region is characterized by a temperate continental semi-arid climate. The average annual precipitation and average annual accumulative temperature are 192.9 and 3866.3&#x000b0;C, respectively. The paddy rice variety Ningjing NO. 37 was used as test material. The paddy rice was sown in a nursery bed in late April and transplanted in late May during different growth seasons.</p><p>A plot experiment was established with twelve fertilization treatments to get reflectance and LAI reference values with a large variation. The fertilization treatments were combinations of three nitrogen fertilization rates (0 kg ha<sup>&#x02212;1</sup>, 240 kg ha<sup>&#x02212;1</sup>, and 300 kg ha<sup>&#x02212;1</sup>) and four biochar rates (0 kg ha<sup>&#x02212;1</sup>, 4500 kg ha<sup>&#x02212;1</sup>, 9000 kg ha<sup>&#x02212;1</sup>, and 13 500 kg ha<sup>&#x02212;1</sup>). Each treatment was performed in triplicate over 36 plots in total. The phosphates and potash fertilizer were applied at the same rates at recommend levels for the region (<italic>P</italic><sub>2</sub><italic>O</italic><sub>5</sub> 90 kg ha<sup>&#x02212;1</sup>, <italic>K</italic><sub>2</sub><italic>O</italic> 90 kg ha<sup>&#x02212;1</sup>). The area of each plot was 70 m<sup>2</sup> (14 m by 5 m).</p></sec><sec id="sec004"><title>Field data collection</title><p>Canopy reflectance was measured with an SVC HR1024i spectroradiometer with a 8&#x000b0; field of view lens. The spectroradiometer has 1024 channels ranging from 350 nm to 2500 nm. In each plot, canopy reflectance was measured at three fixed sample points and five times at each sample point. The fifteen measurements were averaged to represent the canopy reflectance of the plot. During the measurement, the spectroradiometer was fixed at 1 m above the canopy. All measurements were collected under cloudless weather conditions between 11 am to 2 pm at local time near solar noon. A 2nd order Savitzky-Golay filter [<xref rid="pone.0207624.ref025" ref-type="bibr">25</xref>] was used to filter the sensor noise, and then, the reflectance data were resampled to a spectral resolution of 4 nm. The bands beyond 2400 nm were omitted because of the low signal-to-noise ratio, leaving 513 bands for further analysis.</p><p>LAI was measured on the same day with a SunScan Canopy Analysis System. In each plot, two sample areas were selected randomly. For each sample area, measurements were taken every 45&#x000b0;, starting from the across-ridge direction. The eight measurements were averaged to represent the LAI of the plot.</p><p>Data collection campaigns were conducted within each vegetative, reproductive pre-heading and reproductive post-heading growth stage during the 2014&#x02013;2017 rice growth seasons (<xref rid="pone.0207624.t001" ref-type="table">Table 1</xref>).</p><table-wrap id="pone.0207624.t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.t001</object-id><label>Table 1</label><caption><title>Day after transplantation (DAT) on which the data collection campaigns were conducted.</title></caption><alternatives><graphic id="pone.0207624.t001g" xlink:href="pone.0207624.t001"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1"/><th align="right" rowspan="1" colspan="1">2014</th><th align="right" rowspan="1" colspan="1">2015</th><th align="right" rowspan="1" colspan="1">2016</th><th align="right" rowspan="1" colspan="1">2017</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">vegetative</td><td align="right" rowspan="1" colspan="1">44</td><td align="right" rowspan="1" colspan="1">41</td><td align="right" rowspan="1" colspan="1">48</td><td align="right" rowspan="1" colspan="1">46</td></tr><tr><td align="left" rowspan="1" colspan="1">reproductive pre-heading</td><td align="right" rowspan="1" colspan="1">75</td><td align="right" rowspan="1" colspan="1">70</td><td align="right" rowspan="1" colspan="1">81</td><td align="right" rowspan="1" colspan="1">78</td></tr><tr><td align="left" rowspan="1" colspan="1">reproductive post-heading</td><td align="right" rowspan="1" colspan="1">94</td><td align="right" rowspan="1" colspan="1">90</td><td align="right" rowspan="1" colspan="1">103</td><td align="right" rowspan="1" colspan="1">110</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="sec005"><title>Methods</title><p>Theoretically there should be 36 &#x000d7; 3 &#x000d7; 4 = 432 samples. However, reflectance of nine plots were missing because spectroradiometer failure at 2016 vegetative stage data collection campaign, and another four samples were deleted because of invalid spectra data. Thus 419 valid data samples were further analyzed. To evaluate the models&#x02019; robustness to temporal variation, all models were calibrated on the data for the 2014&#x02013;2016 growth seasons (313 Samples) and were validated on the data for the 2017 growth season (106 Samples). Four statistical techniques were evaluated in this study, namely, PLS, SVR, RF and ANN. The raw reflectance (raw) and its first derivative (D1) were separately used as inputs of different calibration techniques (The Raw and D1 spectrum are presented in <xref ref-type="fig" rid="pone.0207624.g001">Fig 1</xref>). Both raw and D1 spectra were normalized by subtracting the mean and dividing by the standard deviation before model calibration. No feature selection procedure was made to reduce spectral dimensions. In addition, the linear regression model using NDVI was used as the baseline method.</p><fig id="pone.0207624.g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.g001</object-id><label>Fig 1</label><caption><title>The measured original spectrum (Raw) and and first derivative spectrum (D1).</title></caption><graphic xlink:href="pone.0207624.g001"/></fig><p>All models were built in the R environment [<xref rid="pone.0207624.ref026" ref-type="bibr">26</xref>]. The PLS, RF and SVR models were built using the R packages &#x02018;pls&#x02019; [<xref rid="pone.0207624.ref027" ref-type="bibr">27</xref>], &#x02018;randomForest&#x02019; [<xref rid="pone.0207624.ref028" ref-type="bibr">28</xref>], and &#x02018;kernlab&#x02019; [<xref rid="pone.0207624.ref029" ref-type="bibr">29</xref>], respectively, and the ANN model was built with the R package &#x02018;keras&#x02019; [<xref rid="pone.0207624.ref030" ref-type="bibr">30</xref>] with a Tensorflow backend [<xref rid="pone.0207624.ref031" ref-type="bibr">31</xref>].</p><sec id="sec006"><title>Normalized difference vegetation index</title><p>Two different NDVIs were evaluated: (1) the classical NDVI with red (670 nm) and NIR (830 nm) band combination; (2) NDVI with optimized band combination. All possible two-pair &#x003bb;1 &#x0003c; &#x003bb;2 band combinations among the 513 bands were used in the NDVI equation (<xref ref-type="disp-formula" rid="pone.0207624.e001">Eq 1</xref>). Then, linear regression models were built on the calculated index and calibrated against the LAI dataset. A contour plot of the models&#x02019; <italic>R</italic><sup>2</sup> values was used to find the optimized band combinations.
<disp-formula id="pone.0207624.e001"><alternatives><graphic xlink:href="pone.0207624.e001.jpg" id="pone.0207624.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>N</mml:mi><mml:mi>D</mml:mi><mml:mi>V</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>&#x003bb;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x003bb;</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>&#x003bb;</mml:mo><mml:mn>2</mml:mn><mml:mo>-</mml:mo><mml:mo>&#x003bb;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x003bb;</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mo>&#x003bb;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p></sec><sec id="sec007"><title>Partial least squares regression</title><p>PLS is a bilinear regression method [<xref rid="pone.0207624.ref032" ref-type="bibr">32</xref>]. PLS performs component projection by successively reducing the original input data to a few independent latent variables (<italic>LVs</italic>) while maximizing co-variability to the response variable of interest and then regressing the latent variables against the response variable. The component projection operation reduces the dimension and eliminates the multi-collinearity of the input data. The component projection operation also reduces noise. The number of <italic>LVs</italic> controls the model complexity and determined by a grid search in this study.</p></sec><sec id="sec008"><title>Support vector regression</title><p>SVR, which has roots in Vapnik-Chervonenkis (VC) theory as a generalization of support machines (SVMs), is characterized by the use of kernel functions, sparse solutions, and VC control of the margin and the number of support vectors [<xref rid="pone.0207624.ref029" ref-type="bibr">29</xref>, <xref rid="pone.0207624.ref033" ref-type="bibr">33</xref>]. Using an <italic>&#x003b5;</italic> tube, which is an <italic>&#x003b5;</italic>-insensitive region around the object function, the SVR reforms the optimization problem to minimize a convex <italic>&#x003b5;</italic>-insensitive loss function and finds the flattest tube that contains as many training samples as possible. The object function is represented by training samples that lie outside the tube&#x02019;s boundary, and these training samples are called support vectors. The complexity of an SVR model is based on the number of support vectors other than the dimension of the input data, and thus, this approach is efficient in high-dimensional space and is still efficient when the number of observations is less than the input dimensions. In this study, the <italic>&#x003b5;</italic>-SVR algorithm with a radial basis kernel function (RBF) was used. The kernel parameter <italic>&#x003c3;</italic> of the RBF kernel and regularization parameter <italic>C</italic> were determined by a grid search. <italic>&#x003c3;</italic> defines how far a training sample can influence, while a large <italic>&#x003c3;</italic> means &#x02018;close&#x02019; and a small <italic>&#x003c3;</italic> means &#x02018;far&#x02019;. <italic>C</italic> defines the tradeoff between the smoothness of the object function and the maximum deviation allowed. A large <italic>C</italic> results in selecting more samples as support vectors, and a small <italic>C</italic> denotes a smooth object function.</p></sec><sec id="sec009"><title>Random forests</title><p>The RF algorithm is based on the decision tree algorithm and bagging method with an additional layer of randomness in the bagging process [<xref rid="pone.0207624.ref028" ref-type="bibr">28</xref>, <xref rid="pone.0207624.ref034" ref-type="bibr">34</xref>]. The RF algorithm is as follows:</p><list list-type="order"><list-item><p>Draw bootstrap samples <italic>ntree</italic> times from the original dataset, then, each bootstrap sample is used to build a tree;</p></list-item><list-item><p>Grow an unpruned tree for each bootstrap sample. For each tree, only randomly selected <italic>mtry</italic> predictors are used;</p></list-item><list-item><p>Perform prediction by aggregating the <italic>ntree</italic> trees prediction results. The aggregation strategy is usually the majority of votes for classification and the average for regression.</p></list-item></list><p>The <italic>ntree</italic> and <italic>mtry</italic> are the two key parameters controlling the performance and complexity of RF models. In this study, <italic>ntree</italic> was set at 500 as suggested by Breiman [<xref rid="pone.0207624.ref034" ref-type="bibr">34</xref>], and this value is efficient for most cases. The <italic>mtry</italic> was determined by a grid search.</p></sec><sec id="sec010"><title>Artificial neural network</title><p>ANNs are fully connected neural nets organized into layers [<xref rid="pone.0207624.ref031" ref-type="bibr">31</xref>, <xref rid="pone.0207624.ref035" ref-type="bibr">35</xref>]. ANNs usually consist of one input layer, zero to multiple hidden layers and one output layer. Every neuron in a layer is connected to every other neuron in the next layer. The output of the <italic>j</italic>th neuron in layer <italic>l</italic> + 1 can be calculated by <xref ref-type="disp-formula" rid="pone.0207624.e005">Eq 2</xref>, where <inline-formula id="pone.0207624.e002"><alternatives><graphic xlink:href="pone.0207624.e002.jpg" id="pone.0207624.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> denotes <italic>i</italic>th neuron in layer <italic>l</italic>, <inline-formula id="pone.0207624.e003"><alternatives><graphic xlink:href="pone.0207624.e003.jpg" id="pone.0207624.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> denotes the weight between the <italic>i</italic>th neuron in layer <italic>l</italic> and <italic>j</italic>th neuron in layer <italic>l</italic> + 1, <inline-formula id="pone.0207624.e004"><alternatives><graphic xlink:href="pone.0207624.e004.jpg" id="pone.0207624.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> denotes the bias for the <italic>j</italic>th neuron in layer <italic>l</italic> + 1 and <italic>f</italic> denotes the (nonlinear) active function.
<disp-formula id="pone.0207624.e005"><alternatives><graphic xlink:href="pone.0207624.e005.jpg" id="pone.0207624.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula></p><p>In this work, a single-hidden-layer neural network were constructed. The number of neurons in input layer were set to 513 according input feature dimension (513 bands). The number of neurons in hidden layer was determined by a grid search. A parametric rectified linear unit (<xref ref-type="disp-formula" rid="pone.0207624.e006">Eq 3</xref>) was used as active function for the hidden layer, where <italic>&#x003b1;</italic> was learned in the model calibration procedure. A linear function <italic>y</italic> = <italic>x</italic> was used as the active function for the output layer. The weights and bias were initialized by the Glorot normal initializer and regularized by an L1 regularizer. Finally, the ANN model was optimized by the Adam algorithm with a mean square error loss function.
<disp-formula id="pone.0207624.e006"><alternatives><graphic xlink:href="pone.0207624.e006.jpg" id="pone.0207624.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mi>x</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p></sec><sec id="sec011"><title>Parameter optimization and precision evaluation</title><p>The key parameters (<italic>LVs</italic> for PLS, <italic>C</italic>, <italic>&#x003c3;</italic> for SVR, <italic>mtry</italic> for RF and <italic>units</italic> for ANN) were determined by a grid search with a repeated (5 times) 10-fold cross validation procedure on the calibration dataset (detailed in Algorithm 1) and on the same fold split scheme across different models to ensure fair comparison.</p><p><bold>Algorithm 1</bold>: Model parameter optimation algorithm</p><p specific-use="line"><bold>Data</bold>: Calibration dataset</p><p specific-use="line"><bold>1</bold> define sets of model parameters to evaluate;</p><p specific-use="line"><bold>2</bold>
<bold>foreach</bold>
<italic>set of parameters</italic>
<bold>do</bold></p><p specific-use="line"><bold>3</bold> &#x02003;<bold>foreach</bold>
<italic>sampling iteration</italic>
<bold>do</bold></p><p specific-use="line"><bold>4</bold> &#x02003;&#x02003;<bold>foreach</bold>
<italic>fold</italic>
<bold>do</bold></p><p specific-use="line"><bold>5</bold> &#x02003;&#x02003;&#x02003;Hold-out the samples in this fold;</p><p specific-use="line"><bold>6</bold> &#x02003;&#x02003;&#x02003;Calibrate the model on samples in remainder folds;</p><p specific-use="line"><bold>7</bold> &#x02003;&#x02003;&#x02003;Predict the hold-out samples and calculate <italic>RMSE</italic> between observed and predicted values.;</p><p specific-use="line"><bold>8</bold> &#x02003;&#x02003;<bold>end</bold></p><p specific-use="line"><bold>9</bold> &#x02003;<bold>end</bold></p><p specific-use="line"><bold>10</bold> &#x02003;Calculate <italic>RMSE</italic><sub><italic>cv</italic></sub> with <italic>RMSE</italic><sub><italic>cv</italic></sub> = <italic>mean</italic>(<italic>RMSE</italic>);</p><p specific-use="line"><bold>11</bold>
<bold>end</bold></p><p specific-use="line"><bold>12</bold> Determine the optimal parameter set;</p><p specific-use="line"><bold>13</bold> Fit the final model with full training data using optimal parameter set;</p><p>The optimal parameter values were determined in two ways.</p><list list-type="bullet"><list-item><p>RULE1: The parameter (or parameter combination) associated with the lowest cross validated <italic>RMSE</italic><sub><italic>cv</italic></sub> was considered optimal.</p></list-item><list-item><p>RULE2: To limit the model complexity and avoid overfitting, raising the model complexity must reduce the <italic>RMSE</italic><sub><italic>cv</italic></sub> greater than 2%.</p></list-item></list><p>For PLS, RF, and ANN, the ordering of the model complexity is clear as a higher parameter value (<italic>LVs</italic> for PLS, <italic>mtry</italic> for RF and <italic>units</italic> for ANN) means higher complexity. In this situation, raising the model complexity means raising the corresponding parameter value. For SVR models, the order of the model complexity is not clear, and thus, RULE2 is not utilized for the SVR method.</p><p>After the key parameters were determined in these two different ways (RULE1 and RULE2), the final models were calibrated on the full calibration dataset and evaluated on the standalone validation data set. The root mean square error (<italic>RMSE</italic>) and coefficient of determination (<italic>R</italic><sup>2</sup>) were used to assess and compare model performance.</p></sec></sec></sec><sec sec-type="results" id="sec012"><title>Results</title><sec id="sec013"><title>Descriptive analysis of LAI</title><p>To evaluate the model robustness under temporal variation, the 2014&#x02013;2016 field-collected data were used as the calibration dataset, and the 2017 field-collected data were used as the standalone validation dataset. Descriptive statistics on the measured LAI are shown in <xref rid="pone.0207624.t002" ref-type="table">Table 2</xref>. The measured LAI ranges between 0.08 and 7.35 with a mean of 2.56 and a standard deviation of 1.62.</p><table-wrap id="pone.0207624.t002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.t002</object-id><label>Table 2</label><caption><title>Descriptive statistics for measured LAI.</title></caption><alternatives><graphic id="pone.0207624.t002g" xlink:href="pone.0207624.t002"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1"/><th align="right" rowspan="1" colspan="1">Sample NO.</th><th align="center" rowspan="1" colspan="1">mean</th><th align="center" rowspan="1" colspan="1">s.d.</th><th align="center" rowspan="1" colspan="1">min</th><th align="center" rowspan="1" colspan="1">max</th><th align="center" rowspan="1" colspan="1">range</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">ALL</td><td align="right" rowspan="1" colspan="1">419</td><td align="char" char="." rowspan="1" colspan="1">2.56</td><td align="char" char="." rowspan="1" colspan="1">1.62</td><td align="char" char="." rowspan="1" colspan="1">0.08</td><td align="char" char="." rowspan="1" colspan="1">7.35</td><td align="char" char="." rowspan="1" colspan="1">7.27</td></tr><tr><td align="left" rowspan="1" colspan="1">Calibration</td><td align="right" rowspan="1" colspan="1">313</td><td align="char" char="." rowspan="1" colspan="1">2.45</td><td align="char" char="." rowspan="1" colspan="1">1.71</td><td align="char" char="." rowspan="1" colspan="1">0.08</td><td align="char" char="." rowspan="1" colspan="1">7.35</td><td align="char" char="." rowspan="1" colspan="1">7.27</td></tr><tr><td align="left" rowspan="1" colspan="1">Validation</td><td align="right" rowspan="1" colspan="1">106</td><td align="char" char="." rowspan="1" colspan="1">2.83</td><td align="char" char="." rowspan="1" colspan="1">1.34</td><td align="char" char="." rowspan="1" colspan="1">0.55</td><td align="char" char="." rowspan="1" colspan="1">6.62</td><td align="char" char="." rowspan="1" colspan="1">6.08</td></tr></tbody></table></alternatives></table-wrap><p>The distribution of measured LAI value was significantly different from the normal distribution (<italic>pvalue</italic> &#x0003c; 0.001 in Shapiro-Wilk&#x02019;s test). The LAI variance between the calibration and validation dataset was homogeneous (<italic>pvalue</italic> &#x0003c; 0.01 in Fligner-Killeen test), but the LAI distribution showed statistical significant difference (<italic>pvalue</italic> &#x0003c; 0.01 in Wilcoxon test) between the calibration and validation dataset with a slightly higher mean in validation dataset. The result of analysis of variance (ANOVA) showed that the nitrogen treatment effected the LAI significantly, while neither the biochar treatment nor the interaction between the nitrogen treatment and biochar treatment effected the LAI significantly(<xref rid="pone.0207624.t003" ref-type="table">Table 3</xref>).</p><table-wrap id="pone.0207624.t003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.t003</object-id><label>Table 3</label><caption><title>ANOVA test result on effects of nitrogen and biochar treatments to LAI.</title><p>The N, C and N:C represent the nitrogen treatment, biochar treatment and interaction between nitrogen and biochar treatment.</p></caption><alternatives><graphic id="pone.0207624.t003g" xlink:href="pone.0207624.t003"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1"/><th align="right" rowspan="1" colspan="1">Df</th><th align="center" rowspan="1" colspan="1">Sum Sq</th><th align="center" rowspan="1" colspan="1">Mean Sq</th><th align="center" rowspan="1" colspan="1">F value</th><th align="right" rowspan="1" colspan="1">Pr(&#x0003e;F)</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">N</td><td align="right" rowspan="1" colspan="1">2</td><td align="char" char="." rowspan="1" colspan="1">423.9</td><td align="char" char="." rowspan="1" colspan="1">211.95</td><td align="char" char="." rowspan="1" colspan="1">128.006</td><td align="right" rowspan="1" colspan="1">&#x0003c;2e-16 <xref ref-type="table-fn" rid="t003fn001">***</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">C</td><td align="right" rowspan="1" colspan="1">3</td><td align="char" char="." rowspan="1" colspan="1">2.9</td><td align="char" char="." rowspan="1" colspan="1">0.98</td><td align="char" char="." rowspan="1" colspan="1">0.592</td><td align="right" rowspan="1" colspan="1">0.621</td></tr><tr><td align="left" rowspan="1" colspan="1">N:C</td><td align="right" rowspan="1" colspan="1">6</td><td align="char" char="." rowspan="1" colspan="1">12.0</td><td align="char" char="." rowspan="1" colspan="1">2.00</td><td align="char" char="." rowspan="1" colspan="1">1.206</td><td align="right" rowspan="1" colspan="1">0.302</td></tr><tr><td align="left" rowspan="1" colspan="1">Residuals</td><td align="right" rowspan="1" colspan="1">407</td><td align="char" char="." rowspan="1" colspan="1">673.9</td><td align="char" char="." rowspan="1" colspan="1">1.66</td><td align="center" rowspan="1" colspan="1"/><td align="right" rowspan="1" colspan="1"/></tr></tbody></table></alternatives><table-wrap-foot><fn id="t003fn001"><p>*** denotes significance at the 1% level.</p></fn></table-wrap-foot></table-wrap></sec><sec id="sec014"><title>Optimized spectral index</title><p>By visualizing the calibration <italic>R</italic><sup>2</sup> values of the sequential linear regression models on the NDVI (<xref ref-type="disp-formula" rid="pone.0207624.e001">Eq 1</xref>) with all possible two-pair &#x003bb;1 &#x0003c; &#x003bb;2 band combinations against LAI (<xref ref-type="fig" rid="pone.0207624.g002">Fig 2</xref>), two hotspots were found, with one centred at (766<italic>nm</italic>, 830<italic>nm</italic>) and the other one centred at (1114<italic>nm</italic>, 1190<italic>nm</italic>). The calibrated models based on <italic>NDVI</italic><sub>(760,830)</sub>, <italic>NDVI</italic><sub>(1114,1190)</sub> and <italic>NDVI</italic><sub>(680,830)</sub>, which is with the classical red/NIR band combination, were then evaluated on the validation dataset. The model based on <italic>NDVI</italic><sub>(680,830)</sub> performed poorly with <italic>RMSE</italic> values of 1.60 and 1.59 and <italic>R</italic><sup>2</sup> values of 0.14 and 0.04 in the model calibration and validation, respectively (<xref rid="pone.0207624.t004" ref-type="table">Table 4</xref>). A clear underestimation of the data was observed when <italic>LAI</italic> &#x0003e; 3 and for all reproductive post-heading data (<xref ref-type="fig" rid="pone.0207624.g003">Fig 3</xref>). The model based on <italic>NDVI</italic><sub>(766,830)</sub> showed a moderate accuracy and robustness, with <italic>RMSE</italic> and <italic>R</italic><sup>2</sup> values of 1.02 and 0.65 in model calibration and 1.17 and 0.53 in model validation, respectively. The accuracy and robustness of the model based on <italic>NDVI</italic><sub>(1114,1190)</sub> were somewhat lower with <italic>RMSE</italic> and <italic>R</italic><sup>2</sup> values of 1.13 and 0.58 in model calibration and 1.01 and 0.48 in model validation, respectively. No clear overestimation or underestimation was found in the observed vs. predicted LAI scatterplot (<xref ref-type="fig" rid="pone.0207624.g003">Fig 3</xref>).</p><fig id="pone.0207624.g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.g002</object-id><label>Fig 2</label><caption><title>Calibration <italic>R</italic><sup>2</sup> counterplot for linear regression models built on NDVI (<xref ref-type="disp-formula" rid="pone.0207624.e001">Eq 1</xref>) with all possible two-pair &#x003bb;1 &#x0003c; &#x003bb;2 band combinations against LAI.</title></caption><graphic xlink:href="pone.0207624.g002"/></fig><fig id="pone.0207624.g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.g003</object-id><label>Fig 3</label><caption><title>Observed vs. predicted LAI scatterplot of the linear regression models built on <italic>NDVI</italic><sub>(680,830)</sub>, <italic>NDVI</italic><sub>(766,830)</sub> and <italic>NDVI</italic><sub>(1114,1190)</sub> and evaluated on the validation dataset.</title><p>The grey solid line is the 1:1 line. The colour and shape of points indicate different growth stages.</p></caption><graphic xlink:href="pone.0207624.g003"/></fig><table-wrap id="pone.0207624.t004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.t004</object-id><label>Table 4</label><caption><title>Goodness of fit for linear regression models with different <italic>NDVI</italic> against LAI.</title></caption><alternatives><graphic id="pone.0207624.t004g" xlink:href="pone.0207624.t004"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="2" colspan="1">Input</th><th align="center" colspan="2" rowspan="1">Calibration (n = 313)</th><th align="center" colspan="2" rowspan="1">Validation (n = 106)</th></tr><tr><th align="right" rowspan="1" colspan="1"><italic>RMSE</italic></th><th align="right" rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></th><th align="right" rowspan="1" colspan="1"><italic>RMSE</italic></th><th align="right" rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1"><italic>NDVI</italic><sub>(680,830)</sub></td><td align="char" char="." rowspan="1" colspan="1">1.60</td><td align="char" char="." rowspan="1" colspan="1">0.14</td><td align="char" char="." rowspan="1" colspan="1">1.59</td><td align="char" char="." rowspan="1" colspan="1">0.04</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>NDVI</italic><sub>(766,830)</sub></td><td align="char" char="." rowspan="1" colspan="1">1.02</td><td align="char" char="." rowspan="1" colspan="1">0.65</td><td align="char" char="." rowspan="1" colspan="1">1.17</td><td align="char" char="." rowspan="1" colspan="1">0.53</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>NDVI</italic><sub>(1114,1190)</sub></td><td align="char" char="." rowspan="1" colspan="1">1.13</td><td align="char" char="." rowspan="1" colspan="1">0.58</td><td align="char" char="." rowspan="1" colspan="1">1.01</td><td align="char" char="." rowspan="1" colspan="1">0.48</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="sec015"><title>PLS and machine learning methods</title><sec id="sec016"><title>Selection of appropriate model parameters</title><p>The relationships between <italic>RMSE</italic><sub><italic>cv</italic></sub> and the models&#x02019; key parameters (<italic>LVs</italic> for PLS, <italic>C</italic>, <italic>&#x003c3;</italic> for SVR, <italic>mtry</italic> for RF and <italic>units</italic> for ANN) are shown in <xref ref-type="fig" rid="pone.0207624.g004">Fig 4</xref>. For PLS, the <italic>RMSE</italic><sub><italic>cv</italic></sub> values were lowest when <italic>LVs</italic> = 21 and <italic>LVs</italic> = 11 for the raw and D1 spectra, and the <italic>RMSE</italic><sub><italic>cv</italic></sub> rate of decrease first falls below 2% when <italic>LVs</italic> = 6 and <italic>LVs</italic> = 4 for the raw and D1 spectra, respectively. For SVR, the <italic>RMSE</italic><sub><italic>cv</italic></sub> values were lowest when <italic>C</italic> = 64, <italic>&#x003c3;</italic> = 5.03 &#x000d7; 10<sup>&#x02212;04</sup> and <italic>C</italic> = 8, <italic>&#x003c3;</italic> = 5.15 &#x000d7; 10<sup>&#x02212;4</sup> for the raw and D1 spectra, respectively. For RF, the <italic>RMSE</italic><sub><italic>cv</italic></sub> values were the lowest when <italic>mtry</italic> = 149 and <italic>mtry</italic> = 23 for the raw and D1 spectra, and the <italic>RMSE</italic><sub><italic>cv</italic></sub> rate of decrease first fell below 2% when <italic>mtry</italic> = 3 and <italic>mtry</italic> = 10 for raw and D1 spectra, respectively. For ANN, the <italic>RMSE</italic><sub><italic>cv</italic></sub> values were lowest when <italic>units</italic> = 5 and <italic>units</italic> = 17 for the raw and D1 spectra, respectively, and the <italic>RMSE</italic><sub><italic>cv</italic></sub> rate of decrease was either below 2% or negative when the value of <italic>units</italic> increased from <italic>units</italic> = 2. The parameters used in the final models are listed in <xref rid="pone.0207624.t005" ref-type="table">Table 5</xref>.</p><fig id="pone.0207624.g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.g004</object-id><label>Fig 4</label><caption><title>Relationship between <italic>RMSE</italic><sub><italic>cv</italic></sub> and <italic>LV s</italic> of partial least squares (PLS) models (A), <italic>mtry</italic> of random forests (RF) models (B), <italic>units</italic> of artificial neural network (ANN) model (C), as well as the relationship between <italic>RMSE</italic><sub><italic>cv</italic></sub> and <italic>C</italic>, <italic>&#x003c3;</italic> of support vector regression (SVR) models built on raw spectra (D), D1 spectra (E).</title><p>The colour and shape of points as well as colour and line type of line in panel A-C indicate two models with different input data&#x02014;raw reflectance (raw) and first derivative spectra (D1), while the colour in panels D-E indicates the values of <italic>RMSE</italic><sub><italic>cv</italic></sub>.</p></caption><graphic xlink:href="pone.0207624.g004"/></fig><table-wrap id="pone.0207624.t005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.t005</object-id><label>Table 5</label><caption><title>Parameters used in final models with different input data (RAW and D1) and two different parameter selection criteria.</title><p>The parameter selection criteria RULE1 and RULE2 were defined in Section Methods.</p></caption><alternatives><graphic id="pone.0207624.t005g" xlink:href="pone.0207624.t005"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Selection criterion</th><th align="left" rowspan="1" colspan="1">Input</th><th align="left" rowspan="1" colspan="1">PLS</th><th align="left" rowspan="1" colspan="1">SVR</th><th align="left" rowspan="1" colspan="1">RF</th><th align="left" rowspan="1" colspan="1">ANN</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">RULE1</td><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1"><italic>LVs</italic> = 21</td><td align="left" rowspan="1" colspan="1"><italic>C</italic> = 64, <italic>&#x003c3;</italic> = 5.03 &#x000d7; 10<sup>&#x02212;04</sup></td><td align="left" rowspan="1" colspan="1"><italic>mtry</italic> = 149</td><td align="left" rowspan="1" colspan="1"><italic>units</italic> = 5</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE1</td><td align="left" rowspan="1" colspan="1">D1</td><td align="left" rowspan="1" colspan="1"><italic>LVs</italic> = 11</td><td align="left" rowspan="1" colspan="1"><italic>C</italic> = 8, <italic>&#x003c3;</italic> = 5.15 &#x000d7; 10<sup>&#x02212;04</sup></td><td align="left" rowspan="1" colspan="1"><italic>mtry</italic> = 23</td><td align="left" rowspan="1" colspan="1"><italic>units</italic> = 17</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE2</td><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1"><italic>LVs</italic> = 6</td><td align="left" rowspan="1" colspan="1">&#x02212;</td><td align="left" rowspan="1" colspan="1"><italic>mtry</italic> = 3</td><td align="left" rowspan="1" colspan="1"><italic>units</italic> = 2</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE2</td><td align="left" rowspan="1" colspan="1">D1</td><td align="left" rowspan="1" colspan="1"><italic>LVs</italic> = 4</td><td align="left" rowspan="1" colspan="1">&#x02212;</td><td align="left" rowspan="1" colspan="1"><italic>mtry</italic> = 10</td><td align="left" rowspan="1" colspan="1"><italic>units</italic> = 2</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="sec017"><title>Goodness of fit</title><p>Built on the optimized parameters selected using the two different rules (detailed in <xref rid="pone.0207624.t005" ref-type="table">Table 5</xref>), the PLS, SVR, RF and ANN models were calibrated on the full calibration dataset and validated against the standalone validation dataset for both the raw and D1 spectra. The calibration and validation <italic>RMSE</italic> and <italic>R</italic><sup>2</sup> values of these models are listed in <xref rid="pone.0207624.t006" ref-type="table">Table 6</xref>. The difference between the validation and calibration <italic>RMSE</italic> and <italic>R</italic><sup>2</sup> values are not clear, with the differences in <italic>RMSE</italic> ranging from -0.08&#x02013;0.31 and the differences in <italic>R</italic><sup>2</sup> ranging from -0.24&#x02013;0.06 for all models with the four calibration techniques, two optimal parameter selection rules and two different input datasets. These results demonstrated the robustness of the PLS, SVR, RF and ANN methods under temporal variation and demonstrated that there were no clear overfitting problems in the calibrated models. For all of the four methods, models built on D1 spectra yielded lower <italic>RMSE</italic> and higher <italic>R</italic><sup>2</sup> values than corresponding models built on raw spectra both in model calibration and validation except for the PLS method, for which the models built on D1 spectra yielded slightly higher <italic>RMSE</italic> and lower <italic>R</italic><sup>2</sup> values than the models built on raw spectra. These results revealed that the D1 spectra outperformed the raw spectra. When comparing the corresponding PLS, RF and SVR models built on the optimized parameters determined by RULE2 and RULE1, the <italic>RMSE</italic> differences ranged from 0.00&#x02013;0.11 and -0.04&#x02013;0.03, while the <italic>R</italic><sup>2</sup> difference ranged from -0.06&#x02013;0.00 and -0.04&#x02013;0.06, during model calibration and validation, respectively. These results mean that the optimized parameters selected by RULE2 did not clearly reduce model accuracy or robustness while reducing the model complexity.</p><table-wrap id="pone.0207624.t006" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.t006</object-id><label>Table 6</label><caption><title>Goodness of fit for PLS, SVR, RF and ANN models with two different input datasets (raw and D1) and different optimized parameters determined by two selection criteria (RULE1 and RULE2).</title></caption><alternatives><graphic id="pone.0207624.t006g" xlink:href="pone.0207624.t006"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="2" colspan="1">Selection Criterion</th><th align="left" rowspan="2" colspan="1">Input</th><th align="left" rowspan="2" colspan="1">Method</th><th align="left" rowspan="2" colspan="1">Parameter</th><th align="center" colspan="2" rowspan="1">Calibration (n = 313)</th><th align="center" colspan="2" rowspan="1">Validation (n = 106)</th></tr><tr><th align="right" rowspan="1" colspan="1"><italic>RMSE</italic></th><th align="right" rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></th><th align="right" rowspan="1" colspan="1"><italic>RMSE</italic></th><th align="right" rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">RULE1</td><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1">PLS</td><td align="left" rowspan="1" colspan="1"><italic>LVs</italic> = 21</td><td align="char" char="." rowspan="1" colspan="1">0.73</td><td align="char" char="." rowspan="1" colspan="1">0.82</td><td align="char" char="." rowspan="1" colspan="1">0.96</td><td align="char" char="." rowspan="1" colspan="1">0.55</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE2</td><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1">PLS</td><td align="left" rowspan="1" colspan="1"><italic>LVs</italic> = 6</td><td align="char" char="." rowspan="1" colspan="1">0.84</td><td align="char" char="." rowspan="1" colspan="1">0.76</td><td align="char" char="." rowspan="1" colspan="1">0.93</td><td align="char" char="." rowspan="1" colspan="1">0.61</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE1</td><td align="left" rowspan="1" colspan="1">D1</td><td align="left" rowspan="1" colspan="1">PLS</td><td align="left" rowspan="1" colspan="1"><italic>LVs</italic> = 11</td><td align="char" char="." rowspan="1" colspan="1">0.78</td><td align="char" char="." rowspan="1" colspan="1">0.80</td><td align="char" char="." rowspan="1" colspan="1">0.90</td><td align="char" char="." rowspan="1" colspan="1">0.62</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE2</td><td align="left" rowspan="1" colspan="1">D1</td><td align="left" rowspan="1" colspan="1">PLS</td><td align="left" rowspan="1" colspan="1"><italic>LVs</italic> = 4</td><td align="char" char="." rowspan="1" colspan="1">0.88</td><td align="char" char="." rowspan="1" colspan="1">0.74</td><td align="char" char="." rowspan="1" colspan="1">0.84</td><td align="char" char="." rowspan="1" colspan="1">0.64</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE1</td><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1">SVR</td><td align="left" rowspan="1" colspan="1"><italic>C</italic> = 64, <italic>&#x003c3;</italic> = 5.03 &#x000d7; 10<sup>04</sup></td><td align="char" char="." rowspan="1" colspan="1">0.77</td><td align="char" char="." rowspan="1" colspan="1">0.80</td><td align="char" char="." rowspan="1" colspan="1">1.08</td><td align="char" char="." rowspan="1" colspan="1">0.52</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE1</td><td align="left" rowspan="1" colspan="1">D1</td><td align="left" rowspan="1" colspan="1">SVR</td><td align="left" rowspan="1" colspan="1"><italic>C</italic> = 8, <italic>&#x003c3;</italic> = 5.15 &#x000d7; 10<sup>04</sup></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.69</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.84</bold></td><td align="char" char="." rowspan="1" colspan="1">0.82</td><td align="char" char="." rowspan="1" colspan="1">0.70</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE1</td><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1">RF</td><td align="left" rowspan="1" colspan="1"><italic>mtry</italic> = 149</td><td align="char" char="." rowspan="1" colspan="1">0.95</td><td align="char" char="." rowspan="1" colspan="1">0.70</td><td align="char" char="." rowspan="1" colspan="1">1.06</td><td align="char" char="." rowspan="1" colspan="1">0.58</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE2</td><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1">RF</td><td align="left" rowspan="1" colspan="1"><italic>mtry</italic> = 3</td><td align="char" char="." rowspan="1" colspan="1">1.01</td><td align="char" char="." rowspan="1" colspan="1">0.67</td><td align="char" char="." rowspan="1" colspan="1">1.05</td><td align="char" char="." rowspan="1" colspan="1">0.58</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE1</td><td align="left" rowspan="1" colspan="1">D1</td><td align="left" rowspan="1" colspan="1">RF</td><td align="left" rowspan="1" colspan="1"><italic>mtry</italic> = 23</td><td align="char" char="." rowspan="1" colspan="1">0.71</td><td align="char" char="." rowspan="1" colspan="1">0.83</td><td align="char" char="." rowspan="1" colspan="1">0.68</td><td align="char" char="." rowspan="1" colspan="1">0.75</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE2</td><td align="left" rowspan="1" colspan="1">D1</td><td align="left" rowspan="1" colspan="1">RF</td><td align="left" rowspan="1" colspan="1"><italic>mtry</italic> = 10</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.71</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.83</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.67</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.76</bold></td></tr><tr><td align="left" rowspan="1" colspan="1">RULE1</td><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1">ANN</td><td align="left" rowspan="1" colspan="1"><italic>units</italic> = 5</td><td align="char" char="." rowspan="1" colspan="1">0.93</td><td align="char" char="." rowspan="1" colspan="1">0.56</td><td align="char" char="." rowspan="1" colspan="1">0.85</td><td align="char" char="." rowspan="1" colspan="1">0.62</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE2</td><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1">ANN</td><td align="left" rowspan="1" colspan="1"><italic>units</italic> = 2</td><td align="char" char="." rowspan="1" colspan="1">0.93</td><td align="char" char="." rowspan="1" colspan="1">0.55</td><td align="char" char="." rowspan="1" colspan="1">0.88</td><td align="char" char="." rowspan="1" colspan="1">0.58</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE1</td><td align="left" rowspan="1" colspan="1">D1</td><td align="left" rowspan="1" colspan="1">ANN</td><td align="left" rowspan="1" colspan="1"><italic>units</italic> = 17</td><td align="char" char="." rowspan="1" colspan="1">0.77</td><td align="char" char="." rowspan="1" colspan="1">0.70</td><td align="char" char="." rowspan="1" colspan="1">0.87</td><td align="char" char="." rowspan="1" colspan="1">0.72</td></tr><tr><td align="left" rowspan="1" colspan="1">RULE2</td><td align="left" rowspan="1" colspan="1">D1</td><td align="left" rowspan="1" colspan="1">ANN</td><td align="left" rowspan="1" colspan="1"><italic>units</italic> = 2</td><td align="char" char="." rowspan="1" colspan="1">0.79</td><td align="char" char="." rowspan="1" colspan="1">0.68</td><td align="char" char="." rowspan="1" colspan="1">0.84</td><td align="char" char="." rowspan="1" colspan="1">0.73</td></tr></tbody></table></alternatives></table-wrap><p>Compared with the validation results of <italic>NDVI</italic><sub>(766,830)</sub>, the best PLS, SVR, RF and ANN models increase the prediction accuracy by 28.21%, 29.91%, 42.74% and 28.21% as measured by <italic>RMSE</italic> and explained 20.75%, 32.08%, 43.40% and 37.73% of the additional variance as measured by <italic>R</italic><sup>2</sup>, respectively. The machine learning methods outperformed the linear VI and PLS methods by achieving lower <italic>RMSE</italic> and higher <italic>R</italic><sup>2</sup> values both in model calibration and validation. The SVR model built on D1 spectra performed best in model calibration (<italic>RMSE</italic> = 0.69, <italic>R</italic><sup>2</sup> = 0.84), but not when validated against the standalone validation dataset (<italic>RMSE</italic> = 0.82, <italic>R</italic><sup>2</sup> = 0.70). The RF model built on D1 spectra with <italic>mtry</italic> = 10, which was selected by RULE2, yielded comparable results with the SVR model built on D1 spectra in model calibration with <italic>RMSE</italic> = 0.71 and <italic>R</italic><sup>2</sup> = 0.83 and yielded the best validation results with the lowest <italic>RMSE</italic> and highest <italic>R</italic><sup>2</sup> (<italic>RMSE</italic> = 0.67, <italic>R</italic><sup>2</sup> = 0.76). The scatterplot of the observed and predicted LAI for this model (<xref ref-type="fig" rid="pone.0207624.g005">Fig 5</xref>) shows no clear overestimation or underestimation for specific LAI value ranges or growth stages. The observed and predicted LAI relationship in <xref ref-type="fig" rid="pone.0207624.g005">Fig 5</xref> is less scattered than that in <xref ref-type="fig" rid="pone.0207624.g003">Fig 3</xref>.</p><fig id="pone.0207624.g005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207624.g005</object-id><label>Fig 5</label><caption><title>Observed vs. predicted LAI scatterplot for RF model built on D1 spectra and parameter selected by RULE2 evaluated on the validation dataset.</title><p>The grey solid line is the 1:1 line. The colour and shape of points indicate different growth stages.</p></caption><graphic xlink:href="pone.0207624.g005"/></fig></sec></sec></sec><sec sec-type="conclusions" id="sec018"><title>Discussion</title><p>The narrowband NDVI with the RE/NIR band combination (788 nm, 830 nm) and combination of two SWIR bands (1114 nm, 1190 nm) were optimal for paddy rice LAI estimation in this study. The drawbacks of traditional VIs calculated using the red/NIR band combination, including that this approach saturates when LAI increases above 2&#x02013;3, have been widely discussed [<xref rid="pone.0207624.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0207624.ref036" ref-type="bibr">36</xref>]. NDVI with a band combination optimized by an exhaustive search of all possible band combinations has been demonstrated to be more effective than with the traditional RE/NIR band combination [<xref rid="pone.0207624.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0207624.ref022" ref-type="bibr">22</xref>, <xref rid="pone.0207624.ref037" ref-type="bibr">37</xref>]. Although the specific optimal band combinations appear to be different across studies with different crop types and study areas, the importance of the RE bands and SWIR bands has been widely demonstrated [<xref rid="pone.0207624.ref022" ref-type="bibr">22</xref>, <xref rid="pone.0207624.ref037" ref-type="bibr">37</xref>]. Tanaka <italic>et al</italic>. [<xref rid="pone.0207624.ref037" ref-type="bibr">37</xref>] concluded that the difference, ratio and normalized ratio of reflectance at 760nm and 739nm showed outstanding performance for winter wheat LAI (range between 0.3 and 5.5) assessment with <italic>RMSE</italic> range between 0.372 and 0.455, which were lower than the <italic>RMSE</italic> of other nine major and potentially useful spectral index for LAI prediction. Kira <italic>et al</italic>. [<xref rid="pone.0207624.ref022" ref-type="bibr">22</xref>] showed that the ratio and normalized ratio of RE/NIR bands were essential for LAI estimation for maize and soybean and both corps combined. On a dataset of conifer forest, Peng <italic>et al</italic>. [<xref rid="pone.0207624.ref036" ref-type="bibr">36</xref>] analyzed 12 two band spectral index by constructing them using all possible two band combinations then related them to the corresponding LAI values. The results showed that bands in SWIR and some in NIR region were essential in forming spectral indices for LAI estimation. These findings are consistent with the result of this study.</p><p>Several studies have evaluated whether the derivative spectrum could enhance the performance of PLS and ML methods compared to the raw hyperspectral reflectance [<xref rid="pone.0207624.ref038" ref-type="bibr">38</xref>&#x02013;<xref rid="pone.0207624.ref040" ref-type="bibr">40</xref>]. These works have revealed that the derivative spectrum are not always better options to build multivariate regression models. Cho <italic>et al</italic>. [<xref rid="pone.0207624.ref038" ref-type="bibr">38</xref>] showed that the PLS models for grass/herb biomass estimation on Raw and D1 spectrum yielded similar <italic>RMSE</italic> and <italic>R</italic><sup>2</sup> values. Yao <italic>et al</italic>. [<xref rid="pone.0207624.ref039" ref-type="bibr">39</xref>] concluded that the performance of the SVM and ANN models could not be improved when using derivative spectrum except for the PLS model when monitoring the wheat leaf nitrogen concentration. Another work [<xref rid="pone.0207624.ref040" ref-type="bibr">40</xref>] demonstrated that the stepwise multilinear regression models built on D1 spectra explained more variability of paddy rice aboveground biomass than Raw spectra. In this work, both the PLS and three ML method yielded lower <italic>RMSE</italic> and higher <italic>R</italic><sup>2</sup> when built on the D1 spectrum. The derivative of raw spectra can overcome atmospheric and background disturbance and enhance the spectral signature [<xref rid="pone.0207624.ref025" ref-type="bibr">25</xref>]. The flooded water in paddy rice fields adds additional noise in the canopy reflectance, which may explain why the D1 spectra outperformed the raw spectra for the PLS and three MLs methods for paddy rice canopy parameters estimation.</p><p>While the abundant bands provided by hyperspectral data give more detailed spectral features, these data also pose the challenge of multicollinearity in spectral features and the potential overfitting problem. The four multivariate calibration methods evaluated in this study are intrinsically able to handle data with high input feature spaces in different ways. The PLS method lowers the input feature space to few <italic>LVs</italic> by component projection. The RF method builds each decision tree on a subset of (<italic>mtry</italic>) input variables. The SVM is built on the structure-risk-minimum principle and is independent of the input feature dimension. The ANN is combined with a regularizer (the L1 regularizer is utilized in this study) to regulate the weights. Given these features, although the observation numbers (n = 313 for model calibration) was not large enough given the dimension of the input data (513), no clear overfitting phenomena were observed for any of the calibrated models.</p><p>The RF method resulted in suboptimal calibration accuracy and the best validation accuracy. The superiority of the RF method to other methods was consisted with recent studies [<xref rid="pone.0207624.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0207624.ref041" ref-type="bibr">41</xref>, <xref rid="pone.0207624.ref042" ref-type="bibr">42</xref>]. Wei <italic>et al</italic>. [<xref rid="pone.0207624.ref041" ref-type="bibr">41</xref>] showed that the RF model gave more accurate result than the ANN and SVM models when trying to retrieve the multiple growth stages soybean LAI. The excellent performance of the RF model may be due to its &#x02018;majority vote&#x02019; principle, which reduces the negative effects of outliers. In addition, building each decision tree on a subset of (<italic>mtry</italic>) bands is intrinsically resistant to the overfitting problem. The SVM yielded the best calibration accuracy and suboptimal validation accuracy, which means that the SVM method is potentially efficient for paddy rice LAI estimation but is less robust than the RF method under temporal variation. The superiority of ANN to VI methods has been demonstrated repeatedly in various studies, but the ANN method is not always optimal compared with other ML methods [<xref rid="pone.0207624.ref023" ref-type="bibr">23</xref>]. The performance of ANN models is influenced by the model structure. Too many or too few layers/units reduce the model performance significantly. The PLS is simple, computationally efficient and capable of avoiding the multicollinearity in input features while handling high-dimensional hyperspectral bands. However, the PLS method is intrinsically a linear calibration technique and cannot estimate the nonlinear relationship between spectral data and LAI.</p><p>A plot experiment with different nitrogen and biochar treatments were used to obtain spectra/LAI reference data in this study. However the ANOVA analysis showed that neither the biochar nor the the interaction between nitrogen and biochar effected the LAI value significantly (<xref rid="pone.0207624.t003" ref-type="table">Table 3</xref>). This resulted in a relative lower variance of LAI values (<xref rid="pone.0207624.t002" ref-type="table">Table 2</xref>). To get a large variance of LAI reference values by controlling the biochar levels is indeed not a good choice. However, given the large range of LAI value (0.08&#x02013;7.35) at mean of 2.56 and stand deviation of 1.62, we believe the models built on these dataset still have reference value. The bichar application to agricultural soils has been highlighted that is able to decrease soil nitrogen leaching and increase rice nitrogen uptake [<xref rid="pone.0207624.ref043" ref-type="bibr">43</xref>]. The insignificant effects of biochar treatment as well as interaction between nitrogen and bichar treatment on LAI variance could be due to that the variance of nitrogen use efficiency caused by bichar was not strong enough to effect the paddy rice LAI significantly.</p></sec><sec sec-type="conclusions" id="sec019"><title>Conclusion</title><p>A multi-year field-collected dataset was used to evaluate the performance of three machine learning (ML) methods&#x02014;support vector regression(SVM), random forests (RF) and artificial neural network (ANN)&#x02014;for paddy rice LAI estimation, and a comparison with vegetation index (VI) and partial least square (PLS) methods was conducted. The VI models were built on the NDVI with red/NIR band combination and optimized band combinations. The PLS and ML models were built on raw reflectance (raw) spectra and first derivative (D1) spectra. Two different rules were used to determine the parameters of the PLS, RF and ANN methods. The first rule (RULE1) chose the parameter with the lowest cross validated calibration <italic>RMSE</italic>, and the second rule (RULE2) considered both the model complexity and the cross validation calibration <italic>RMSE</italic>. To evaluate the models&#x02019; robustness, all models were calibrated on the 2014&#x02013;2016 growth seasons datasets and validated on the 2017 growth season dataset.</p><p>The results demonstrated that the NDVI with red/NIR bands did not work in this study. The NDVI with red edge band and NIR band combination (766 nm, 830 nm), as well as two SWIR band combinations (1114, 1190) could give reasonable estimations. For PLS and three ML methods, the models built on D1 spectra yielded higher accuracies. The models with optimized parameters determined by RULE2 resulted in comparable accuracy and robustness with the the models with optimized parameters determined by RULE1 and significantly reduced the complexity of the models. For the <italic>RMSE</italic> validation metric, the best PLS, SVM, RF and ANN models reduced the prediction error by 28.21%, 29.91%, 42.74% and 28.21%, respectively, compared to the linear regression model built on <italic>NDVI</italic><sub>(766,830)</sub>. The SVM model built on D1 spectra yielded the best calibration result (<italic>RMSE</italic> = 0.69, <italic>R</italic><sup>2</sup> = 0.84) but showed a small decrease in accuracy when validated against the standalone validation dataset (<italic>RMSE</italic> = 0.82, <italic>R</italic><sup>2</sup> = 0.70). The RF model built on D1 spectra with parameters selected by RULE2 yielded the second best calibration accuracy (<italic>RMSE</italic> = 0.71, <italic>R</italic><sup>2</sup> = 0.83) and performed best when validated against the standalone validation dataset (<italic>RMSE</italic> = 0.67, <italic>R</italic><sup>2</sup> = 0.75).</p></sec><sec sec-type="supplementary-material" id="sec020"><title>Supporting information</title><supplementary-material content-type="local-data" id="pone.0207624.s001"><label>S1 File</label><caption><title>The dataset used in this study.</title><p>(CSV)</p></caption><media xlink:href="pone.0207624.s001.csv"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ref-list><title>References</title><ref id="pone.0207624.ref001"><label>1</label><mixed-citation publication-type="journal">
<name><surname>Jonckheere</surname><given-names>I</given-names></name>, <name><surname>Fleck</surname><given-names>S</given-names></name>, <name><surname>Nackaerts</surname><given-names>K</given-names></name>, <name><surname>Muys</surname><given-names>B</given-names></name>, <name><surname>Coppin</surname><given-names>P</given-names></name>, <name><surname>Weiss</surname><given-names>M</given-names></name>, <etal>et al</etal>
<article-title>Review of methods for in situ leaf area index determination</article-title>. <source>Agricultural and Forest Meteorology</source>. <year>2004</year>;<volume>121</volume>(<issue>1-2</issue>):<fpage>19</fpage>&#x02013;<lpage>35</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.agrformet.2003.08.027">10.1016/j.agrformet.2003.08.027</ext-link></mixed-citation></ref><ref id="pone.0207624.ref002"><label>2</label><mixed-citation publication-type="journal">
<name><surname>Zheng</surname><given-names>G</given-names></name>, <name><surname>Moskal</surname><given-names>LM</given-names></name>. <article-title>Retrieving Leaf Area Index (LAI) Using Remote Sensing: Theories, Methods and Sensors</article-title>. <source>Sensors</source>. <year>2009</year>;<volume>9</volume>(<issue>4</issue>):<fpage>2719</fpage>&#x02013;<lpage>2745</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/s90402719">10.3390/s90402719</ext-link>
<?supplied-pmid 22574042?><pub-id pub-id-type="pmid">22574042</pub-id></mixed-citation></ref><ref id="pone.0207624.ref003"><label>3</label><mixed-citation publication-type="journal">
<name><surname>Jin</surname><given-names>Xl</given-names></name>, <name><surname>Feng</surname><given-names>Hk</given-names></name>, <name><surname>Zhu</surname><given-names>Xk</given-names></name>, <name><surname>Li</surname><given-names>Zh</given-names></name>, <name><surname>Song</surname><given-names>Sn</given-names></name>, <name><surname>Song</surname><given-names>Xy</given-names></name>, <etal>et al</etal>
<article-title>Assessment of the AquaCrop Model for Use in Simulation of Irrigated Winter Wheat Canopy Cover, Biomass, and Grain Yield in the North China Plain</article-title>. <source>PLoS ONE</source>. <year>2014</year>;<volume>9</volume>(<issue>1</issue>):<fpage>e86938</fpage>
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0086938">10.1371/journal.pone.0086938</ext-link>
<?supplied-pmid 24489808?><pub-id pub-id-type="pmid">24489808</pub-id></mixed-citation></ref><ref id="pone.0207624.ref004"><label>4</label><mixed-citation publication-type="journal">
<name><surname>Xie</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>P</given-names></name>, <name><surname>Bai</surname><given-names>X</given-names></name>, <name><surname>Khan</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <etal>et al</etal>
<article-title>Assimilation of the leaf area index and vegetation temperature condition index for winter wheat yield estimation using Landsat imagery and the CERES-Wheat model</article-title>. <source>Agricultural and Forest Meteorology</source>. <year>2017</year>;<volume>246</volume>(<issue>17</issue>):<fpage>194</fpage>&#x02013;<lpage>206</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.agrformet.2017.06.015">10.1016/j.agrformet.2017.06.015</ext-link></mixed-citation></ref><ref id="pone.0207624.ref005"><label>5</label><mixed-citation publication-type="journal">
<name><surname>Mokhtari</surname><given-names>A</given-names></name>, <name><surname>Noory</surname><given-names>H</given-names></name>, <name><surname>Vazifedoust</surname><given-names>M</given-names></name>. <article-title>Improving crop yield estimation by assimilating LAI and inputting satellite-based surface incoming solar radiation into SWAP model</article-title>. <source>Agricultural and Forest Meteorology</source>. <year>2018</year>;<volume>250-251</volume>:<fpage>159</fpage>&#x02013;<lpage>170</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.agrformet.2017.12.250">10.1016/j.agrformet.2017.12.250</ext-link></mixed-citation></ref><ref id="pone.0207624.ref006"><label>6</label><mixed-citation publication-type="journal">
<name><surname>Kokaly</surname><given-names>RF</given-names></name>, <name><surname>Asner</surname><given-names>GP</given-names></name>, <name><surname>Ollinger</surname><given-names>SV</given-names></name>, <name><surname>Martin</surname><given-names>ME</given-names></name>, <name><surname>Wessman</surname><given-names>CA</given-names></name>. <article-title>Characterizing canopy biochemistry from imaging spectroscopy and its application to ecosystem studies</article-title>. <source>Remote Sensing of Environment</source>. <year>2009</year>;<volume>113</volume>(<issue>SUPPL. 1</issue>):<fpage>S78</fpage>&#x02013;<lpage>S91</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.rse.2008.10.018">10.1016/j.rse.2008.10.018</ext-link></mixed-citation></ref><ref id="pone.0207624.ref007"><label>7</label><mixed-citation publication-type="journal">
<name><surname>Milton</surname><given-names>EJ</given-names></name>, <name><surname>Schaepman</surname><given-names>ME</given-names></name>, <name><surname>Anderson</surname><given-names>K</given-names></name>, <name><surname>Kneub&#x000fc;hler</surname><given-names>M</given-names></name>, <name><surname>Fox</surname><given-names>N</given-names></name>. <article-title>Progress in field spectroscopy</article-title>. <source>Remote Sensing of Environment</source>. <year>2009</year>;<volume>113</volume>:<fpage>S92</fpage>&#x02013;<lpage>S109</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.rse.2007.08.001">10.1016/j.rse.2007.08.001</ext-link></mixed-citation></ref><ref id="pone.0207624.ref008"><label>8</label><mixed-citation publication-type="journal">
<name><surname>Goetz</surname><given-names>AFH</given-names></name>. <article-title>Three decades of hyperspectral remote sensing of the Earth: A personal view</article-title>. <source>Remote Sensing of Environment</source>. <year>2009</year>;<volume>113</volume>(<issue>SUPPL. 1</issue>):<fpage>S5</fpage>&#x02013;<lpage>S16</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.rse.2007.12.014">10.1016/j.rse.2007.12.014</ext-link></mixed-citation></ref><ref id="pone.0207624.ref009"><label>9</label><mixed-citation publication-type="journal">
<name><surname>Mulla</surname><given-names>DJ</given-names></name>. <article-title>Twenty five years of remote sensing in precision agriculture: Key advances and remaining knowledge gaps</article-title>. <source>Biosystems Engineering</source>. <year>2013</year>;<volume>114</volume>(<issue>4</issue>):<fpage>358</fpage>&#x02013;<lpage>371</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.biosystemseng.2012.08.009">10.1016/j.biosystemseng.2012.08.009</ext-link></mixed-citation></ref><ref id="pone.0207624.ref010"><label>10</label><mixed-citation publication-type="journal">
<name><surname>Wang</surname><given-names>C</given-names></name>, <name><surname>Feng</surname><given-names>M</given-names></name>, <name><surname>Yang</surname><given-names>W</given-names></name>, <name><surname>Ding</surname><given-names>G</given-names></name>, <name><surname>Xiao</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>G</given-names></name>, <etal>et al</etal>
<article-title>Extraction of Sensitive Bands for Monitoring the Winter Wheat (Triticum aestivum) Growth Status and Yields Based on the Spectral Reflectance</article-title>. <source>PLOS ONE</source>. <year>2017</year>;<volume>12</volume>(<issue>1</issue>):<fpage>e0167679</fpage>
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0167679">10.1371/journal.pone.0167679</ext-link>
<?supplied-pmid 28060827?><pub-id pub-id-type="pmid">28060827</pub-id></mixed-citation></ref><ref id="pone.0207624.ref011"><label>11</label><mixed-citation publication-type="journal">
<name><surname>Li</surname><given-names>G</given-names></name>, <name><surname>Wang</surname><given-names>C</given-names></name>, <name><surname>Feng</surname><given-names>M</given-names></name>, <name><surname>Yang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>F</given-names></name>, <name><surname>Feng</surname><given-names>R</given-names></name>. <article-title>Hyperspectral prediction of leaf area index of winter wheat in irrigated and rainfed fields</article-title>. <source>PLOS ONE</source>. <year>2017</year>;<volume>12</volume>(<issue>8</issue>):<fpage>e0183338</fpage>
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0183338">10.1371/journal.pone.0183338</ext-link>
<?supplied-pmid 28817658?><pub-id pub-id-type="pmid">28817658</pub-id></mixed-citation></ref><ref id="pone.0207624.ref012"><label>12</label><mixed-citation publication-type="journal">
<name><surname>Shen</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>Z</given-names></name>, <name><surname>Guo</surname><given-names>X</given-names></name>. <article-title>Remote Sensing of Leaf Area Index (LAI) and a Spatiotemporally Parameterized Model for Mixed Grasslands</article-title>. <source>International Journal of Applied Science and Technology</source>. <year>2014</year>;<volume>4</volume>(<issue>1</issue>):<fpage>46</fpage>&#x02013;<lpage>61</lpage>.</mixed-citation></ref><ref id="pone.0207624.ref013"><label>13</label><mixed-citation publication-type="journal">
<name><surname>LIU</surname><given-names>K</given-names></name>, <name><surname>ZHOU</surname><given-names>Qb</given-names></name>, <name><surname>WU</surname><given-names>Wb</given-names></name>, <name><surname>XIA</surname><given-names>T</given-names></name>, <name><surname>TANG</surname><given-names>Hj</given-names></name>. <article-title>Estimating the crop leaf area index using hyperspectral remote sensing</article-title>. <source>Journal of Integrative Agriculture</source>. <year>2016</year>;<volume>15</volume>(<issue>2</issue>):<fpage>475</fpage>&#x02013;<lpage>491</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S2095-3119(15)61073-5">10.1016/S2095-3119(15)61073-5</ext-link></mixed-citation></ref><ref id="pone.0207624.ref014"><label>14</label><mixed-citation publication-type="journal">
<name><surname>Zhao</surname><given-names>D</given-names></name>, <name><surname>Huang</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Qi</surname><given-names>J</given-names></name>. <article-title>A comparative analysis of broadband and narrowband derived vegetation indices in predicting LAI and CCD of a cotton canopy</article-title>. <source>ISPRS Journal of Photogrammetry and Remote Sensing</source>. <year>2007</year>;<volume>62</volume>(<issue>1</issue>):<fpage>25</fpage>&#x02013;<lpage>33</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.isprsjprs.2007.01.003">10.1016/j.isprsjprs.2007.01.003</ext-link></mixed-citation></ref><ref id="pone.0207624.ref015"><label>15</label><mixed-citation publication-type="journal">
<name><surname>Hansen</surname><given-names>PM</given-names></name>, <name><surname>Schjoerring</surname><given-names>JK</given-names></name>. <article-title>Reflectance measurement of canopy biomass and nitrogen status in wheat crops using normalized difference vegetation indices and partial least squares regression</article-title>. <source>Remote Sensing of Environment</source>. <year>2003</year>;<volume>86</volume>(<issue>4</issue>):<fpage>542</fpage>&#x02013;<lpage>553</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0034-4257(03)00131-7">10.1016/S0034-4257(03)00131-7</ext-link></mixed-citation></ref><ref id="pone.0207624.ref016"><label>16</label><mixed-citation publication-type="journal">
<name><surname>Delegido</surname><given-names>J</given-names></name>, <name><surname>Verrelst</surname><given-names>J</given-names></name>, <name><surname>Meza</surname><given-names>CM</given-names></name>, <name><surname>Rivera</surname><given-names>JP</given-names></name>, <name><surname>Alonso</surname><given-names>L</given-names></name>, <name><surname>Moreno</surname><given-names>J</given-names></name>. <article-title>A red-edge spectral index for remote sensing estimation of green LAI over agroecosystems</article-title>. <source>European Journal of Agronomy</source>. <year>2013</year>;<volume>46</volume>:<fpage>42</fpage>&#x02013;<lpage>52</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.eja.2012.12.001">10.1016/j.eja.2012.12.001</ext-link></mixed-citation></ref><ref id="pone.0207624.ref017"><label>17</label><mixed-citation publication-type="journal">
<name><surname>Camps-Valls</surname><given-names>G</given-names></name>, <name><surname>Bruzzone</surname><given-names>L</given-names></name>, <name><surname>Rojo-Rojo</surname><given-names>JL</given-names></name>, <name><surname>Melgani</surname><given-names>F</given-names></name>. <article-title>Robust Support Vector Regression for Biophysical Variable Estimation From Remotely Sensed Images</article-title>. <source>IEEE Geoscience and Remote Sensing Letters</source>. <year>2006</year>;<volume>3</volume>(<issue>3</issue>):<fpage>339</fpage>&#x02013;<lpage>343</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/LGRS.2006.871748">10.1109/LGRS.2006.871748</ext-link></mixed-citation></ref><ref id="pone.0207624.ref018"><label>18</label><mixed-citation publication-type="journal">
<name><surname>Nguyen</surname><given-names>HT</given-names></name>, <name><surname>Kim</surname><given-names>JH</given-names></name>, <name><surname>Nguyen</surname><given-names>AT</given-names></name>, <name><surname>Nguyen</surname><given-names>LT</given-names></name>, <name><surname>Shin</surname><given-names>JC</given-names></name>, <name><surname>Lee</surname><given-names>BW</given-names></name>. <article-title>Using canopy reflectance and partial least squares regression to calculate within-field statistical variation in crop growth and nitrogen status of rice</article-title>. <source>Precision Agriculture</source>. <year>2006</year>;<volume>7</volume>(<issue>4</issue>):<fpage>249</fpage>&#x02013;<lpage>264</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11119-006-9010-0">10.1007/s11119-006-9010-0</ext-link></mixed-citation></ref><ref id="pone.0207624.ref019"><label>19</label><mixed-citation publication-type="journal">
<name><surname>Darvishzadeh</surname><given-names>R</given-names></name>, <name><surname>Skidmore</surname><given-names>A</given-names></name>, <name><surname>Schlerf</surname><given-names>M</given-names></name>, <name><surname>Atzberger</surname><given-names>C</given-names></name>, <name><surname>Corsi</surname><given-names>F</given-names></name>, <name><surname>Cho</surname><given-names>M</given-names></name>. <article-title>LAI and chlorophyll estimation for a heterogeneous grassland using hyperspectral measurements</article-title>. <source>ISPRS Journal of Photogrammetry and Remote Sensing</source>. <year>2008</year>;<volume>63</volume>(<issue>4</issue>):<fpage>409</fpage>&#x02013;<lpage>426</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.isprsjprs.2008.01.001">10.1016/j.isprsjprs.2008.01.001</ext-link></mixed-citation></ref><ref id="pone.0207624.ref020"><label>20</label><mixed-citation publication-type="journal">
<name><surname>Wang</surname><given-names>Fm</given-names></name>, <name><surname>Huang</surname><given-names>Jf</given-names></name>, <name><surname>Lou</surname><given-names>Zh</given-names></name>. <article-title>A comparison of three methods for estimating leaf area index of paddy rice from optimal hyperspectral bands</article-title>. <source>Precision Agriculture</source>. <year>2011</year>;<volume>12</volume>(<issue>3</issue>):<fpage>439</fpage>&#x02013;<lpage>447</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11119-010-9185-2">10.1007/s11119-010-9185-2</ext-link></mixed-citation></ref><ref id="pone.0207624.ref021"><label>21</label><mixed-citation publication-type="journal">
<name><surname>Kiala</surname><given-names>Z</given-names></name>, <name><surname>Odindi</surname><given-names>J</given-names></name>, <name><surname>Mutanga</surname><given-names>O</given-names></name>, <name><surname>Peerbhay</surname><given-names>K</given-names></name>. <article-title>Comparison of partial least squares and support vector regressions for predicting leaf area index on a tropical grassland using hyperspectral data</article-title>. <source>Journal of Applied Remote Sensing</source>. <year>2016</year>;<volume>10</volume>(<issue>3</issue>):<fpage>036015</fpage>
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1117/1.JRS.10.036015">10.1117/1.JRS.10.036015</ext-link></mixed-citation></ref><ref id="pone.0207624.ref022"><label>22</label><mixed-citation publication-type="journal">
<name><surname>Kira</surname><given-names>O</given-names></name>, <name><surname>Nguy-Robertson</surname><given-names>AL</given-names></name>, <name><surname>Arkebauer</surname><given-names>TJ</given-names></name>, <name><surname>Linker</surname><given-names>R</given-names></name>, <name><surname>Gitelson</surname><given-names>AA</given-names></name>. <article-title>Informative spectral bands for remote green LAI estimation in C3 and C4 crops</article-title>. <source>Agricultural and Forest Meteorology</source>. <year>2016</year>;<volume>218-219</volume>:<fpage>243</fpage>&#x02013;<lpage>249</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.agrformet.2015.12.064">10.1016/j.agrformet.2015.12.064</ext-link></mixed-citation></ref><ref id="pone.0207624.ref023"><label>23</label><mixed-citation publication-type="journal">
<name><surname>Yuan</surname><given-names>H</given-names></name>, <name><surname>Yang</surname><given-names>G</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Yu</surname><given-names>H</given-names></name>, <etal>et al</etal>
<article-title>Retrieving Soybean Leaf Area Index from Unmanned Aerial Vehicle Hyperspectral Remote Sensing: Analysis of RF, ANN, and SVM Regression Models</article-title>. <source>Remote Sensing</source>. <year>2017</year>;<volume>9</volume>(<issue>4</issue>):<fpage>309</fpage>
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/rs9040309">10.3390/rs9040309</ext-link></mixed-citation></ref><ref id="pone.0207624.ref024"><label>24</label><mixed-citation publication-type="journal">
<name><surname>Verrelst</surname><given-names>J</given-names></name>, <name><surname>Camps-Valls</surname><given-names>G</given-names></name>, <name><surname>Mu&#x000f1;oz-Mar&#x000ed;</surname><given-names>J</given-names></name>, <name><surname>Rivera</surname><given-names>JP</given-names></name>, <name><surname>Veroustraete</surname><given-names>F</given-names></name>, <name><surname>Clevers</surname><given-names>JGPW</given-names></name>, <etal>et al</etal>
<article-title>Optical remote sensing and the retrieval of terrestrial vegetation bio-geophysical properties&#x02014;A review</article-title>. <source>ISPRS Journal of Photogrammetry and Remote Sensing</source>. <year>2015</year>;<volume>108</volume>:<fpage>273</fpage>&#x02013;<lpage>290</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.isprsjprs.2015.05.005">10.1016/j.isprsjprs.2015.05.005</ext-link></mixed-citation></ref><ref id="pone.0207624.ref025"><label>25</label><mixed-citation publication-type="journal">
<name><surname>Tsai</surname><given-names>F</given-names></name>, <name><surname>Philpot</surname><given-names>W</given-names></name>. <article-title>Derivative Analysis of Hyperspectral Data</article-title>. <source>Remote Sensing of Environment</source>. <year>1998</year>;<volume>66</volume>(<issue>1</issue>):<fpage>41</fpage>&#x02013;<lpage>51</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0034-4257(98)00032-7">10.1016/S0034-4257(98)00032-7</ext-link></mixed-citation></ref><ref id="pone.0207624.ref026"><label>26</label><mixed-citation publication-type="book">
<collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>; <year>2017</year> Available from: <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.r-project.org/</ext-link>.</mixed-citation></ref><ref id="pone.0207624.ref027"><label>27</label><mixed-citation publication-type="journal">
<name><surname>Mevik</surname><given-names>BH</given-names></name>, <name><surname>Wehrens</surname><given-names>R</given-names></name>. <article-title>The pls Package: Principal Component and Partial Least Squares Regression in R</article-title>. <source>Journal of Statistical Software</source>. <year>2007</year>;<volume>18</volume>(<issue>2</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v018.i02">10.18637/jss.v018.i02</ext-link></comment></mixed-citation></ref><ref id="pone.0207624.ref028"><label>28</label><mixed-citation publication-type="journal">
<name><surname>Liaw</surname><given-names>A</given-names></name>, <name><surname>Wiener</surname><given-names>M</given-names></name>. <article-title>Classification and Regression by randomForest</article-title>. <source>R News</source>. <year>2002</year>;<volume>2</volume>(<issue>3</issue>):<fpage>18</fpage>&#x02013;<lpage>22</lpage>.</mixed-citation></ref><ref id="pone.0207624.ref029"><label>29</label><mixed-citation publication-type="journal">
<name><surname>Karatzoglou</surname><given-names>A</given-names></name>, <name><surname>Smola</surname><given-names>A</given-names></name>, <name><surname>Hornik</surname><given-names>K</given-names></name>, <name><surname>Zeileis</surname><given-names>A</given-names></name>. <article-title>kernlab&#x02014;An {S4} Package for Kernel Methods in {R}</article-title>. <source>Journal of Statistical Software</source>. <year>2004</year>;<volume>11</volume>(<issue>9</issue>):<fpage>1</fpage>&#x02013;<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v011.i09">10.18637/jss.v011.i09</ext-link></comment></mixed-citation></ref><ref id="pone.0207624.ref030"><label>30</label><mixed-citation publication-type="other">Chollet F, Allaire JJ, Others. R Interface to Keras; 2017. <ext-link ext-link-type="uri" xlink:href="https://github.com/rstudio/keras">https://github.com/rstudio/keras</ext-link>.</mixed-citation></ref><ref id="pone.0207624.ref031"><label>31</label><mixed-citation publication-type="other">Abadi M, Barham P, Chen J, Chen Z, Davis A, Dean J, et al. TensorFlow: A system for large-scale machine learning. In: 12th USENIX Symposium on Operating Systems Design and Implementation (OSDI 16); 2016. p. 265&#x02013;283.</mixed-citation></ref><ref id="pone.0207624.ref032"><label>32</label><mixed-citation publication-type="journal">
<name><surname>Wold</surname><given-names>S</given-names></name>, <name><surname>Sj&#x000f6;str&#x000f6;m</surname><given-names>M</given-names></name>, <name><surname>Eriksson</surname><given-names>L</given-names></name>. <article-title>PLS-regression: a basic tool of chemometrics</article-title>. <source>Chemometrics and Intelligent Laboratory Systems</source>. <year>2001</year>;<volume>58</volume>(<issue>2</issue>):<fpage>109</fpage>&#x02013;<lpage>130</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0169-7439(01)00155-1">10.1016/S0169-7439(01)00155-1</ext-link></mixed-citation></ref><ref id="pone.0207624.ref033"><label>33</label><mixed-citation publication-type="journal">
<name><surname>Smola</surname><given-names>AJ</given-names></name>, <name><surname>Sch&#x000f6;lkopf</surname><given-names>B</given-names></name>. <article-title>A Tutorial on Support Vector Regression</article-title>. <source>Statistics and Computing</source>. <year>2004</year>;<volume>14</volume>(<issue>3</issue>):<fpage>199</fpage>&#x02013;<lpage>222</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/B:STCO.0000035301.49549.88">10.1023/B:STCO.0000035301.49549.88</ext-link></mixed-citation></ref><ref id="pone.0207624.ref034"><label>34</label><mixed-citation publication-type="journal">
<name><surname>Breiman</surname><given-names>L</given-names></name>. <article-title>Random Forests</article-title>. <source>Machine Learning</source>. <year>2001</year>;<volume>45</volume>(<issue>1</issue>):<fpage>5</fpage>&#x02013;<lpage>32</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/A:1010933404324">10.1023/A:1010933404324</ext-link></mixed-citation></ref><ref id="pone.0207624.ref035"><label>35</label><mixed-citation publication-type="journal">
<name><surname>Atkinson</surname><given-names>PM</given-names></name>, <name><surname>Tatnall</surname><given-names>ARL</given-names></name>. <article-title>Introduction neural networks in remote sensing</article-title>. <source>International Journal of Remote Sensing</source>. <year>1997</year>;<volume>18</volume>(<issue>4</issue>):<fpage>699</fpage>&#x02013;<lpage>709</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/014311697218700">10.1080/014311697218700</ext-link></mixed-citation></ref><ref id="pone.0207624.ref036"><label>36</label><mixed-citation publication-type="journal">
<name><surname>Gong</surname><given-names>Peng</given-names></name>, <name><surname>Ruiliang</surname><given-names>Pu</given-names></name>, <name><surname>Biging</surname><given-names>GS</given-names></name>, <name><surname>Larrieu</surname><given-names>MR</given-names></name>. <article-title>Estimation of forest leaf area index using vegetation indices derived from hyperion hyperspectral data</article-title>. <source>IEEE Transactions on Geoscience and Remote Sensing</source>. <year>2003</year>;<volume>41</volume>(<issue>6</issue>):<fpage>1355</fpage>&#x02013;<lpage>1362</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TGRS.2003.812910">10.1109/TGRS.2003.812910</ext-link></mixed-citation></ref><ref id="pone.0207624.ref037"><label>37</label><mixed-citation publication-type="journal">
<name><surname>Tanaka</surname><given-names>S</given-names></name>, <name><surname>Kawamura</surname><given-names>K</given-names></name>, <name><surname>Maki</surname><given-names>M</given-names></name>, <name><surname>Muramoto</surname><given-names>Y</given-names></name>, <name><surname>Yoshida</surname><given-names>K</given-names></name>, <name><surname>Akiyama</surname><given-names>T</given-names></name>. <article-title>Spectral Index for Quantifying Leaf Area Index of Winter Wheat by Field Hyperspectral Measurements: A Case Study in Gifu Prefecture, Central Japan</article-title>. <source>Remote Sensing</source>. <year>2015</year>;<volume>7</volume>(<issue>5</issue>):<fpage>5329</fpage>&#x02013;<lpage>5346</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/rs70505329">10.3390/rs70505329</ext-link></mixed-citation></ref><ref id="pone.0207624.ref038"><label>38</label><mixed-citation publication-type="journal">
<name><surname>Cho</surname><given-names>MA</given-names></name>, <name><surname>Skidmore</surname><given-names>A</given-names></name>, <name><surname>Corsi</surname><given-names>F</given-names></name>, <name><surname>van Wieren</surname><given-names>SE</given-names></name>, <name><surname>Sobhan</surname><given-names>I</given-names></name>. <article-title>Estimation of green grass/herb biomass from airborne hyperspectral imagery using spectral indices and partial least squares regression</article-title>. <source>International Journal of Applied Earth Observation and Geoinformation</source>. <year>2007</year>;<volume>9</volume>(<issue>4</issue>):<fpage>414</fpage>&#x02013;<lpage>424</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jag.2007.02.001">10.1016/j.jag.2007.02.001</ext-link></mixed-citation></ref><ref id="pone.0207624.ref039"><label>39</label><mixed-citation publication-type="journal">
<name><surname>Yao</surname><given-names>X</given-names></name>, <name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Shang</surname><given-names>G</given-names></name>, <name><surname>Zhou</surname><given-names>C</given-names></name>, <name><surname>Cheng</surname><given-names>T</given-names></name>, <name><surname>Tian</surname><given-names>Y</given-names></name>, <etal>et al</etal>
<article-title>Evaluation of six algorithms to monitor wheat leaf nitrogen concentration</article-title>. <source>Remote Sensing</source>. <year>2015</year>;<volume>7</volume>(<issue>11</issue>):<fpage>14939</fpage>&#x02013;<lpage>14966</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/rs71114939">10.3390/rs71114939</ext-link></mixed-citation></ref><ref id="pone.0207624.ref040"><label>40</label><mixed-citation publication-type="journal">
<name><surname>Gnyp</surname><given-names>ML</given-names></name>, <name><surname>Miao</surname><given-names>Y</given-names></name>, <name><surname>Yuan</surname><given-names>F</given-names></name>, <name><surname>Ustin</surname><given-names>SL</given-names></name>, <name><surname>Yu</surname><given-names>K</given-names></name>, <name><surname>Yao</surname><given-names>Y</given-names></name>, <etal>et al</etal>
<article-title>Hyperspectral canopy sensing of paddy rice aboveground biomass at different growth stages</article-title>. <source>Field Crops Research</source>. <year>2014</year>;<volume>155</volume>(<issue>JANUARY 2014</issue>):<fpage>42</fpage>&#x02013;<lpage>55</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.fcr.2013.09.023">10.1016/j.fcr.2013.09.023</ext-link></mixed-citation></ref><ref id="pone.0207624.ref041"><label>41</label><mixed-citation publication-type="journal">
<name><surname>Wei</surname><given-names>C</given-names></name>, <name><surname>Huang</surname><given-names>J</given-names></name>, <name><surname>Mansaray</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>Z</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>Han</surname><given-names>J</given-names></name>. <article-title>Estimation and Mapping of Winter Oilseed Rape LAI from High Spatial Resolution Satellite Data Based on a Hybrid Method</article-title>. <source>Remote Sensing</source>. <year>2017</year>;<volume>9</volume>(<issue>5</issue>):<fpage>488</fpage>
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/rs9050488">10.3390/rs9050488</ext-link></mixed-citation></ref><ref id="pone.0207624.ref042"><label>42</label><mixed-citation publication-type="journal">
<name><surname>LI</surname><given-names>Zw</given-names></name>, <name><surname>XIN</surname><given-names>Xp</given-names></name>, <name><surname>TANG</surname><given-names>H</given-names></name>, <name><surname>YANG</surname><given-names>F</given-names></name>, <name><surname>CHEN</surname><given-names>Br</given-names></name>, <name><surname>ZHANG</surname><given-names>Bh</given-names></name>. <article-title>Estimating grassland LAI using the Random Forests approach and Landsat imagery in the meadow steppe of Hulunber, China</article-title>. <source>Journal of Integrative Agriculture</source>. <year>2017</year>;<volume>16</volume>(<issue>2</issue>):<fpage>286</fpage>&#x02013;<lpage>297</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S2095-3119(15)61303-X">10.1016/S2095-3119(15)61303-X</ext-link></mixed-citation></ref><ref id="pone.0207624.ref043"><label>43</label><mixed-citation publication-type="journal">
<name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>R</given-names></name>, <name><surname>Zhang</surname><given-names>A</given-names></name>, <name><surname>Yang</surname><given-names>S</given-names></name>, <name><surname>Liu</surname><given-names>H</given-names></name>, <etal>et al</etal>
<article-title>Biochar amendment reduces paddy soil nitrogen leaching but increases net global warming potential in Ningxia irrigation, China</article-title>. <source>Scientific Reports</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>&#x02013;<lpage>10</lpage>.<pub-id pub-id-type="pmid">28127051</pub-id></mixed-citation></ref></ref-list></back></article>