<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Commun Biol</journal-id><journal-id journal-id-type="iso-abbrev">Commun Biol</journal-id><journal-title-group><journal-title>Communications Biology</journal-title></journal-title-group><issn pub-type="epub">2399-3642</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6160469</article-id><article-id pub-id-type="publisher-id">159</article-id><article-id pub-id-type="doi">10.1038/s42003-018-0159-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>2D association and integrative omics analysis in rice provides systems biology view in trait analysis</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Wenchao</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Dai</surname><given-names>Xinbin</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6789-6655</contrib-id><name><surname>Xu</surname><given-names>Shizhong</given-names></name><address><phone>+1-951-827-5898</phone><email>shizhong.xu@ucr.edu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3460-5564</contrib-id><name><surname>Zhao</surname><given-names>Patrick X.</given-names></name><address><phone>+1-580-224-6725</phone><email>pzhao@noble.org</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0370 5663</institution-id><institution-id institution-id-type="GRID">grid.419447.b</institution-id><institution>Computational Biology and Bioinformatics Lab, </institution><institution>Noble Research Institute, </institution></institution-wrap>Ardmore, OK 73401 USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2222 1582</institution-id><institution-id institution-id-type="GRID">grid.266097.c</institution-id><institution>Department of Botany and Plant Sciences, </institution><institution>University of California, </institution></institution-wrap>Riverside, CA 92521 USA </aff></contrib-group><pub-date pub-type="epub"><day>27</day><month>9</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>27</day><month>9</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>1</volume><elocation-id>153</elocation-id><history><date date-type="received"><day>19</day><month>2</month><year>2018</year></date><date date-type="accepted"><day>30</day><month>8</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">The interactions among genes and between genes and environment contribute significantly to the phenotypic variation of complex traits and may be possible explanations for missing heritability. However, to our knowledge&#x000a0;no existing tool can address the two kinds of interactions. Here we propose a novel linear mixed model that considers not only the additive effects of biological markers but also the interaction effects of marker pairs. Interaction effect is demonstrated as a 2D association. Based on this linear mixed model, we developed a pipeline, namely PATOWAS. PATOWAS can be used to study transcriptome-wide and metabolome-wide associations in addition to genome-wide associations. Our case analysis with real rice recombinant inbred lines (RILs) at three omics levels demonstrates that 2D association mapping and integrative omics are able to provide a systems biology view into the analyzed traits, leading toward an answer about how genes, transcripts, proteins, and metabolites work together to produce an observable phenotype.</p></abstract><abstract id="Abs2" abstract-type="web-summary"><p id="Par2">Wenchao Zhang et al. developed a tool for analyzing traits using data generated from genome-wide, transcriptome-wide, and metabolome-wide association studies. They test their approach in rice, providing a systems biology view of identified traits.</p></abstract><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000001</institution-id><institution>National Science Foundation (NSF)</institution></institution-wrap></funding-source><award-id>DBI-1458515</award-id><award-id>DBI-1458597</award-id><principal-award-recipient><name><surname>Xu</surname><given-names>Shizhong</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">Trait analysis, especially genome-wide trait analysis, is centered on how genetic variation gives rise to phenotypic variation<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. This type of analysis relies on statistical methods and tools to perform association mapping between causal genetic variants and resulting phenotypes, which can determine the heritability of a trait at a subset of genetic variants (typically referred to as single-nucleotide polymorphisms, or SNPs) and delineate regions of the genome that control the trait, thereby providing markers that can be utilized to accelerate breeding by marker-assisted selection<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. Because of the great success of genome-wide association studies (GWAS), hundreds of SNPs conferring genetic variation of complex traits have been identified and reported<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. However, the genetic structures of most traits remain unexplained, as associated SNPs detected from GWAS explain only a small fraction of heritability (e.g., &#x0003c;40% in schizophrenia studies)<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> and a much smaller percentage of the total phenotypic variance. This is mainly because a number of these studies employed only additive models that fail to account for epistasis, or the interaction between multiple loci and the environment<sup><xref ref-type="bibr" rid="CR4">4</xref>&#x02013;<xref ref-type="bibr" rid="CR6">6</xref></sup>.</p><p id="Par4">Xu et al.<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> proposed a new linear mixed model (LMM) for mapping quantitative loci (QTL) by incorporating multiple polygenic covariance structures. Based on this model, a pipeline for estimating epistatic effects (PEPIS) was developed to comprehensively estimate additive effects, dominance effects, and interaction effects between multiple genetic loci. PEPIS allows analysis of genome-wide genetic architectures, including genotype interaction effects (GxG), and can thereby explain more than 80% of phenotypic variance<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>.</p><p id="Par5">Compared with standard GWAS tools that consider only additive effects, the PEPIS pipeline is equipped with a more complex polygenic linear model that can explain more phenotypic variance. However, neither of these methods can explain nearly 100% of phenotypic variance, as neither considers the interaction between genotypes and environments (GxE). Today, the predominant thinking in biology is that the orchestrated expression of many genes in different environmental conditions affects the transcriptome, proteome, and metabolome to produce a final observable phenotype<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Recent work in <italic>Saccharomyces cerevisiae</italic> suggests that GxE can occur at the individual locus level and the group level for multiple loci, leading to environment-dependent epistatic interactions<sup><xref ref-type="bibr" rid="CR10">10</xref>&#x02013;<xref ref-type="bibr" rid="CR12">12</xref></sup>. Although Muir et al.<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> conceptualized the partitioning of GxE into two possible interaction types, our mathematical understanding of the genetic and molecular mechanisms by which GxE collectively gives rise to phenotypes is still incomplete<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>.</p><p id="Par6">The central dogma of biology is that the genome, transcriptome, proteome, and metabolome are cascading and connected to the end phenome<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. The development of life science technologies enables transcriptomic, proteomic, and metabolomic events to be analyzed in detail within the same biological system, allowing the systematic study of a complete biological system<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Out of all the omic data from the same biological system, genomic data generally remain constant across environments, although the same genotype subjected to different environments can produce a wide range of phenotypes by triggering the expressions of different genes, downstream enzymes, and metabolites<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. Most current association methods and analysis tools perform association mapping based on fundamental relationships between DNA sequence variation and phenotypic variation without addressing environmental variation. GxE can be understood by observing and measuring the expression of genes or metabolites. Harper et al.<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> developed an associative transcriptomic approach to study complex traits in the polyploidy crop species <italic>Brassica napus</italic> by correlating trait variation with the quantitative expression of genes and sequence variation of transcripts, with the consistent physical positions of the two kinds of associative markers allowing the identification of high-confidence transcription factor candidates<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>. However, their method is based on a pure additive model only, and they make no mention of interaction effects between biomarkers or their contribution to phenotypic variation.</p><p id="Par7">To overcome the limitation of standard GWAS that fails to consider the GxG and GxE effects, we extend associative genomics and transcriptomics into a broader associative omics by systematically integrating all available omic data into one analytical model. Here we propose a new LMM and describe the development of a pipeline for analyzing traits through ome-wide association studies (PATOWAS) to implement the model. The proposed LMM considers not only the additive effects of each biological marker but also the interaction effect of each marker pair. The marker pairs&#x02019; interaction effect introduced here corresponds to two-dimensional (2D) association mapping, which is complementary to one-dimensional (1D) association mapping in regular GWAS. Consequently, the proposed model and PATOWAS pipeline are not limited to GWAS for genotype-to-phenotype mapping (G2P); instead, they are capable of performing multiple types of ome-wide association studies, such as transcriptome-wide association studies (TWAS) for transcript-to-phenotype mapping (T2P) and metabolome-wide association studies (MWAS) for metabolite-to-phenotype mapping (M2P).</p><p id="Par8">We submit a rice recombinant inbred line (RIL) dataset with three omics markers and two agronomic traits to PATOWAS for comprehensive analyses of associative omics. The results demonstrate that our proposed LMM and the pipeline PATOWAS can effectively address the GxG effect and the GxE effect, perform multiple-level associative omics in one platform, and innovatively provide a systems biology view into the traits analyzed.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Associative omics, PATOWAS, and integrative omics</title><p id="Par9">We aimed to systematically integrate multiple associative omic results to provide more biological insights into the phenotypic traits to be analyzed. We first collected a dataset of 210 rice RILs genotyped with 1619 marker bins, profiled with 22,584 transcripts and 1000 metabolites, and phenotyped with two agronomic traits (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). The phenotypic traits (Supplementary Data&#x000a0;<xref rid="MOESM3" ref-type="media">1</xref>&#x02013;<xref rid="MOESM4" ref-type="media">2</xref>) were yield (YIELD) and (kilo-) thousand grain weight (KGW), and the omic quantitative markers (Supplementary Data&#x000a0;<xref rid="MOESM5" ref-type="media">3</xref>&#x02013;<xref rid="MOESM7" ref-type="media">5</xref>) were bin-based genotype data, Affymetrix RNA microarray-based gene expression data, and mass spectrometry-based profiling of metabolite abundance data. We presumed that expressed transcripts, proteins, and metabolites are prone to vary when subjected to the environments, while the genetic variants are considerably stable. Therefore, compared with genome-wide genotypic data, we further presumed that measured gene expression and metabolite abundance contain both gene and environment information and expect that associative transcriptomics (T2P or TWAS) or metabolomics (M2P or MWAS) could explain more phenotypic variance (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of phenotypic trait data and omic marker data</p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="2">Trait data (1D vector)</th><th colspan="3">Omics marker data (2D matrix)</th></tr></thead><tbody><tr><td>YIELD</td><td>KGW</td><td>Binned genotype</td><td>Expression gene transcript</td><td>Metabolite abundance</td></tr><tr><td>210&#x02009;&#x000d7;&#x02009;1</td><td>210&#x02009;&#x000d7;&#x02009;1</td><td>1619&#x02009;&#x000d7;&#x02009;210</td><td>22,584&#x02009;&#x000d7;&#x02009;210</td><td>1000&#x02009;&#x000d7;&#x02009;210</td></tr></tbody></table></table-wrap></p><p id="Par10">Motivated by our consideration of genetic epistasis and our desire to explain more phenotypic variance, we next proposed a statistical LMM that considers not only the additive effects of each marker variant but also the interaction effects of each marker pair. Based on this linear model, we developed a PATOWAS pipeline to analyze traits through multiple ome-wide association studies. Therefore, the proposed model and PATOWAS can be used to study not only GWAS for G2P but also TWAS for T2P and MWAS for M2P, which is progress toward an integrative omics (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Biological concept of the PATOWAS pipeline and biological insight of an example association mapping resulting from PATOWAS. <bold>a</bold> Three types of omic markers to phenotype association mappings, e.g., (1) genome-wide sequence/genotype variation to phenotypic variation mapping (G2P or GWAS), (2) transcriptome-wide gene expression variation to phenotypic variation mapping (T2P or TWAS), and (3) metabolome-wide metabolite abundance variation to phenotypic variation mapping (M2P or MWAS), can be analyzed using the unified linear mixed model in PATOWAS. <bold>b</bold> PATOWAS needs 2D omics marker matrix data and 1D phenotypic trait data as input. Specific PATOWAS results include (1) variance component analysis result showing two biologically meaningful components: additive, additive&#x02013;additive, and residual; (2) 1D association mapping for the Additive component; and (3) 2D association mapping for the Additive&#x02013;Additive component, and further, the significant omics marker pairs extracted by thresholding</p></caption><graphic xlink:href="42003_2018_159_Fig1_HTML" id="d29e436"/></fig></p><p id="Par11">To test this presumption and verify our consideration, we used PATOWAS to analyze the rice RIL datasets with two agronomic traits and three different omics markers. PATOWAS accepts 2D omics marker matrix data and 1D phenotypic trait data as inputs (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>). PATOWAS results for one specific associative omics mainly include three parts: variance component analysis for the partition of phenotypic variance, a 1D association map for the direct biological markers, and a 2D association map for the interaction of biological marker pairs (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>). Of the three variance components, the additive component for the markers&#x02019; direct effects and the additive&#x02013;additive component for the marker pairs&#x02019; interaction effects are biologically meaningful and can be explained by the linear model. The higher the sum of the two components, the lower the residual component and the more phenotypic variance can be explained by the model. Of all markers&#x02019; and marker pairs&#x02019; effects, those with higher &#x02212;log<sub>10</sub>(<italic>p</italic>) values indicate markers or marker pairs that are more relevant to the phenotypic trait.</p><p id="Par12">In the present study, we sequentially submitted three omic marker datasets to PATOWAS to analyze the two field traits, YIELD and KGW. We downloaded the results after completion of the analyses. Based on these results, multiple associative omics and the biological insight can be compared and integrated. For example, the combination of 1D association mapping across G2P and T2P can help identify the genotype and expressed gene transcript markers with consistent physical positions; comparison of the metabolites from 1D M2P association mapping can uncover the biochemical relevance of tissue-specific metabolites and traits to be analyzed; and the investigation of major biomarker pairs from 2D association mapping can be used to build an association network. All these together provide a systems biology view into the analyzed traits, leading toward an answer about how genes, transcripts, proteins, and metabolites work together to produce an observable phenotype.</p></sec><sec id="Sec4"><title>Variance component analysis</title><p id="Par13">Based on the variance component analysis results, we generated six pie charts displaying the three variance components of the two traits across associative genomics, associative transcriptomics, and associative metabolomics (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Pie chart illustrations of variance component analysis results for traits YIELD (<bold>a</bold>) and KGW (<bold>b</bold>) across associative genomics, transcriptomics, and metabolomics. Three components in each pie chart are colored with blue, brown, and yellow and represent the three estimated variance ratios of additive, additive&#x02013;additive, and residual, respectively</p></caption><graphic xlink:href="42003_2018_159_Fig2_HTML" id="d29e475"/></fig></p><p id="Par14">We found that the two biologically meaningful variance components accounted for nearly all of the phenotypic trait variance in associative transcriptomics and associative metabolomics but not in associative genomics. Also, YIELD was a more complex trait than KGW, as the two biologically meaningful variance components accounted for only 66% of the total phenotypic variance in associative genomics but nearly 100% of the total phenotypic variance in associative transcriptomics and metabolomics (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>). These findings demonstrate that a chain of environmentally responsive genes and metabolites can be observed and explained at the transcriptomic and metabolomic levels but not at the genomic level.</p><p id="Par15">Here we noticed that the marker number for transcripts was obviously one-order of scale higher than the other two. Consider the marker-by-marker interactions: The pairwise number of transcripts will reach to ~250 million, which is about two-order of scale larger than the other two kinds of omic markers.</p><p id="Par16">To test whether the higher ratio of biological explanatory components observed in the TWAS result is not due to the larger numbers of transcripts used in TWAS, we further produced a reduced transcript gene set with a number scale comparable to the genotypes and metabolites. We separately submitted the reduced transcript gene set to PATOWAS and checked the variance component analysis result.</p><p id="Par17">The procedures to generate a reduced gene set are described as follows: First we mapped the 22,584 transcript genes into the 1619 genotype bins (Supplementary Data&#x000a0;<xref rid="MOESM8" ref-type="media">6</xref>); one genotype bin may contain none to hundreds of transcript genes. Based on the 1D association mapping result, at most only one representative transcript in one bin was selected. We chose the transcript with the highest &#x02212;log<sub>10</sub>(<italic>p</italic>) as the representative transcript of a genotype bin. Then we generated a reduced transcript gene set for each phenotypic trait, which essentially is a data matrix with a dimension of 1543&#x02009;&#x000d7;&#x02009;210 (Supplementary Data&#x000a0;<xref rid="MOESM9" ref-type="media">7</xref>&#x02013;<xref rid="MOESM10" ref-type="media">8</xref>). Its number of markers was comparable to those in the analyzed genotypes and metabolites. The same approaches were also used to generate two positional comparable 1D G2P and T2P association mapping results in the following section.</p><p id="Par18">We submitted the reduced transcript data and the two phenotypic traits, KGW and YIELD, to PATOWAS for further study. Based on the variance component analysis results, two additional pie charts displaying the three variance components of the two traits in associative transcriptomics were plotted (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>). Again, we observed that the two biologically meaningful components explained nearly 100% of the phenotypic variance, with only a fluctuation between the two components. Thus, we conclude that the much larger numbers of transcripts used in TWAS is not the reason for the higher explanatory ratio of phenotypic variance in associative transcriptomics.</p><p id="Par19">Our proposed LMM involve two biologically meaningful variance components: <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\mathrm {a}}^2$$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\mathrm {aa}}^2$$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq2.gif"/></alternatives></inline-formula>. To measure the portion of phenotypic variance that can be explained by the model, we define the broad-sense heritability by<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H = \frac{{\sigma _{\mathrm {a}}^2 + \sigma _{\mathrm {aa}}^2}}{{\sigma _{\mathrm {a}}^2 + \sigma _{\mathrm {aa}}^2 + \sigma ^2}}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="42003_2018_159_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par20">Modern GWAS application often involves a panel with hundreds of thousands, or even millions, of genetic variants under only several hundred individual samples<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. The statistical modeling of such cases is usually challenging because the sample size is substantially smaller than the number of covariates. This is well-known as a &#x0201c;large <italic>p</italic> small <italic>n</italic>&#x0201d; problem<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> and requires careful assessment of the statistical characteristics<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>.</p><p id="Par21">Our proposed method really can explain more of phenotypic variance, but the cost is that it generates a large number of pairwise covariates. Therefore, it is worthwhile to assess the heritability of the proposed LMM, particularly at the high-dimensional data.</p><p id="Par22">First, the predictability<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> that is represented by the squared correlation coefficient between the observed and predicted phenotypic value was applied. The squared correlation is approximately equal to <italic>R</italic><sup>2</sup>&#x02009;=&#x02009;1&#x02212;PRESS/SS, where PRESS is the predicted residual error sum of squares and SS is the total sum of squares of the phenotypic values. In principle, we treated each transcript or metabolite marker as an intermediate phenotypic trait and predicated all of these intermediated phenotypic values from all the genotypic data. Therefore, each transcript or metabolite will have an <italic>R</italic><sup>2</sup> value, predictability (PRED). We then used the HAT method<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> to calculate the PREDs for all transcripts and metabolites (Supplementary Data&#x000a0;<xref rid="MOESM11" ref-type="media">9</xref>&#x02013;<xref rid="MOESM12" ref-type="media">10</xref>), applied a series of variable thresholds to the PREDs, and selected the transcript and metabolite markers. Finally, we submitted the subsets of selected transcript genes and metabolites to PATOWAS for variance component analysis and calculated the broad-sense heritability, <italic>H</italic>. Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> shows the assessment result of the broad-sense heritability (<italic>H</italic>) with the selected markers by PRED thresholding. We found that the number of selected markers continued decreasing as the PRED threshold increased; however, the broad-sense <italic>H</italic> provides us with a very different perspective of different traits and different associative omics. It needs only ~1000 and fewer than 100 transcripts to explain more than 97% of the phenotypic variance in traits YIELD and KGW, respectively. In associative metabolomics, only 30 metabolites are enough to explain more than 90% of the phenotypic variance. In general, trait KGW is more conserved than trait YIELD, and associative metabolomics is more conserved than associative transcriptomics.<fig id="Fig3"><label>Fig. 3</label><caption><p>The assessment of broad-sense heritability (<italic>H</italic>) with the selected markers after PRED thresholding. <bold>a</bold> and <bold>b</bold>
<italic>H</italic> vs. PRED threshold for trait YIELD and trait KGW in associative transcriptomics. <bold>c</bold> The numbers of selected transcript markers with the applied PRED thresholds. <bold>d</bold> and <bold>e</bold>
<italic>H</italic> vs. PRED threshold for trait YIELD and trait KGW in associative metabolomics. <bold>f</bold> The numbers of selected metabolite markers with the applied PRED thresholds</p></caption><graphic xlink:href="42003_2018_159_Fig3_HTML" id="d29e712"/></fig></p><p id="Par23">Variance component analysis provides us with a big picture by partitioning the phenotypic variation into three components. The two biologically meaningful components for individual markers&#x02019; direct effects and the marker pairs&#x02019; interaction effects can be further illustrated by 1D and 2D association mapping, respectively.</p></sec><sec id="Sec5"><title>1D association mapping</title><p id="Par24">1D association mappings from PATOWAS across different associative omics can be combined, integrated, and compared, providing biological insights in trait analysis on both system and molecular biology levels.</p></sec><sec id="Sec6"><title>Consistency of 1D G2P mapping using PATOWAS and other GWAS tools</title><p id="Par25">Conventional GWAS tools such as TASSEL<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, GCTA<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, and PLINK<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> can build associations between genotypes and phenotypes by calculating and outputting a <italic>p-</italic>value or &#x02212;log<sub>10</sub>(<italic>p</italic>) value for each genotypic marker. The linear model adopted usually considers only the marker&#x02019;s direct effect, which is mostly additive. This process essentially is 1D association mapping. PATOWAS is based on our proposed LMM, which considers not only the additive effect for each marker but also the additive&#x02009;&#x000d7;&#x02009;additive interaction effect for each marker pair. Therefore, PATOWAS calculates and outputs a <italic>p-</italic>value for each marker and a <italic>p-</italic>value for each marker pair, which essentially provides both 1D and 2D association mapping.</p><p id="Par26">Regarding G2P mapping, 1D association mapping using PATOWAS can be compared with other GWAS tools<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. We submitted the same RIL rice genotype and two phenotypic trait data to PATOWAS and TASSEL. We compared the 1D <italic>p-</italic>values returned from both tools and found that the results are very consistent. The Manhattan and Q&#x02013;Q plots using the same genotype and phenotypic trait data from PATOWAS and TASSEL are illustrated in Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref>.</p></sec><sec id="Sec7"><title>Positional alignment and molecular validation across 1D G2P and T2P mapping</title><p id="Par27">Harper et al.<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> developed an associative transcriptomic approach to analyzing traits of the polyploid crop <italic>B. napus</italic>. Their method combines SNP-based and gene expression-based association results to identify high-confidence transcription factor candidates. As mentioned before, the 1D <italic>p-</italic>values returned from PATOWAS correspond to the additive effects for the individual markers, and can be used to generate a 1D Manhattan plot. To generate comparable plots between associated genotypic markers and transcript gene markers along their chromosomal position, we first mapped transcript genes to genotype bins and then selected the minimum <italic>p-</italic>value as the representative <italic>p-</italic>value of a bin (Supplementary Data&#x000a0;<xref rid="MOESM8" ref-type="media">6</xref>). This mapping process between genotype bins and transcript genes ensured that there would be 1619 <italic>p</italic>-values for the two associative omic markers, making it possible to generate aligned 1D plots of &#x02212;log<sub>10</sub>(<italic>p</italic>) values along the markers&#x02019; chromosomal positions.</p><p id="Par28">We could easily find the positional consistency between genotype and expressed gene markers (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). For YIELD, there was one local maximum region matched between G2P and T2P located in chromosome 1 and bounded with two red lines (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4a</xref>). By contrast, for KGW, most local maximum regions were matched between G2P and T2P (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4b</xref>). Therefore, as KGW is a more specific trait that is less affected by external environmental factors than YIELD, its high genotype variation regions always correspond to high gene expression variation regions pinpointed with high &#x02212;log<sub>10</sub>(<italic>p</italic>) values in both G2P and T2P.<fig id="Fig4"><label>Fig. 4</label><caption><p>Illustration of the chromosomal position consistency between genomics and transcriptomic markers. <bold>a</bold> Aligning the 1D G2P and T2P association mapping for trait YIELD. <bold>b</bold> Aligning the 1D G2P and T2P association mapping for trait KGW. The maximum &#x02212;log<sub>10</sub>(<italic>p</italic>) value among the multiple expressed transcript genes in a genotype bin was selected as the representative &#x02212;log<sub>10</sub>(<italic>p</italic>) value. Dashed lines distinguish the 12 chromosomes and corresponding marker/bin numbers for the complete rice genome. Chromosomal position consistency between G2P and T2P is presented, and the matched local maximum regions are bounded with two red lines</p></caption><graphic xlink:href="42003_2018_159_Fig4_HTML" id="d29e845"/></fig></p><p id="Par29">According to the &#x02212;log<sub>10</sub>(<italic>p</italic>) values, we focused on trait YIELD and picked up the top 10 transcript gene markers for a deep molecular function investigation. The top 10 transcript gene markers are distinguished with a unique index and can be identified by its gene locus ID. Through a literature search, we found that at least five of the top 10 transcript markers have been reported to biologically affect rice YIELD (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). For example, marker T_2925 (<italic>LOC_Os01g62860</italic>) was reported to be related to seed shattering<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>; marker T_3229 (<italic>LOC_Os01g67580</italic>) was reported to be related to drug resistance<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>; and markers T_6368 (<italic>LOC_Os03g03070</italic>) and T_13429 (<italic>LOC_Os06g11330</italic>) were reported to control or delay flowering time<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR30">30</xref></sup>. Marker T_11921 (<italic>LOC_Os05g31040</italic>) in particular acquired the highest significance value (&#x02212;log<sub>10</sub>(<italic>p</italic>)&#x02009;=&#x02009;7.53) and was reported as the CKX9 plant hormone gene that could lead to the accumulation of cytokinin and the increased tiller number<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>. All these literature-validated gene markers demonstrate that our PATOWAS has the capability to perform trusted association mapping between causal expressed transcript variants and the resulting phenotypes. We annotated and marked these five genes to the 1D T2P association mapping plot and found that most of them belong to high association peaks (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>). The aims of associative genomics or transcriptomics are to find the genetic variants or expressed transcript variant, which can obviously affect the phenotypic trait. Therefore, the high genotype variation or high gene expression variation regions warrant further study. For YIELD, there is only one obvious consistent matched region between G2P and T2P, and it falls into the surroundings of markers T_2925 and T_3229. However, other transcript gene markers, such as T_11921 with its highest significance value of 7.5309, do not fall into the high genotype variation region (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>, Region C). Therefore, we could conclude that PATOWAS and the associative transcriptomics capture not only the inheritable genetic information from the genome but also the intermediated environmental information at the transcriptome level.</p></sec><sec id="Sec8"><title>1D M2P association mapping and comparison of metabolite markers between leaf and seed</title><p id="Par30">In the present study, we used PATOWAS to analyze the association of 1000 metabolites with traits YIELD and KGW and then plotted the 1D M2P association results across individual metabolites (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Illustration of the 1D M2P association mapping results. Scatter plot of the 1D M2P association mapping for traits YIELD (<bold>a</bold>) and KGW (<bold>b</bold>). The M2P analysis in this study includes 683 leaf metabolites and 317 seed metabolites, and the two kinds of metabolites are colored with blue and red in the two scatter plots. A tentative significance threshold bar (&#x02212;log<sub>10</sub>(<italic>p</italic>)&#x02009;=&#x02009;3.0) is set up to show the relevance of the metabolite markers with the phenotypic trait</p></caption><graphic xlink:href="42003_2018_159_Fig5_HTML" id="d29e936"/></fig></p><p id="Par31">In genetic association analysis, determining the correct <italic>p-value</italic> threshold is always critical and subjective<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. To tell a methodology story, we tentatively set the threshold as <italic>p</italic>&#x02009;=&#x02009;0.001, and the metabolite marker could be considered significant if <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$- {\mathrm {log}}_{10}(p) \ge 3.0$$\end{document}</tex-math><mml:math id="M8"><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mn>3.0</mml:mn></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq3.gif"/></alternatives></inline-formula>. Obviously, we could observe that there were more significant (&#x02212;log<sub>10</sub>(<italic>p</italic>)&#x02009;&#x02265;&#x02009;3.0) metabolite markers from leaf than from seed for YIELD (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5a</xref>), whereas there were more significant (&#x02212;log<sub>10</sub>(<italic>p</italic>)&#x02009;&#x02265;&#x02009;3.0) metabolite markers from seed than from leaf for KGW (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5b</xref>).</p><p id="Par32">Further, we picked up variable top <italic>n</italic> significant metabolite markers from the total 1000 metabolites and classified them as metabolites from leaf and seed. Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> gives the relationship of the variable top <italic>n</italic> with the number of significant (&#x02212;log<sub>10</sub>(<italic>p</italic>)&#x02009;&#x02265;&#x02009;Significance_Th) leaf and seed metabolites. Considering that there are 683 and 317 metabolites from leaf and seed, respectively, we set 0.683 and 0.317 as two meaningful ratio thresholds for significant metabolites from leaf and seed. From Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>, we found that (1) for YIELD, when top <italic>n</italic>&#x02009;&#x0003c;&#x02009;25, significant leaf metabolites against total top <italic>n</italic> metabolites always have a ratio higher than 0.683; and (2) for KGW, when top <italic>n</italic>&#x02009;&#x0003c;&#x02009;500, the significant seed metabolites against the total top <italic>n</italic> metabolites usually produce a ratio higher than 0.317.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Summary of variable top <italic>n</italic> significant (&#x02212;log<sub>10</sub>(<italic>p</italic>)&#x02009;&#x02265;&#x02009;Significance_Th) metabolites from leaf and seed across two traits</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Top#</th><th colspan="3">YIELD</th><th colspan="3">KGW</th></tr><tr><th/><th>Significance_Th</th><th>No. of leaf metabolites</th><th>No. of seed Metabolites</th><th>Significance_Th</th><th>No. of leaf metabolites</th><th>No. of seed metabolites</th></tr></thead><tbody><tr><td>5</td><td>3.0904</td><td>4</td><td>1</td><td>3.9283</td><td>1</td><td>4</td></tr><tr><td>10</td><td>2.8044</td><td>9</td><td>1</td><td>3.2709</td><td>3</td><td>7</td></tr><tr><td>15</td><td>2.5274</td><td>12</td><td>3</td><td>3.0274</td><td>4</td><td>11</td></tr><tr><td>20</td><td>2.4269</td><td>15</td><td>5</td><td>2.8044</td><td>5</td><td>15</td></tr><tr><td>25</td><td>2.2298</td><td>17</td><td>8</td><td>2.5503</td><td>9</td><td>16</td></tr><tr><td>30</td><td>2.1278</td><td>19</td><td>11</td><td>2.3214</td><td>11</td><td>19</td></tr><tr><td>50</td><td>1.6936</td><td>33</td><td>17</td><td>2.0310</td><td>22</td><td>28</td></tr><tr><td>100</td><td>1.2402</td><td>64</td><td>36</td><td>1.4739</td><td>49</td><td>51</td></tr><tr><td>200</td><td>0.8616</td><td>134</td><td>66</td><td>0.9114</td><td>110</td><td>90</td></tr><tr><td>500</td><td>0.3310</td><td>333</td><td>167</td><td>0.3669</td><td>312</td><td>188</td></tr></tbody></table></table-wrap></p><p id="Par33">All these results suggest that leaf metabolites are more relevant to YIELD, while seed metabolites are more relevant to KGW, which is consistent with the findings of Xu et al.<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. This could be explained by the fact that the photosynthesis process takes place mainly in leaf tissue and is the main factor determining rice yield<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>.</p><p id="Par34">Further, we focused on the top 10 significant metabolites for deep molecular function investigation. Based on a literature search, the identification and classification of the top 10 metabolites are summarized in Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>. Of the 10 metabolites, five were identified and two were further classified as flavonoid, of which content was reported as an assessment of the crop yield<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>.</p></sec><sec id="Sec9"><title>2D association mapping</title><p id="Par35">The biological interpretation of 2D association mapping for marker pairs&#x02019; interaction effect can be illustrated by visualizing the 2D association matrix directly, significance thresholding, and constructing weighted association networks, etc.</p></sec><sec id="Sec10"><title>Illustration of marker pairs&#x02019; interaction effect and its significance thresholding</title><p id="Par36">For trait YIELD, three 2D association mapping results were analyzed, and each association matrix was illustrated as a scaled image with pseudocolor (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>). By comparison, we found that genotypic markers were neighbor-dependent, as evidenced by the clustering of dots, whereas expressed transcript gene and metabolite markers were neighbor-independent, as evidenced by a random distribution of dots. This phenomenon could be explained by the existence of linkage disequilibrium (LD) blocks in population genetics<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.<fig id="Fig6"><label>Fig. 6</label><caption><p>The pseudo-color images that illustrate the 2D association mapping results, representing the marker pairs&#x02019; interaction effects for the trait YIELD across associative genomics, associative transcriptomics, and associative metabolomics. The pseudo-color scaling maps the &#x02212;log<sub>10</sub>(<italic>p</italic>) value from low (deep blue) to high (yellow)</p></caption><graphic xlink:href="42003_2018_159_Fig6_HTML" id="d29e1356"/></fig></p><p id="Par37">We are usually interested in the significant (&#x02212;log<sub>10</sub>(<italic>p</italic>)&#x02009;&#x02265;&#x02009;Significance_Th) marker pairs instead of all the marker pairs. Similar to 1D association mapping, we could set a significance threshold to generate a binarized version of the 2D association matrix (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">5</xref>). We further zoomed in to a specified local region for each associative omics and found that associative genomics demonstrated a 2D local rectangular array while the associative transcriptomics and associative metabolomics showed a 1D local strip (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">5</xref> inset). The specificity of the 2D local structure pattern for associative genomics was due to the existence of LD blocks in genomics level. Further, the dimension size of 2D local rectangular array corresponds to the LD block size.</p></sec><sec id="Sec11"><title>Conditional 1D association mapping and weighted association network</title><p id="Par38">To a specific omics marker pair, say, markers <italic>X</italic> and <italic>Y</italic>, there is a <italic>p</italic>(<italic>X</italic>, <italic>Y</italic>) value and its significance measured by &#x02212;log<sub>10</sub>(<italic>p</italic>(<italic>X</italic>, <italic>Y</italic>)), which shows how much the omics marker pair is relevant to the phenotypic trait to be studied. If we pinpoint a marker pair (<italic>X</italic>, <italic>Y</italic>) to the image illustrated for 2D association mapping, there surely are two specific lines recorded by 1D association significance values (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">6</xref>). To each associative omics, we selected a representative marker pair, and for each representative marker pair, we marked the two specific lines as white and red and generated two corresponding conditional 1D association mapping plots (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">6</xref>, middle and bottom). Here, the conditional 1D association mapping originally came from the 2D association matrix, which biologically means how much the other omics markers interconnected with the selected marker to affect the studied phenotypic trait. We found that the conditional 1D associative genomics mapping could provide us with some obvious QTLs, while the conditional 1D associative transcriptomics and metabolomics mapping showed us random association mapping.</p><p id="Par39">Further, if we focus on one specific omics marker and set a significance threshold, its interactive pairs along the vertical or horizontal axes with higher &#x02212;log<sub>10</sub>(<italic>p</italic>) values can be considered relevant regulators of that specific marker. Then an association network centered on the specific omics marker could be constructed. The tie connecting two omics marker nodes has an assigned association significance values. This could be called a weighted association network, which is very different from the co-expression-based gene regulation network<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> due to it having a direct biological meaning with the phenotypic trait to be studied.</p><p id="Par40">According to the marker pairs&#x02019; significance values, we picked up top 10 associative transcript and metabolite marker pairs. To acquire a deep molecular-level investigation, we conducted a comprehensive literature search and function annotation for two types of associative omics marker pairs (Supplementary Tables&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref>&#x02013;<xref rid="MOESM1" ref-type="media">4</xref>).</p><p id="Par41">Of the top 10 transcript marker pairs, most of the expressed transcripts are molecularly functional relevant to plant growth, plant hormones, cold and drought stress, etc. (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref>), which can finally affect the phenotypic trait YIELD. In addition, five transcript marker pairs are interconnected with one hub transcript T_8111(<italic>LOC_Os03g45280</italic>). Therefore, a hub transcript T_8111 (<italic>LOC_Os03g45280</italic>)-centered expressed gene association network has been tentatively constructed (Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>).<fig id="Fig7"><label>Fig. 7</label><caption><p>A weighted expressed gene marker interaction network. <bold>a</bold> Illustration of the association network. Five of the top 10 expressed gene transcript marker pairs are interconnected with a hub transcript T_8111 (<italic>LOC_Os03g45280</italic>) and used to construct an example association network. The weight on each tie is the significance value measured by &#x02212;log<sub>10</sub>(<italic>p</italic>). <bold>b</bold> Plot of conditional 1D association mapping for transcript marker T_8111. For the transcript T_8111 (<italic>LOC_Os03g45280</italic>), its conditional 1D association mapping was extracted from the 2D association matrix</p></caption><graphic xlink:href="42003_2018_159_Fig7_HTML" id="d29e1478"/></fig></p><p id="Par42">Although the current knowledge about metabolite identification is very limited, we found that most of the identified metabolites from the top 10 metabolite marker pairs were classified into flavonoid or phenolic (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>). There have been reports that the total phenolic and flavonoid content was comparably relevant to the crop final product yield<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. Of the top 10 association metabolite marker pairs, we found four marker pairs were centered on unknown metabolite marker M_195 and two marker pairs were centered on flavonoid metabolite marker M_311 (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>).</p></sec></sec><sec id="Sec12" sec-type="discussion"><title>Discussion</title><p id="Par43">We extended the concept of genome-wide association to a broader concept of ome-wide association. To overcome the limitations of regular additive GWAS models that fail to consider epistatic and environmental interaction effects, we proposed a new LMM and successfully developed a new PATOWAS pipeline for ome-wide association studies.</p><p id="Par44">We presume that the measured data of gene expression in the transcriptome and metabolite abundance in the metabolome contain not only heritable, stable genetic information but also fluctuating environmental information. Thus, the systematic integration and analysis of multiple levels of associative omics data can provide panoramic insight for complex trait analysis.</p><p id="Par45">To test and validate our presumption, we analyzed a dataset of 210 RILs of rice consisting of genomic, transcriptomic, and metabolomic markers as well as two agronomic phenotypic traits using PATOWAS. The results of the three associative omics analyses were integrated and compared to perform complete trait analysis.</p><p id="Par46">Compared with the genotype-based G2P association, the variance component analysis of gene expression-based T2P and metabolite abundance-based M2P association explained nearly 100% of the phenotypic variance, supporting our presumption that measured gene expression and metabolite abundance data contain both gene and environment information. For KGW, genotype-based G2P association explained &#x0003e;98% of the phenotypic variance, suggesting that this is a simple trait that is less affected by the environment. Of the two types of biologically meaningful variance components, the additive component corresponding to individual genetic markers accounted for 80% of the phenotypic variance, further suggesting that KGW is a more heritable trait that can be easily manipulated by breeding. However, for YIELD, genotype-based G2P association explained only 66% of the phenotypic variance, suggesting that it is a more complex trait that is easily affected by the external environment. In addition, the additive genetic component accounted for only 28% of the phenotypic variance, suggesting that YIELD is more difficult to manipulate by breeding. However, as YIELD may be the most important agronomic trait, environmental factors that affect the transcriptome and metabolome should be carefully considered to produce improvements in this trait.</p><p id="Par47">We found obvious consistencies in genome coordinates between associated genotype markers and expressed gene transcript markers, allowing us to identify high-confidence, co-verified genotype and transcript markers for the same trait and suggesting the presence of correlations between SNP-based genotype data and transcriptomic data. Compared with trait YIELD, trait KGW had more consistent regions between G2P and T2P, indicating that more correlated information was transferred from the genomic level to the transcriptomic level.</p><p id="Par48">We also investigated inconsistent regions between the G2P and T2P plots for YIELD (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>). On chromosome 3, there was a local maximum peak in the G2P plot but not in the T2P plot (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>, Region B), whereas on chromosome 5, there was a local maximum peak in the T2P plot but not in the G2P plot (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>, Region C). We have verified that the latter was the CKX9 plant hormone gene, which could lead to the accumulation of cytokinin and affect the rice grain yield<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>. We speculate that these inconsistencies occurred because of environmental fluctuations resulting in the downregulation of genes located in Region B, and the upregulation of the CKX9 gene located in Region C.</p><p id="Par49">Our associative metabolomic results from PATOWAS indicated that there were more leaf metabolites than seed metabolites relevant to YIELD and vice versa for KGW, suggesting that significantly associated metabolites are tissue-specific and trait-specific. In contrast to Xu et al.&#x02019;s method <sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, which provides only global information, our PATOWAS results provide details about how relevant each metabolite is to YIELD and KGW.</p><p id="Par50">Although there are more than 200,000 different metabolites in the plant kingdom<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, only a few hundred have been able to be measured in one experiment. Furthermore, because of technical bottlenecks in metabolite identification, most measured metabolites are unannotated<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. If we can increase the number of measured and identified metabolites, the metabolome-wide association results from PATOWAS will become more accurate. Furthermore, if we can link associated genes with known metabolites, we can find and explain new pathways connecting enzymatic genes with their eventual metabolites.</p><p id="Par51">The 2D <italic>p-</italic>value scanning results from PATOWAS can be used to construct an association network. Such an association network is trait-related and also can be constructed and analyzed for different ome-wide association studies. The integration of multiple layers of ome-wide association networks, together with other results of PATOWAS analysis, can provide panoramic biological insight for trait analysis, leading toward an answer to the question of how genes, transcripts, proteins, and metabolites work together to produce an observable phenotype.</p></sec><sec id="Sec13"><title>Methods</title><sec id="Sec14"><title>Statistical method</title><p id="Par52"><italic>A new LMM incorporating additive and interaction effects</italic>: We proposed a new LMM for multiple associative omics, mathematically described below, that incorporates all markers&#x02019; direct additive effects and marker pairs&#x02019; interaction effects.</p><p id="Par53">Let <italic>y</italic> be an <italic>n</italic>&#x02009;&#x000d7;&#x02009;1 vector of a quantitative phenotypic trait and <italic>Z</italic> be an <italic>m</italic>&#x02009;&#x000d7;&#x02009;<italic>n</italic> marker matrix for a quantitative omic dataset, such as coded genotypic data, transcript gene expression data, or metabolite abundance data. Coded genotypic data can be acquired by sequencing and genotyping a population<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, gene expression data can be acquired by microarray hybridization or mRNA-seq experiments, and metabolite abundance data can be acquired by gas chromatography&#x02013;mass spectrometry or liquid chromatography&#x02013;mass spectrometry followed by metabolite feature extraction, annotation, alignment, and quantification<sup><xref ref-type="bibr" rid="CR42">42</xref>&#x02013;<xref ref-type="bibr" rid="CR44">44</xref></sup>.</p><p id="Par54">The LMM that incorporates the markers&#x02019; additive effects and marker pairs&#x02019; interaction effects can be represented as<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y = X\beta + \mathop {\sum}\limits_{{\it{i}}{\mathrm{ = 1}}}^m {Z_ia_i} + \mathop {\sum}\limits_{i = 1}^{m - 1} {\mathop {\sum}\limits_{j = i + 1}^m {W_{ij}\gamma _{ij}} + e}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">=1</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:math><graphic xlink:href="42003_2018_159_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>X</italic> is an <italic>n</italic>&#x02009;&#x000d7;&#x02009;1 vector of unity and <italic>&#x003b2;</italic> is the intercept; <italic>Z</italic><sub><italic>i</italic></sub>is the <italic>i</italic>th column of matrix <italic>Z</italic>, and <italic>a</italic><sub><italic>i</italic></sub> is the <italic>i</italic>th marker&#x02019;s additive effect on the trait; <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{ij} = Z_i \ast Z_j$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq4.gif"/></alternatives></inline-formula> is the element-wise product of vectors <italic>Z</italic><sub><italic>i</italic></sub> and <italic>Z</italic><sub><italic>j</italic></sub>; <italic>&#x003b3;</italic><sub><italic>ij</italic></sub> is the interaction effect between marker <italic>i</italic> and marker<italic>j</italic>; and <italic>e</italic> is an <italic>n</italic>&#x02009;&#x000d7;&#x02009;1 vector of residual error.</p><p id="Par55">We treat each marker&#x02019;s effect as a randomly distributed normal variable with a mean of zero and a common variance across all markers or pairs of markers, as shown by <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_i \sim N(0,\sigma _{\mathrm {a}}^2)$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _{ij}\sim N(0,\sigma _{\mathrm {aa}}^2)$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq6.gif"/></alternatives></inline-formula>. The residual errors are of <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e\sim N(0,\sigma ^2)$$\end{document}</tex-math><mml:math id="M18"><mml:mi>e</mml:mi><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq7.gif"/></alternatives></inline-formula>. The total additive and interaction effects are denoted by: <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop {\sum}\limits_{i = 1}^m {Z_ia_i}$$\end{document}</tex-math><mml:math id="M20"><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop {\sum}\limits_{i = 1}^{m - 1} {\mathop {\sum}\limits_{j = i + 1}^m {W_{ij}\gamma _{ij}} }$$\end{document}</tex-math><mml:math id="M22"><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq9.gif"/></alternatives></inline-formula>, respectively.</p><p id="Par56">The expectation of the model is <italic>E</italic>(<italic>y</italic>)&#x02009;=&#x02009;<italic>X&#x003b2;</italic>, and the variance is<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{var}}\left( y \right) = K_{\mathrm {a}}\sigma _{\mathrm {a}}^2 + K_{\mathrm {aa}}\sigma _{\mathrm {aa}}^2 + I\sigma ^2$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mi mathvariant="normal">var</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="42003_2018_159_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>K</italic><sub>a</sub> and <italic>K</italic><sub>aa</sub> are marker-generated additive and epistatic kinship matrices with values calculated by formulas (<xref rid="Equ4" ref-type="">4</xref>) and (<xref rid="Equ5" ref-type="">5</xref>).<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}K_{\mathrm {a}} = \frac{1}{d_{\mathrm {a}}}\mathop {\sum}\limits_{i = 1}^m {Z_i} Z_j^T \hfill \\ K_{\mathrm{aa}} = \frac{1}{{d_{\mathrm{aa}}}}\mathop {\sum}\limits_{i = 1}^{m - 1} {\mathop {\sum}\limits_{j = i + 1}^m {W_{ij}W_{ij}^T} \hfill } \end{array}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="42003_2018_159_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}d_{\mathrm {a}} = \frac{1}{n}tr\left( {\mathop {\sum}\limits_{i = 1}^m {Z_iZ_j^T} } \right)\hfill \\ d_{\mathrm {aa}} = \frac{1}{n}tr\left( {\mathop {\sum}\limits_{i = 1}^{m - 1} {\mathop {\sum}\limits_{j = i + 1}^m {W_{ij}W_{ij}^T} } } \right)\end{array}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="42003_2018_159_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>are normalization factors that allow the <italic>K</italic> matrices to have diagonal elements as close to unity as possible.</p><p id="Par57">The model involves three variance components, <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\mathrm {a}}^2$$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq10.gif"/></alternatives></inline-formula>, <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\mathrm {aa}}^2$$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq11.gif"/></alternatives></inline-formula>, and <italic>&#x003c3;</italic><sup>2</sup>, which can be estimated by the restricted maximum likelihood (REML) method for dissection of phenotypic variance.</p></sec><sec id="Sec15"><title>Estimating variance components using the REML method</title><p id="Par58">The model to estimate variance component is<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y = X\beta + \xi + \zeta + e$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003be;</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003b6;</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:math><graphic xlink:href="42003_2018_159_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where &#x003be; and &#x003b6; are the additive and interaction effects, respectively. The expectation of the model is&#x000a0;<italic>E</italic>(<italic>y</italic>)&#x02009;=&#x02009;<italic>X&#x003b2;</italic>, and the variance is<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {var}}\left( y \right) = {\mathrm {var}}\left( \xi \right) + {\mathrm {var}}\left( \zeta \right) + {\mathrm {var}}\left( e \right) = K_{\mathrm {a}}\sigma _{\mathrm {a}}^2 + K_{\mathrm {aa}}\sigma _{\mathrm {aa}}^2 + I\sigma ^2$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mi mathvariant="normal">var</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">var</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>&#x003be;</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi mathvariant="normal">var</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>&#x003b6;</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi mathvariant="normal">var</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="42003_2018_159_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par59">The restricted log-likelihood function is<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(\beta ,\sigma _{\mathrm {a}}^2,\sigma _{\mathrm {aa}}^2,\sigma ^2) = - \frac{1}{2}\ln \left| V \right| - \frac{1}{2}\ln \left| {X^TV^{ - 1}X} \right| - \frac{1}{2}(y - X\beta )^TV^{ - 1}(y - X\beta )$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>ln</mml:mo><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>ln</mml:mo><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="42003_2018_159_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par60">Given <inline-formula id="IEq12"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\mathrm {a}}^2$$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq12.gif"/></alternatives></inline-formula>, <inline-formula id="IEq13"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\mathrm {aa}}^2$$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq13.gif"/></alternatives></inline-formula>, and <italic>&#x003c3;</italic><sup>2</sup>, we can solve for <italic>&#x003b2;</italic> by<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat \beta = (X^TH^{ - 1}X)^{ - 1}X^TH^{ - 1}y$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:math><graphic xlink:href="42003_2018_159_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par61">Substituting Eq. (<xref rid="Equ9" ref-type="">9</xref>) into Eq. (<xref rid="Equ8" ref-type="">8</xref>) gives<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}L(\sigma _{\mathrm {a}}^2,\sigma _{\mathrm {aa}}^2,\sigma ^2) = - \frac{1}{2}\ln \left| H \right| - \frac{1}{2}\ln \left| {X^TH^{ - 1}X} \right| - \frac{1}{{2\sigma ^2}}(y - X\beta )^TH^{ - 1}(y - X\beta ) \\ \qquad \qquad \qquad + \frac{{n - r(X)}}{2}\ln (\sigma ^2)\hfill\end{array}$$\end{document}</tex-math><mml:math id="M46" display="block"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo> ln</mml:mo><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo> ln</mml:mo><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo> ln</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="42003_2018_159_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par62">Therefore, the defined likelihood function has three unknowns. Calling any optimization subroutine, we can obtain the REML estimates of the three variance components.</p><p id="Par63">After the three variance components are acquired, we fix the variance ratio <inline-formula id="IEq14"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat {\lambda}_{\mathrm{a}} = \hat {\sigma}_{\mathrm {a}}^{2}/\hat {\sigma} ^2$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>&#x02215;</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq14.gif"/></alternatives></inline-formula>, <inline-formula id="IEq15"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat {\lambda} _{\mathrm {aa}} = \hat {\sigma} _{\mathrm {aa}}^{2}{/}\hat {\sigma}^2$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>&#x02215;</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq15.gif"/></alternatives></inline-formula> and estimate and test the additive effects and interaction effects by conducting 1D scanning across all markers and 2D scanning across all marker pairs, respectively.</p></sec><sec id="Sec16"><title>1D and 2D scanning to estimate additive and interaction effects</title><p id="Par64">We define model I and use it to estimate the additive effect of marker <italic>Z</italic><sub><italic>i</italic></sub> as shown below:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y = X\beta + Z_ia_i + e$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:math><graphic xlink:href="42003_2018_159_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par65">The expectation of this model is<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E(y) = X\beta + Z_ia_i$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="42003_2018_159_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par66">We also define model II and use it to estimate the interaction effect of marker pair <italic>W</italic><sub><italic>ij</italic></sub> as shown below:<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y = X\beta + Z_ia_i + Z_ja_j + W_{ij}\gamma _{ij} + e$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:math><graphic xlink:href="42003_2018_159_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par67">The expectation of this model is<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E(y) = X\beta + Z_ia_i + Z_ja_j + W_{ij}\gamma _{ij}$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="42003_2018_159_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par68">When (<italic>&#x003bb;</italic><sub>a</sub>,<italic>&#x003bb;</italic><sub>aa</sub>) are fixed, the two models are fixed models and can be solved using the weighted least-squares method. The variance of each model can be written as<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{ccccc}\\ V = {\mathop{\rm{var}}} (y) &#x00026;=&#x00026; K_{\mathrm {a}}\sigma _{\mathrm {a}}^2 + K_{\mathrm {aa}}^{}\sigma _{\mathrm {aa}}^2 + I\sigma ^2\\ &#x00026;=&#x00026; \left( {K_{\mathrm {a}}\lambda _{\mathrm {a}} + K_{\mathrm {aa}}\lambda _{\mathrm {aa}} + I} \right)\sigma ^2 \\ &#x00026;=&#x00026; \left( {H + I} \right)\sigma ^2\hfill\\ \end{array}$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mtable><mml:mtr><mml:mtd columnalign="center"/></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow/></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"/><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aa</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"/><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"/></mml:mtr></mml:mtable></mml:math><graphic xlink:href="42003_2018_159_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par69">Furthermore, we define a parameter matrix <italic>P</italic> and a vector <italic>b</italic> as the following:<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P = \left\{ {\begin{array}{*{20}{c}} {\left[ {X||Z_i} \right]} &#x00026; {{{{\rm{Model}}}\quad {\mathrm{I}}}} \\ {\left[ {X||Z_i||Z_j||W_{ij}} \right]} &#x00026; {{{{\rm{Model}}}\quad {\mathrm{II}}}} \end{array}} \right.$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">Model</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="normal">I</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">Model</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="normal">II</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2018_159_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b = \left\{ {\begin{array}{*{20}{c}} {\left[ {\beta //a_i} \right]} &#x00026; {{{{\rm{Model}}}\quad {\mathrm{I}}}} \\ {\left[ {\beta //a_i//a_j//\gamma _{ij}} \right]} &#x00026; {{{{\rm{Model}}}\quad {\mathrm {II}}}} \end{array}} \right.$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x02215;</mml:mo><mml:mo>&#x02215;</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">Model</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="normal">I</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x02215;</mml:mo><mml:mo>&#x02215;</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02215;</mml:mo><mml:mo>&#x02215;</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02215;</mml:mo><mml:mo>&#x02215;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">Model</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="normal">II</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2018_159_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>where <italic>P</italic> is a <italic>n</italic>&#x02009;&#x000d7;&#x02009;2 or <italic>n</italic>&#x02009;&#x000d7;&#x02009;4 matrix that concatenates all matrices horizontally and <italic>b</italic> is a 2&#x02009;&#x000d7;&#x02009;1 or 4&#x02009;&#x000d7;&#x02009;1 vector that concatenates all regression coefficients vertically. The generalized least square estimate of <italic>b</italic> is<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat b = (P^TV^{ - 1}P)^{ - 1}P^TV^{ - 1}y$$\end{document}</tex-math><mml:math id="M66" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:math><graphic xlink:href="42003_2018_159_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par70">Note that<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V^{ - 1} = (H + I)^{ - 1}{\mathrm{/}}\sigma ^2$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">&#x02215;</mml:mi><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="42003_2018_159_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par71">Therefore,<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat b = (P^T(H + I)^{ - 1}P)^{ - 1}P^T(H + I)^{ - 1}y$$\end{document}</tex-math><mml:math id="M70" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:math><graphic xlink:href="42003_2018_159_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula>Note that when (<italic>&#x003bb;</italic><sub>a</sub>,<italic>&#x003bb;</italic><sub>aa</sub>) are fixed, the following matrix is a constant matrix and can be simplified using Eigen decomposition:<disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(H + I)^{ - 1} = (UDU^T + I)^{ - 1} = U(D + I)^{ - 1}U^T$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mi>D</mml:mi><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><graphic xlink:href="42003_2018_159_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>where <italic>D</italic> (a diagonal matrix) holds the eigenvalues of <italic>H</italic>, and <italic>U</italic> (a matrix) holds the eigenvectors of matrix <italic>H</italic>. The inverse of <italic>D</italic>&#x02009;+&#x02009;<italic>I</italic> is simply<disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(D + I)^{ - 1} = {\mathrm {diag}}\left\{ {\frac{1}{{\delta _i + 1}}} \right\}$$\end{document}</tex-math><mml:math id="M74" display="block"><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">diag</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2018_159_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par72">Rewriting Eq. (<xref rid="Equ20" ref-type="">20</xref>) gives<disp-formula id="Equ23"><label>23</label><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat b = (P^T(H + I)^{ - 1}P)^{ - 1}P^T(H + I)^{ - 1}y = (P^{ \ast T}WP^ \ast )^{ - 1}P^{ \ast T}Wy^ \ast$$\end{document}</tex-math><mml:math id="M76" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math><graphic xlink:href="42003_2018_159_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula>where<disp-formula id="Equ24"><label>24</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\begin{array}{*{20}{l}} {P^ \ast = U^TP} \hfill \\ {y^ \ast = U^Ty} \hfill \\ {W = (D + I)^{ - 1}} \hfill \end{array}} \right.$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>P</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2018_159_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par73">The residual error variance is estimated using<disp-formula id="Equ25"><label>25</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat \sigma ^2 = \frac{1}{{n - r(P)}} = (y^ \ast - P^ \ast \hat b)^TW(y^ \ast - P^ \ast \hat b)$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="42003_2018_159_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula>where <italic>r</italic>(<italic>P</italic>)&#x02009;=&#x02009;2 and <italic>r</italic>(<italic>P</italic>)&#x02009;=&#x02009;4 for model I and model II, respectively. The variance matrix of the estimated effects is<disp-formula id="Equ26"><label>26</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathop{\rm{var}}} (\hat b) = (P^{ \ast T}WP)^{ - 1}\hat \sigma ^2$$\end{document}</tex-math><mml:math id="M82" display="block"><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="42003_2018_159_Article_Equ26.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par74">For model I,<disp-formula id="Equ27"><label>27</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathop{\rm{var}}} (\hat b) = \left[ {\begin{array}{*{20}{c}} {{\mathop{\rm{var}}} (\hat \beta )} &#x00026; {{\mathop{\rm{cov}}} (\hat \beta ,\hat a_i)} \\ {{\mathop{\rm{cov}}} (\hat a_i,\hat \beta )} &#x00026; {{\mathop{\rm{var}}} (\hat a_i)} \end{array}} \right]$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2018_159_Article_Equ27.gif" position="anchor"/></alternatives></disp-formula>and the Wald test for H<sub>0</sub>: <italic>a</italic><sub><italic>i</italic></sub>&#x02009;=&#x02009;0 is<disp-formula id="Equ28"><label>28</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {Wald}} = \frac{{\hat a_i^2}}{{{\mathop{\rm{var}}} (\hat a_i)}}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mi mathvariant="normal">Wald</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="42003_2018_159_Article_Equ28.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par75">For model II,<disp-formula id="Equ29"><label>29</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathop{\rm{var}}} (\hat b) = \left[ {\begin{array}{*{20}{c}} {{\mathop{\rm{var}}} (\hat \beta )} &#x00026; {{\mathop{\rm{cov}}} (\hat \beta ,\hat a_i)} &#x00026; {{\mathop{\rm{cov}}} (\hat \beta ,\hat a_j)} &#x00026; {{\mathop{\rm{cov}}} (\hat \beta ,\hat \gamma _{ij})} \\ {{\mathop{\rm{cov}}} (\hat a_i,\hat \beta )} &#x00026; {{\mathop{\rm{var}}} (\hat a_i)} &#x00026; {{\mathop{\rm{cov}}} (\hat a_i,\hat a_j)} &#x00026; {{\mathop{\rm{cov}}} (\hat a_i,\hat \gamma _{ij})} \\ {{\mathop{\rm{cov}}} (\hat a_j,\hat \beta )} &#x00026; {{\mathop{\rm{cov}}} (\hat a_j,\hat a_i)} &#x00026; {{\mathop{\rm{var}}} (\hat a_j)} &#x00026; {{\mathop{\rm{cov}}} (\hat a_j,\hat \gamma _{ij})} \\ {{\mathop{\rm{cov}}} (\hat \gamma _{ij},\hat \beta )} &#x00026; {{\mathop{\rm{cov}}} (\hat \gamma _{ij},\hat a_i)} &#x00026; {{\mathop{\rm{cov}}} (\hat \gamma _{ij},\hat a_j)} &#x00026; {{\mathop{\rm{var}}} (\hat \gamma _{ij})} \end{array}} \right]$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2018_159_Article_Equ29.gif" position="anchor"/></alternatives></disp-formula>and the Wald test for H<sub>0</sub>: <italic>&#x003b3;</italic><sub><italic>ij</italic></sub>&#x02009;=&#x02009;0 is<disp-formula id="Equ30"><label>30</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {Wald}} = \frac{{\hat \gamma _{ij}^2}}{{{\mathop{\rm{var}}} (\hat \gamma _{ij})}}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mi mathvariant="normal">Wald</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="42003_2018_159_Article_Equ30.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par76">The <italic>p-</italic>value for a marker&#x02019;s additive effect or the interaction effect of a marker pair is calculated using<disp-formula id="Equ31"><label>31</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p = 1 - \Pr (\chi _{1}^{2} &#x0003c; {\mathrm {Wald}})$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo> Pr</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>&#x003c7;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>&#x0003c;</mml:mo><mml:mi mathvariant="normal">Wald</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="42003_2018_159_Article_Equ31.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec17"><title>PATOWAS pipeline</title><p id="Par77">PATOWAS was developed for analyzing traits through ome-wide association studies. The PATOWAS is composed of two primary sub-pipelines. Sub-pipeline 1 consists of one module designed for kinship matrix calculation, and sub-pipeline 2 is designed for association mapping and integrates three related analysis modules: one for the three variance component analysis, another for 1D <italic>p</italic>-value scanning for all markers&#x02019; direct additive effects, and a third for 2D <italic>p</italic>-value scanning for all marker pairs&#x02019; interaction effects. The four modules are designated km_cal, vc_anal, ps_main, and ps_inter, respectively. The modules were coded with C/C++ using Code::Blocks in a Linux environment and compiled into four separate executable commands. Several Perl and Linux C shell scripts were developed to function as a wrapper to streamline the complete analysis pipeline. Briefly, when the coded genotype data, transcript gene expression data, or metabolite abundance data are provided, module km_cal calculates and delivers the corresponding kinship matrix. When phenotypic quantitative trait data are provided, module vc_anal estimates and delivers the three variance component ratios utilizing both the quantitative trait data and the available kinship matrices. After performing various information aggregation procedures, including kinship matrix weighing and matrix eigen-decomposition, modules ps_main and ps_inter calculate and return 1D <italic>p</italic>-values for all markers and 2D <italic>p</italic>-values for all marker pairs, respectively (Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8a</xref>).<fig id="Fig8"><label>Fig. 8</label><caption><p>PATOWAS data analysis flowchart and the user interfaces. <bold>a</bold> PATOWAS data analysis flowchart. PATOWAS includes four processing models, need omics marker matrix data and phenotypic trait data as input, and output results kinship matrix, variance component ratios, 1D and 2D <italic>p-</italic>values for main and interaction effects. <bold>b</bold> User interface for submitting data. <bold>c</bold> User interface for downloading results</p></caption><graphic xlink:href="42003_2018_159_Fig8_HTML" id="d29e5274"/></fig></p><p id="Par78">PATOWAS accepts 2D omic marker matrix data and 1D phenotypic trait data in.csv format as inputs (Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8b</xref>). After data submission, PATOWAS calculates kinship matrix <italic>K</italic><sub>a</sub>, <italic>K</italic><sub>aa</sub> and uses the intermediate kinship matrix and phenotypic trait data to estimate the variance component ratio <italic>&#x003bb;</italic><sub>a</sub>, <italic>&#x003bb;</italic><sub>aa</sub>. Finally, a Wald test is employed to scan the 1D and 2D <italic>p</italic>-values for the markers&#x02019; additive effects and the interaction effects of marker pairs, respectively (Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8a</xref>). The PATOWAS analysis output includes the kinship matrix, estimated variance components, and 1D and 2D <italic>p</italic>-values for the markers&#x02019; additive effects and marker pairs&#x02019; interaction effects (Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8c</xref>). Based on the results, the three variance components accounting for phenotypic variance and the &#x02212;log<sub>10</sub>(<italic>p</italic>) values for the markers&#x02019; additive effects and marker pairs&#x02019; interaction effects can be visualized and further analyzed.</p><p id="Par79">To increase the flexibility of analyses, users are allowed to run only a portion of the PATOWAS pipeline according to the input data and user-configured parameters (e.g., users can perform only kinship matrix calculations and the three variance component analyses or only kinship matrix calculations). Such configuration flexibility enables users to utilize PATOWAS to generate specific data, such as a kinship matrix, for their own genetic data analysis.</p><p id="Par80">Similar to PEPIS<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, PATOWAS was implemented in C/C++ programming language. Furthermore, its computationally demanding analysis modules were implemented using parallel computing techniques, which effectively divide large computational tasks into smaller jobs that are distributed to nodes on networked Linux clusters to accelerate computing.</p><p id="Par81">Let <italic>n</italic> be the number of individuals and <italic>m</italic> be the number of omic markers. The total number of effects is <italic>m</italic>&#x02009;+&#x02009;<italic>C</italic>(<italic>m</italic>,2)&#x02009;=&#x02009;<italic>m</italic>(<italic>m</italic>&#x02009;+&#x02009;1)/2. According to the kinship matrix calculation formula<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> and complexity analysis<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, the multiplications to calculate the kinship matrix <italic>K</italic><sub>a</sub> and <italic>K</italic><sub>aa</sub> are <italic>mn</italic>(<italic>n</italic>&#x02009;+&#x02009;1)/2 and <italic>m</italic>(<italic>m</italic>&#x02212;1)<italic>n</italic>(<italic>n</italic>&#x02009;+&#x02009;1)/4, respectively. These calculation complexities demonstrate the enormity of the multiplication demand associated with kinship matrix calculations, especially when both <italic>n</italic> and <italic>m</italic> are large. However, the procedure used to calculate each matrix cell value is the same; thus, all <italic>n</italic>(<italic>n</italic>&#x02009;+&#x02009;1)/2 loops for matrix cell calculation can be parallelized.</p><p id="Par82">The variance component analysis module essentially needs only one optimization for a three-parameter log-likelihood estimation. The 1D additive effects <italic>p-</italic>value scanning module needs <italic>m</italic> Chi-square calculations and Wald tests, and the 2D interaction effects <italic>p-</italic>value scanning module needs <italic>m</italic>(<italic>m</italic>&#x02212;1)/2 Chi-square calculations and Wald tests. However, the procedure to calculate the <italic>p-</italic>values is the same, so the <italic>m</italic> times additive effect <italic>p-</italic>value calculation and <italic>m</italic>(<italic>m</italic>&#x02212;1)/2 times interaction effect <italic>p-</italic>value calculation can also be parallelized. The strategy utilized in the PATOWAS for parallel high-performance distributed computing is summarized in Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Summary of parallel strategy of PATOWAS for high-performance distributed computing</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Computing module</th><th>Computation complexity description</th><th>Repetitive parallelizable calculation unit</th><th>Allocated job for each CPU node with <italic>p</italic> parallelizable nodes</th></tr></thead><tbody><tr><td>Kinship matrix calculation</td><td><inline-formula id="IEq16"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{n(n + 1)}}{2}$$\end{document}</tex-math><mml:math id="M94"><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq16.gif"/></alternatives></inline-formula> Loops for each of the 2 kinship matrix&#x02019;s cell calculations</td><td>Kinship matrix cell calculations</td><td><inline-formula id="IEq17"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{n(n + 1)}}{{2p}}$$\end{document}</tex-math><mml:math id="M96"><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>p</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq17.gif"/></alternatives></inline-formula> loops for each matrix&#x02019;s cell calculations</td></tr><tr><td><italic>p-</italic>Value scanning for main effects</td><td><italic>m</italic> times Wald test and Chi-square calculation</td><td>2 degrees of freedom Wald test and Chi-square calculation</td><td><inline-formula id="IEq18"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{m}{p}$$\end{document}</tex-math><mml:math id="M98"><mml:mfrac><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq18.gif"/></alternatives></inline-formula> times 2 degrees of freedom Wald test and Chi-square calculation</td></tr><tr><td><italic>p-</italic>Value scanning for interaction effects</td><td><inline-formula id="IEq19"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{m(m - 1)}}{2}$$\end{document}</tex-math><mml:math id="M100"><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq19.gif"/></alternatives></inline-formula> times Wald test and Chi-square calculation</td><td>4 degrees of freedom Wald test and Chi-square calculation</td><td><inline-formula id="IEq20"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{m(m - 1)}}{{2p}}$$\end{document}</tex-math><mml:math id="M102"><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>p</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="42003_2018_159_Article_IEq20.gif"/></alternatives></inline-formula> times 4 degrees of freedom Wald test and Chi-square calculation</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec18"><title>Rice omics data</title><p id="Par83">We analyzed YIELD and KGW from 210 RILs of rice described by Hua et al.<sup><xref ref-type="bibr" rid="CR45">45</xref>,<xref ref-type="bibr" rid="CR46">46</xref></sup>. The 210 RILs were derived by single-seed descent from a cross between the Zhenshan 97 and Minghui 63 rice hybrids. Field phenotypic data pertaining to YIELD and KGW were collected from replicated field trials on the Huazhong Agricultural University Experimental Farm in Wuhan, China.</p><p id="Par84">Ome-wide quantitative marker data consisted of bin-based genotype data, Affymetrix RNA microarray-based gene expression data, and mass spectrometry-based profiling metabolite abundance data. Over 270,000 high-density SNP markers were used to infer recombination breakpoints (crossovers), which were then used to construct a total of 1619 genotype bins<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. Each bin was treated as a new synthetic marker for association studies, and the bin map was constructed by genotyping the RIL population sequences.</p><p id="Par85">The transcriptomic data originally consisted of 24,994 expressed genes, which were sampled and measured from flag leaves for all 210 RILs in 2008. Each line had two biological replicates, but RNA extracted from the two replicates was mixed at a 1:1 ratio before microarray expression profiling. The original expression levels were then log<sub>2</sub>-transformed before analysis<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. Of the 24,994 genes, 22,584 were clearly matched to 1619 genotype bins. We found only minor and inconsequential differences between the analysis results for 24,994 versus 22,584 genes.</p><p id="Par86">The metabolomic data consisted of 683 metabolites measured from flag leaves and 317 metabolites measured from germinated seeds<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. Metabolomic data were collected in 2009 and 2010. Before mass spectrometry-based metabolic profiling, germinated seeds were sampled in one biological replicate in 2009 and one in 2010, and flag leaves were sampled in two biological replicates in 2009. For both tissues, the abundance level of each metabolite was log<sub>2</sub>-transformed. For each line, we took the average of two replicates&#x02019; abundance levels as the measurement of the metabolite.</p><p id="Par87">In summary, the bin genotype data, microarray-based gene expression data, and mass spectrometry-based metabolite data were acquired and stored in three matrices as dimensions of <italic>m</italic>&#x02009;&#x000d7;&#x02009;<italic>n</italic>&#x02009;=&#x02009;1619&#x02009;&#x000d7;&#x02009;210, <italic>m</italic>&#x02009;&#x000d7;&#x02009;<italic>n</italic>&#x02009;=&#x02009;22,584&#x02009;&#x000d7;&#x02009;210, and <italic>m</italic>&#x02009;&#x000d7;&#x02009;<italic>n</italic>&#x02009;=&#x02009;1000&#x02009;&#x000d7;&#x02009;210, respectively (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). Here, <italic>m</italic> and <italic>n</italic> represent the number of markers and individuals, respectively.</p></sec><sec id="Sec19"><title>Code availability</title><p id="Par88">The PATOWAS pipeline and source code are freely available at http://bioinfo.noble.org/PATOWAS/. In addition, the source code of PATOWAS has been deposited into the public repository GitHub at https://github.com/ZhaoBioinformaticsLab/PATOWAS. We are committed to maintaining and improving the specific function modules per user comments and suggestions.</p></sec></sec><sec sec-type="supplementary-material"><title>Electronic supplementary material</title><sec id="Sec20"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="42003_2018_159_MOESM1_ESM.pdf"><caption><p>Supplementary Information</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="42003_2018_159_MOESM2_ESM.docx"><caption><p>Description of additional Supplementary Data</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="42003_2018_159_MOESM3_ESM.csv"><caption><p>Supplementary Data 1</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM4"><media xlink:href="42003_2018_159_MOESM4_ESM.csv"><caption><p>Supplementary Data 2</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM5"><media xlink:href="42003_2018_159_MOESM5_ESM.csv"><caption><p>Supplementary Data 3</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM6"><media xlink:href="42003_2018_159_MOESM6_ESM.csv"><caption><p>Supplementary Data 4</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM7"><media xlink:href="42003_2018_159_MOESM7_ESM.csv"><caption><p>Supplementary Data 5</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM8"><media xlink:href="42003_2018_159_MOESM8_ESM.xlsx"><caption><p>Supplementary Data 6</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM9"><media xlink:href="42003_2018_159_MOESM9_ESM.csv"><caption><p>Supplementary Data 7</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM10"><media xlink:href="42003_2018_159_MOESM10_ESM.csv"><caption><p>Supplementary Data 8</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM11"><media xlink:href="42003_2018_159_MOESM11_ESM.xlsx"><caption><p>Supplementary Data 9</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM12"><media xlink:href="42003_2018_159_MOESM12_ESM.xlsx"><caption><p>Supplementary Data 10</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Electronic supplementary material</title><p><bold>Supplementary Information</bold> accompanies this paper at 10.1038/s42003-018-0159-7.</p></sec><ack><title>Acknowledgements</title><p>The authors thank Dr. Qifa Zhang of Huazhong Agricultural University for sharing the omics dataset and field trait data for the rice population. The authors also thank Dr. Naichong Chen from Oklahoma State University for the helpful discussion and literature validation of the significant gene markers and metabolite markers with the rice phenotypic trait YIELD. This work was supported by the Noble Research Institute and National Science Foundation collaborative research grant awards (DBI-1458597 and DBI-1458515). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>Conceived and designed the experiments: S.X., P.X.Z. Performed the experiments: W.Z., X.D.. Analyzed the data: W.Z., X.D., S.X., P.X.Z. Contributed materials/analysis tools: W.Z., X.D., S.X., P.X.Z. Wrote the paper: W.Z., X.D., S.X., P.X.Z.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>All datasets, including presented case analysis data and results, are freely available at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.noble.org/PATOWAS/Download.gy.">http://bioinfo.noble.org/PATOWAS/Download.gy.</ext-link></p></notes><notes notes-type="COI-statement"><sec id="FPar1"><title>Competing interests</title><p>The authors declare no competing interests.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>SH</given-names></name><name><surname>Goddard</surname><given-names>ME</given-names></name><name><surname>Visscher</surname><given-names>PM</given-names></name></person-group><article-title>GCTA: a tool for genome-wide complex trait analysis</article-title><source>Am. J. Human. Genet.</source><year>2011</year><volume>88</volume><fpage>76</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2010.11.011</pub-id><pub-id pub-id-type="pmid">21167468</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harper</surname><given-names>AL</given-names></name><etal/></person-group><article-title>Associative transcriptomics of traits in the polyploid crop species <italic>Brassica napus</italic></article-title><source>Nat. Biotech.</source><year>2012</year><volume>30</volume><fpage>798</fpage><lpage>802</lpage><pub-id pub-id-type="doi">10.1038/nbt.2302</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hindorff</surname><given-names>LA</given-names></name><etal/></person-group><article-title>Potential etiologic and functional implications of genome-wide association loci for human diseases and traits</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2009</year><volume>106</volume><fpage>9362</fpage><lpage>9367</lpage><pub-id pub-id-type="doi">10.1073/pnas.0903103106</pub-id><pub-id pub-id-type="pmid">19474294</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pandey</surname><given-names>A</given-names></name><etal/></person-group><article-title>Epistasis network centrality analysis yields pathway replication across two GWAS cohorts for bipolar disorder</article-title><source>Transl. Psychiatry</source><year>2012</year><volume>2</volume><fpage>e154</fpage><pub-id pub-id-type="doi">10.1038/tp.2012.80</pub-id><pub-id pub-id-type="pmid">22892719</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carlborg</surname><given-names>O</given-names></name><name><surname>Haley</surname><given-names>CS</given-names></name></person-group><article-title>Epistasis: too often neglected in complex trait studies?</article-title><source>Nat. Rev. Genet.</source><year>2004</year><volume>5</volume><fpage>618</fpage><lpage>625</lpage><pub-id pub-id-type="doi">10.1038/nrg1407</pub-id><pub-id pub-id-type="pmid">15266344</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eichler</surname><given-names>EE</given-names></name><etal/></person-group><article-title>Missing heritability and strategies for finding the underlying causes of complex disease</article-title><source>Nat. Rev. Genet.</source><year>2010</year><volume>11</volume><fpage>446</fpage><lpage>450</lpage><pub-id pub-id-type="doi">10.1038/nrg2809</pub-id><pub-id pub-id-type="pmid">20479774</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="other">Xu, S. Mapping quantitative trait loci by controlling polygenic background effects. <italic>Genetics</italic>, 10.1534/genetics.113.157032 (2013).</mixed-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Dai</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Xu</surname><given-names>S</given-names></name><name><surname>Zhao</surname><given-names>PX</given-names></name></person-group><article-title>PEPIS: a pipeline for estimating epistatic effects in quantitative trait locus mapping and genome-wide association studies</article-title><source>PLoS Comput. Biol.</source><year>2016</year><volume>12</volume><fpage>e1004925</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004925</pub-id><pub-id pub-id-type="pmid">27224861</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="other">Orgogozo, V., Morizot, B. &#x00026; Martin, A. The differential view of genotype&#x02013;phenotype relationships. <italic>Front. Genet.</italic><bold>6</bold>, 10.3389/fgene.2015.00179 (2015).</mixed-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhatia</surname><given-names>A</given-names></name><etal/></person-group><article-title>Yeast growth plasticity is regulated by environment-specific multi-QTL interactions</article-title><source>G3: Genes| Genomes| Genet.</source><year>2014</year><volume>4</volume><fpage>769</fpage><lpage>777</lpage><pub-id pub-id-type="doi">10.1534/g3.113.009142</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerke</surname><given-names>J</given-names></name><name><surname>Lorenz</surname><given-names>K</given-names></name><name><surname>Ramnarine</surname><given-names>S</given-names></name><name><surname>Cohen</surname><given-names>B</given-names></name></person-group><article-title>Gene&#x02013;environment interactions at nucleotide resolution</article-title><source>PLoS Genet.</source><year>2010</year><volume>6</volume><fpage>e1001144</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1001144</pub-id><pub-id pub-id-type="pmid">20941394</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>JT</given-names></name><name><surname>Taylor</surname><given-names>MB</given-names></name><name><surname>Shen</surname><given-names>A</given-names></name><name><surname>Ehrenreich</surname><given-names>IM</given-names></name></person-group><article-title>Multi-locus genotypes underlying temperature sensitivity in a mutationally induced trait</article-title><source>PLoS Genet.</source><year>2016</year><volume>12</volume><fpage>e1005929</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1005929</pub-id><pub-id pub-id-type="pmid">26990313</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muir</surname><given-names>W</given-names></name><name><surname>Nyquist</surname><given-names>W</given-names></name><name><surname>Xu</surname><given-names>S</given-names></name></person-group><article-title>Alternative partitioning of the genotype-by-environment interaction</article-title><source>TAG Theor. Appl. Genet.</source><year>1992</year><volume>84</volume><fpage>193</fpage><lpage>200</lpage><pub-id pub-id-type="doi">10.1007/BF00224000</pub-id><pub-id pub-id-type="pmid">24203047</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsui</surname><given-names>T</given-names></name><name><surname>Ehrenreich</surname><given-names>IM</given-names></name></person-group><article-title>Gene-environment interactions in stress response contribute additively to a genotype-environment interaction</article-title><source>PLoS Genet.</source><year>2016</year><volume>12</volume><fpage>e1006158</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1006158</pub-id><pub-id pub-id-type="pmid">27437938</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patti</surname><given-names>GJ</given-names></name><name><surname>Yanes</surname><given-names>O</given-names></name><name><surname>Siuzdak</surname><given-names>G</given-names></name></person-group><article-title>Innovation: Metabolomics: the apogee of the omics trilogy</article-title><source>Nat. Rev. Mol. Cell Biol.</source><year>2012</year><volume>13</volume><fpage>263</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1038/nrm3314</pub-id><pub-id pub-id-type="pmid">22436749</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bylesj&#x000f6;</surname><given-names>M</given-names></name><name><surname>Eriksson</surname><given-names>D</given-names></name><name><surname>Kusano</surname><given-names>M</given-names></name><name><surname>Moritz</surname><given-names>T</given-names></name><name><surname>Trygg</surname><given-names>J</given-names></name></person-group><article-title>Data integration in plant biology: the O2PLS method for combined modeling of transcript and metabolite data</article-title><source>Plant J.</source><year>2007</year><volume>52</volume><fpage>1181</fpage><lpage>1191</lpage><pub-id pub-id-type="doi">10.1111/j.1365-313X.2007.03293.x</pub-id><pub-id pub-id-type="pmid">17931352</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baye</surname><given-names>TM</given-names></name><name><surname>Abebe</surname><given-names>T</given-names></name><name><surname>Wilke</surname><given-names>RA</given-names></name></person-group><article-title>Genotype&#x02013;environment interactions and their translational implications</article-title><source>Pers. Med.</source><year>2010</year><volume>8</volume><fpage>59</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.2217/pme.10.75</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">Lu, G. et al. Associative transcriptomics study dissects the genetic architecture of seed glucosinolate content in <italic>Brassica napus</italic>. <italic>DNA Res.</italic>, 10.1093/dnares/dsu024 (2014).</mixed-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>W</given-names></name><name><surname>Feng</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>H</given-names></name></person-group><article-title>Regularization methods for high-dimensional instrumental variables regression with an application to genetical genomics</article-title><source>J. Am. Stat. Assoc.</source><year>2015</year><volume>110</volume><fpage>270</fpage><lpage>288</lpage><pub-id pub-id-type="doi">10.1080/01621459.2014.908125</pub-id><pub-id pub-id-type="pmid">26392642</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chakraborty</surname><given-names>S</given-names></name><name><surname>Ghosh</surname><given-names>M</given-names></name><name><surname>Mallick</surname><given-names>BK</given-names></name></person-group><article-title>Bayesian nonlinear regression for large p small n problems</article-title><source>J. Multivar. Anal.</source><year>2012</year><volume>108</volume><fpage>28</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.1016/j.jmva.2012.01.015</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diao</surname><given-names>G</given-names></name><name><surname>Vidyashankar</surname><given-names>AN</given-names></name></person-group><article-title>Assessing genome-wide statistical significance for large p small n problems</article-title><source>Genetics</source><year>2013</year><volume>194</volume><fpage>781</fpage><lpage>783</lpage><pub-id pub-id-type="doi">10.1534/genetics.113.150896</pub-id><pub-id pub-id-type="pmid">23666935</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>S</given-names></name><name><surname>Zhu</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name></person-group><article-title>Predicting hybrid performance in rice using genomic best linear unbiased prediction</article-title><source>Proc. Natl. Acad. Sci. USA</source><year>2014</year><volume>111</volume><fpage>12456</fpage><lpage>12461</lpage><pub-id pub-id-type="doi">10.1073/pnas.1413750111</pub-id><pub-id pub-id-type="pmid">25114224</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>S</given-names></name></person-group><article-title>Predicted residual error sum of squares of mixed models: an application for genomic prediction</article-title><source>G3: Genes|Genomes|Genetics</source><year>2017</year><volume>7</volume><fpage>895</fpage><lpage>909</lpage><pub-id pub-id-type="doi">10.1534/g3.116.038059</pub-id><pub-id pub-id-type="pmid">28108552</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradbury</surname><given-names>PJ</given-names></name><etal/></person-group><article-title>TASSEL: software for association mapping of complex traits in diverse samples</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>2633</fpage><lpage>2635</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btm308</pub-id><pub-id pub-id-type="pmid">17586829</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">Chang, C. C., Chow, C. C., Tellier, L. C., Vattikuti, S., Purcell, S. M., &#x00026; Lee, J. J. Second-generation PLINK: rising to the challenge of larger and richer datasets. <italic>GigaScience</italic><bold>4</bold>,&#x000a0;10.1186/s13742-015-00 (2015).</mixed-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gibson</surname><given-names>G</given-names></name></person-group><article-title>Hints of hidden heritability in GWAS</article-title><source>Nat. Genet.</source><year>2010</year><volume>42</volume><fpage>558</fpage><lpage>560</lpage><pub-id pub-id-type="doi">10.1038/ng0710-558</pub-id><pub-id pub-id-type="pmid">20581876</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">Cheng, J. et al. Identification and characterization of quantitative trait loci for shattering in Japonica Rice Landrace Jiucaiqing from Taihu Lake Valley, China. <italic>Plant Genome</italic><bold>9</bold>, 10.3835/plantgenome2016.03.0034 (2016).</mixed-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>K</given-names></name><etal/></person-group><article-title>Down-regulation of OsSPX1 caused semi-male sterility, resulting in reduction of grain yield in rice</article-title><source>Plant Biotechnol. J.</source><year>2016</year><volume>14</volume><fpage>1661</fpage><lpage>1672</lpage><pub-id pub-id-type="doi">10.1111/pbi.12527</pub-id><pub-id pub-id-type="pmid">26806409</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hori</surname><given-names>K</given-names></name><name><surname>Matsubara</surname><given-names>K</given-names></name><name><surname>Yano</surname><given-names>M</given-names></name></person-group><article-title>Genetic control of flowering time in rice: integration of Mendelian genetics and genomics</article-title><source>Theor. Appl. Genet.</source><year>2016</year><volume>129</volume><fpage>2241</fpage><lpage>2252</lpage><pub-id pub-id-type="doi">10.1007/s00122-016-2773-4</pub-id><pub-id pub-id-type="pmid">27695876</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrop</surname><given-names>TWR</given-names></name><etal/></person-group><article-title>Gene expression profiling of reproductive meristem types in early rice inflorescences by laser microdissection</article-title><source>Plant J.</source><year>2016</year><volume>86</volume><fpage>75</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.1111/tpj.13147</pub-id><pub-id pub-id-type="pmid">26932536</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashikari</surname><given-names>M</given-names></name><etal/></person-group><article-title>Cytokinin oxidase regulates rice grain production</article-title><source>Science</source><year>2005</year><volume>309</volume><fpage>741</fpage><lpage>745</lpage><pub-id pub-id-type="doi">10.1126/science.1113373</pub-id><pub-id pub-id-type="pmid">15976269</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeh</surname><given-names>SY</given-names></name><etal/></person-group><article-title>Down-regulation of cytokinin oxidase 2 expression increases tiller number and improves rice yield</article-title><source>Rice</source><year>2015</year><volume>8</volume><fpage>36</fpage><pub-id pub-id-type="doi">10.1186/s12284-015-0070-5</pub-id><?supplied-pmid 26643073?><pub-id pub-id-type="pmid">26643073</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fadista</surname><given-names>J</given-names></name><name><surname>Manning</surname><given-names>AK</given-names></name><name><surname>Florez</surname><given-names>JC</given-names></name><name><surname>Groop</surname><given-names>L</given-names></name></person-group><article-title>The (in)famous GWAS P-value threshold revisited and updated for low-frequency variants</article-title><source>Eur. J. Hum. Genet.</source><year>2016</year><volume>24</volume><fpage>1202</fpage><pub-id pub-id-type="doi">10.1038/ejhg.2015.269</pub-id><pub-id pub-id-type="pmid">26733288</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Gong</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name></person-group><article-title>Metabolomic prediction of yield in hybrid rice</article-title><source>Plant J.</source><year>2016</year><volume>88</volume><fpage>219</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1111/tpj.13242</pub-id><pub-id pub-id-type="pmid">27311694</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitchell</surname><given-names>P</given-names></name><name><surname>Sheehy</surname><given-names>JE</given-names></name></person-group><article-title>Supercharging rice photosynthesis to increase yield</article-title><source>New Phytol.</source><year>2006</year><volume>171</volume><fpage>688</fpage><lpage>693</lpage><pub-id pub-id-type="doi">10.1111/j.1469-8137.2006.01855.x</pub-id><pub-id pub-id-type="pmid">16918541</pub-id></element-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chandra</surname><given-names>S</given-names></name><etal/></person-group><article-title>Assessment of total phenolic and flavonoid content, antioxidant properties, and yield of aeroponically and conventionally grown leafy vegetables and fruit crops: a comparative study</article-title><source>Evid.-Based Complement. Altern. Med.</source><year>2014</year><volume>2014</volume><fpage>9</fpage><pub-id pub-id-type="doi">10.1155/2014/253875</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Linkage disequilibrium&#x02014;understanding the evolutionary past and mapping the medical future</article-title><source>Nat. Rev. Genet.</source><year>2008</year><volume>9</volume><fpage>477</fpage><lpage>485</lpage><pub-id pub-id-type="doi">10.1038/nrg2361</pub-id><pub-id pub-id-type="pmid">18427557</pub-id></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Wei</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Zhao</surname><given-names>PX</given-names></name></person-group><article-title>GPLEXUS: enabling genome-scale gene association network reconstruction and analysis for very large-scale expression data</article-title><source>Nucleic Acids Res.</source><year>2014</year><volume>42</volume><fpage>e32</fpage><lpage>e32</lpage><pub-id pub-id-type="doi">10.1093/nar/gkt983</pub-id><pub-id pub-id-type="pmid">24178033</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bino</surname><given-names>RJ</given-names></name><etal/></person-group><article-title>Potential of metabolomics as a functional genomics tool</article-title><source>Trends Plant Sci.</source><year>2004</year><volume>9</volume><fpage>418</fpage><lpage>425</lpage><pub-id pub-id-type="doi">10.1016/j.tplants.2004.07.004</pub-id><pub-id pub-id-type="pmid">15337491</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lynn</surname><given-names>KS</given-names></name><etal/></person-group><article-title>Metabolite identification for mass spectrometry-based metabolomics using multiple types of correlated ion information</article-title><source>Anal. Chem.</source><year>2015</year><volume>87</volume><fpage>2143</fpage><lpage>2151</lpage><pub-id pub-id-type="doi">10.1021/ac503325c</pub-id><pub-id pub-id-type="pmid">25543920</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname><given-names>W</given-names></name><etal/></person-group><article-title>Parent-independent genotyping for constructing an ultrahigh-density linkage map based on population sequencing</article-title><source>Proc. Natl. Acad. Sci. USA</source><year>2010</year><volume>107</volume><fpage>10578</fpage><lpage>10583</lpage><pub-id pub-id-type="doi">10.1073/pnas.1005931107</pub-id><pub-id pub-id-type="pmid">20498060</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>W</given-names></name><etal/></person-group><article-title>MET-COFEA: a liquid chromatography/mass spectrometry data processing platform for metabolite compound feature extraction and annotation</article-title><source>Anal. Chem.</source><year>2014</year><volume>86</volume><fpage>6245</fpage><lpage>6253</lpage><pub-id pub-id-type="doi">10.1021/ac501162k</pub-id><pub-id pub-id-type="pmid">24856452</pub-id></element-citation></ref><ref id="CR43"><label>43.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Lei</surname><given-names>Z</given-names></name><name><surname>Huhman</surname><given-names>D</given-names></name><name><surname>Sumner</surname><given-names>LW</given-names></name><name><surname>Zhao</surname><given-names>PX</given-names></name></person-group><article-title>MET-XAlign: a metabolite cross-alignment tool for LC/MS-based comparative metabolomics</article-title><source>Anal. Chem.</source><year>2015</year><volume>87</volume><fpage>9114</fpage><lpage>9119</lpage><pub-id pub-id-type="doi">10.1021/acs.analchem.5b01324</pub-id><pub-id pub-id-type="pmid">26247233</pub-id></element-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="other">Zhang, W. &#x00026; Zhao, P. X. Quality evaluation of extracted ion chromatograms and chromatographic peaks in liquid chromatography/mass spectrometry-based metabolomics data. <italic>BMC Bioinform.</italic><bold>15</bold>, 1471-2105-S11-S5 (2014).</mixed-citation></ref><ref id="CR45"><label>45.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hua</surname><given-names>JP</given-names></name><etal/></person-group><article-title>Genetic dissection of an elite rice hybrid revealed that heterozygotes are not always advantageous for performance</article-title><source>Genetics</source><year>2002</year><volume>162</volume><fpage>1885</fpage><lpage>1895</lpage><?supplied-pmid 12524357?><pub-id pub-id-type="pmid">12524357</pub-id></element-citation></ref><ref id="CR46"><label>46.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hua</surname><given-names>J</given-names></name><etal/></person-group><article-title>Single-locus heterotic effects and dominance by dominance interactions can adequately explain the genetic basis of heterosis in an elite rice hybrid</article-title><source>Proc. Natl. Acad. Sci. USA</source><year>2003</year><volume>100</volume><fpage>2574</fpage><lpage>2579</lpage><pub-id pub-id-type="doi">10.1073/pnas.0437907100</pub-id><pub-id pub-id-type="pmid">12604771</pub-id></element-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="other">Wang, J. et al. An expression quantitative trait loci-guided co-expression analysis for constructing regulatory network using a rice recombinant inbred line population. <italic>J. Exp. Bot.</italic><bold>65</bold>,&#x000a0;1069&#x02013;1079&#x000a0;(2014).</mixed-citation></ref><ref id="CR48"><label>48.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gong</surname><given-names>L</given-names></name><etal/></person-group><article-title>Genetic analysis of the metabolome exemplified using a rice population</article-title><source>Proc. Natl. Acad. Sci. USA</source><year>2013</year><volume>110</volume><fpage>20320</fpage><lpage>20325</lpage><pub-id pub-id-type="doi">10.1073/pnas.1319681110</pub-id><pub-id pub-id-type="pmid">24259710</pub-id></element-citation></ref></ref-list></back></article>