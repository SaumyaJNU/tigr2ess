<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BioData Min</journal-id><journal-id journal-id-type="iso-abbrev">BioData Min</journal-id><journal-title-group><journal-title>BioData Mining</journal-title></journal-title-group><issn pub-type="epub">1756-0381</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6352440</article-id><article-id pub-id-type="publisher-id">193</article-id><article-id pub-id-type="doi">10.1186/s13040-019-0193-0</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Predicting opioid dependence from electronic health records with machine learning</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ellis</surname><given-names>Randall J.</given-names></name><address><email>randy.ellis@icahn.mssm.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Zichen</given-names></name><address><email>zichen.wang@mssm.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Genes</surname><given-names>Nicholas</given-names></name><address><email>nicholas.genes@mountsinai.org</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6904-1017</contrib-id><name><surname>Ma&#x02019;ayan</surname><given-names>Avi</given-names></name><address><email>avi.maayan@mssm.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0670 2351</institution-id><institution-id institution-id-type="GRID">grid.59734.3c</institution-id><institution>Department of Pharmacological Sciences, Mount Sinai Center for Bioinformatics, </institution><institution>Icahn School of Medicine at Mount Sinai, </institution></institution-wrap>New York, NY 10029 USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.416167.3</institution-id><institution>Department of Emergency Medicine, </institution><institution>Mount Sinai Hospital, </institution></institution-wrap>New York, NY 10029 USA </aff></contrib-group><pub-date pub-type="epub"><day>29</day><month>1</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>29</day><month>1</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>12</volume><elocation-id>3</elocation-id><history><date date-type="received"><day>27</day><month>10</month><year>2018</year></date><date date-type="accepted"><day>22</day><month>1</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s). 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p id="Par1">The opioid epidemic in the United States is averaging over 100 deaths per day due to overdose. The effectiveness of opioids as pain treatments, and the drug-seeking behavior of opioid addicts, leads physicians in the United States to issue over 200 million opioid prescriptions every year. To better understand the biomedical profile of opioid-dependent patients, we analyzed information from electronic health records (EHR) including lab tests, vital signs, medical procedures, prescriptions, and other data from millions of patients to predict opioid substance dependence.</p></sec><sec><title>Results</title><p id="Par2">We trained a machine learning model to classify patients by likelihood of having a diagnosis of&#x000a0;substance dependence using EHR data from patients diagnosed with substance dependence, along with control patients with no history of substance-related conditions, matched by age, gender, and status of HIV,&#x000a0;hepatitis C, and sickle cell disease. The top machine learning classifier using all features achieved a mean area under the receiver operating&#x000a0;characteristic (AUROC)&#x000a0;curve&#x000a0;of ~&#x02009;92%, and analysis of the model uncovered associations between basic clinical factors and substance dependence.&#x000a0;Additionally, diagnoses, prescriptions, and procedures prior to the diagnoses of substance dependence were analyzed to elucidate the clinical profile of substance-dependent patients, relative to controls.</p></sec><sec><title>Conclusions</title><p id="Par3">The predictive model may hold utility for identifying patients at risk of developing dependence, risk of overdose, and opioid-seeking patients that report other symptoms in their visits to the emergency room.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s13040-019-0193-0) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Opioid epidemic</kwd><kwd>Opioid dependence</kwd><kwd>Electronic health records</kwd><kwd>Electronic medical records</kwd><kwd>Machine learning</kwd><kwd>Artificial intelligence</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000050</institution-id><institution>National Heart, Lung, and Blood Institute</institution></institution-wrap></funding-source><award-id>U54-HL127624</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id><institution>National Cancer Institute</institution></institution-wrap></funding-source><award-id>U24-CA224260</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000052</institution-id><institution>NIH Office of the Director</institution></institution-wrap></funding-source><award-id>OT3-OD025467</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par4">In a highly visible report it was described how drug overdose deaths have substantially increased in the United States from 2010 to 2015 [<xref ref-type="bibr" rid="CR1">1</xref>]. The estimated societal costs of prescription opioid overdoses, abuse, and dependence in the United States in 2013 totaled $78.5 billion [<xref ref-type="bibr" rid="CR2">2</xref>]. The challenges for physicians combating the opioid epidemic include: 1) Determining which patients are at risk of developing opioid dependence when prescribed these medications for conventional pain treatment; 2) Determining which patients known to be addicted to opioids&#x000a0;are most at risk of opioid overdose; and 3) Identifying drug-seeking patients who visit the Emergency Department (ED) for the secondary gain of obtaining an opioid prescription. Strategies to identify drug-seeking patients rely mostly on checking Prescription Drug Monitoring Programs (PDMPs) [<xref ref-type="bibr" rid="CR3">3</xref>], examining past clinical perceptions (clinical gestalt), or exam findings such as withdrawal symptoms [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Urine toxicology tests can detect opioid metabolites, but these tests are prone to false positives and negatives, and opioid metabolites only remain present in the urine for a short period [<xref ref-type="bibr" rid="CR6">6</xref>].</p><p id="Par5">Previous studies of biomedical variables predictive of opioid misuse and abuse have unraveled several salient factors, including chronic opioid prescriptions, history of psychiatric illness, non-opioid substance disorders, having a family member diagnosed with an opioid use disorder, the use of multiple pharmacies to fill prescriptions, having hepatitis&#x000a0;C, and tobacco addiction [<xref ref-type="bibr" rid="CR7">7</xref>&#x02013;<xref ref-type="bibr" rid="CR10">10</xref>]. These studies are based on various types of data, including pharmacy prescriptions, insurance claims, vital signs, and medical notes from electronic health records (EHR). For example, Ciesielski et al. [<xref ref-type="bibr" rid="CR7">7</xref>] and Rice et al. [<xref ref-type="bibr" rid="CR8">8</xref>], in two separate studies, used pharmacy and insurance claims information from over half a million patients to construct a multivariate logistic regression model to predict likelihood of opioid abuse. Similarly, Cochran et al. [<xref ref-type="bibr" rid="CR9">9</xref>] and Dufour et al. [<xref ref-type="bibr" rid="CR10">10</xref>] analyzed insurance claims databases to identify variables with predictive power to classify opioid use disorder patients. In a related study, Hylan et al. [<xref ref-type="bibr" rid="CR11">11</xref>] tracked for four years 2752 patients that received chronic opioid treatment for their pain condition. To determine and predict&#x000a0;opioid misuse, Hylan et al. also utilized natural language processing to analyze clinicians&#x02019; notes. All these past studies point to few common clinical factors that contribute to opioid pathology. Their observations support that the construction of predictive models of opioid misuse and abuse based on prior knowledge about the patient is feasible.&#x000a0;So far, no prior work examined the predictive value of biological measures from standard lab tests for opioid misuse and abuse. In addition, all prior studies used either univariate statistics or multivariate linear models to discern associations between opioid misuse diagnosis and other clinical variables.</p><p id="Par6">Finding a clinically objective signature of opioid abuse would assist physicians in offering the proper treatment to those patients who attempt to hide their addiction for other clinical conditions. Such a&#x000a0;signature will be a composite biomarker that can be detected by machine learning methods. EHR systems have proliferated in the past decade, and are increasingly used to perform predictive diagnosis with non-linear machine learning methods [<xref ref-type="bibr" rid="CR12">12</xref>&#x02013;<xref ref-type="bibr" rid="CR14">14</xref>]. EHR data include demographics, diagnoses, laboratory tests, vital signs,&#x000a0;clinical notes, prescriptions, and procedures data. Examples of previous predictive studies that utilized EHR systems implementing machine learning methods include predicting the incidence of cardiovascular disease in patients with severe schizophrenia, bipolar disorder, or other non-organic psychosis [<xref ref-type="bibr" rid="CR15">15</xref>]; length of hospital stay and time to readmission based on Research Domain Criteria in psychiatric patients [<xref ref-type="bibr" rid="CR16">16</xref>]; unplanned readmission after discharge [<xref ref-type="bibr" rid="CR17">17</xref>]; in-hospital mortality [<xref ref-type="bibr" rid="CR18">18</xref>]; patient physiological age [<xref ref-type="bibr" rid="CR19">19</xref>]; and many more. Here we describe the application of a machine learning classifier to predict substance dependence based on lab tests and vital signs using patient data derived from the Mount Sinai Medical Center (MSMC) EHR system. The lab tests and vital signs that are found to be the most useful in distinguishing substance dependent patients from controls were identified. Furthermore, the substance dependent population was clinically phenotyped by the over-representation of their diagnoses, prescriptions, and procedures during the five years prior to their first diagnosis of substance dependence.</p></sec><sec id="Sec2"><title>Methods</title><sec id="Sec3"><title>Constructing the case and control populations</title><p id="Par7">The MSMC EHR (Epic Systems, Verona, WI) data were organized into a de-identified collection. 42,825,357 diagnoses from the EHR were queried to find all patients with diagnoses belonging to the 304. * family of the International Classification of Diseases (ICD-9) codes (12,112 cases), referring to various forms of substance dependence [<xref ref-type="bibr" rid="CR20">20</xref>]. Patients were excluded if their first 304.* diagnosis was made before they turned 20&#x02009;years of age to avoid patients who were born with substance dependence or acquired substance dependence during childhood or adolescence. This filtering reduced the number of cases to 11,573. Lab tests and vital signs were obtained for all patients within a 20-day window around their 304 diagnosis. Initially, this analysis produced 873 types of lab tests and 51 types of vital signs. To construct a control population, the requirements were that all lab tests and vital signs are from patients older than 20&#x02009;years, have no history of diagnoses in ICD-9 code families 291&#x02013;293: alcohol- and drug-induced mental disorders and withdrawal; 303&#x02013;305: alcohol/drug dependence, abuse; and 964.9&#x02013;978.0: poisoning by psychoactive substances. This filtering step left 828,062 patients as controls.</p><p id="Par8">Modified z-scores [<xref ref-type="bibr" rid="CR21">21</xref>] were calculated for all lab tests and vital signs for the cases and controls. Some values in the EHR data are mistakenly entered, for example, a height of 2376&#x02009;ft was observed. To remove outliers from the case and control populations, all lab tests and vital signs with modified z-scores below &#x02212;2.5 or above 2.5 were removed. Additionally, percentages below 0 or above 100 were removed. After removing outliers, we retained 9518 cases and 707,015 controls.</p><p id="Par9">The distribution of lab tests and vital signs per case contains a large portion of cases with fewer than 20 lab tests and vital signs, while the rest of the lab tests and vital signs per case distribution forms an approximate bell curve (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>a). To retain only cases without sparse data points, cases with fewer than 17 lab tests and vital signs were excluded. This yielded&#x000a0;7797 cases with 889 unique lab tests (838) and vital signs (51); and 191,476 controls. Similarly, lab tests and vital signs with 90% or more missing values across all cases were removed. After these two steps, the distribution of lab tests and vital signs per case was approximately normal (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), leaving a case population of 7797 patients and 109 lab tests and vital signs (94 labs, 15 vitals). 14 lab tests and vital signs had more than 90% missing values in the controls, and these were removed from both the cases and controls, bringing the total number of lab tests and vital signs to 95 (82 labs, 13 vitals). The distribution of lab tests and vital signs per control patient was approximately normal (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). Separate experiments were conducted where sparse lab tests and vital signs were imputed using the mean or the median. Histories of HIV, hepatitis C, and sickle cell disease were considered for case-control matching. As diagnoses of HIV and hepatitis C may happen after a patient was diagnosed with substance dependence, we labeled a patient as having HIV or hepatitis C if the diagnosis was made any time between birth and one year after diagnosis of substance dependence. Age, sex, and gender, along with status of HIV, hepatitis C, and sickle cell disease were used for case-control matching. For selecting an age for each control, the mean age was used from the patient&#x02019;s respective lab tests and vital signs. Disease status was one-hot encoded, and gender was binary encoded. Nearest neighbor by Euclidean distance matching was applied with replacement to match 10 controls to each case. Accounting for matching with replacement, cases were matched to 43,243 unique controls. The data from these cases and matched controls was all recorded between 2000 and 2015. A schematic that illustrates the steps taken in constructing the case and control groups is provided (Additional&#x000a0;file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> Distribution of tests (labs and vitals) per case before filtering. <bold>b</bold> Distribution of tests (labs and vitals) per case after removing patients with less than 17 tests and tests with 90% or greater missing values. <bold>c</bold> Distribution of tests (labs and vitals) per control after removing tests with 90% or greater missing values</p></caption><graphic xlink:href="13040_2019_193_Fig1_HTML" id="MO1"/></fig></p></sec><sec id="Sec4"><title>Methods to compare cases and controls</title><p id="Par10">Using the lab tests and vital signs from the cases and matched controls, median effect sizes were calculated for all 95 lab tests and vital signs. The value of the lab test or vital sign from each case is used to calculate an effect size, then for each lab test or vital sign, the median of these effect sizes is taken. Medians were calculated because they are more robust to outliers. Mean effect sizes were also calculated to check for consistency of their direction. Additionally, we examined the values of the lab tests and vital signs in both cases and controls during the 100&#x02009;days prior to the diagnosis of substance dependence. For comparing these profiles to the controls, we examined the 100&#x02009;days prior to the mean day of their lab tests and vital signs. Finally, diagnoses, prescriptions, and procedures in the five years preceding the first diagnosis of substance dependence were compared to those found in the age matched controls using odds ratios.</p></sec><sec id="Sec5"><title>Opioid prescriptions analysis</title><p id="Par11">To examine opioid prescriptions in the MSMC-EHR, the percentages of patients with at least one or more opioid prescriptions were calculated along with the percentage of total opioid prescriptions. Additionally, the distribution of opioid prescriptions by patient was examined, and a Wilcoxon rank-sum test was applied to quantify the difference between the number of opioid prescriptions given to patients with an opioid dependence prior to the substance abuse diagnosis, and the number of opioid prescriptions given to patients who have at least one opioid prescription, but no history of opioid dependence.</p></sec><sec id="Sec6"><title>Classification of patients by substance dependence status</title><p id="Par12">A Random Forest classifier was implemented with Scikit-learn [<xref ref-type="bibr" rid="CR22">22</xref>] with 100 estimators, a Gini criterion, and a random state of 42. Cases and matched controls were iteratively classified using a bootstrapping procedure. 100 bootstraps of equal size to the case population were sampled from the matched controls, and 10-fold cross-validation was applied on each bootstrap. Area under the receiver operating characteristic curve (AUROC) was&#x000a0;calculated as one way to assess classifier performance [<xref ref-type="bibr" rid="CR23">23</xref>]. Gini importance was measured for each lab test and vital sign to assess the&#x000a0;contribution of each&#x000a0;feature. The 10 lab tests and vital signs (features) with the highest Gini importance were tested, and AUROCs were calculated. 10 random sets of 10 features were tested to determine baseline performance using random lab tests and vital signs. Finally, a dummy classifier making predictions by randomly picking from the population was employed to establish a performance baseline. F1 scores were calculated for all precision-recall combinations along the precision-recall curve, and confusion matrices were calculated using the threshold corresponding to the highest F1 score.</p><p id="Par13">In the experiments using imputation by the mean or the median, classification performance was measured for including all patients, only those with no less than 17 lab tests and vital signs, and only those with less than 17 lab tests and vital signs. Additionally, we ran a test case with patients that had ICD-9 code families in the range of 291&#x02013;293 but did not have ICD-9 codes in the 304.* family. These 291&#x02013;293 ICD codes denote alcohol- and drug-induced mental disorders and withdrawal. Because the data in these analyses had higher dimensionality, i.e., more lab tests and vital signs due to the retention of all patients, only 10 bootstraps of equal size were sampled from the matched controls, and 10-fold cross-validation was conducted on each bootstrap.</p><p id="Par14">The lab tests and vital signs during the 20&#x02009;days prior to the first diagnosis of substance dependence, as well as 10&#x02009;days before and 10&#x02009;days after the first diagnosis, were used as the features to train the main set of classifiers. However, other classifiers were developed using only the diagnoses, prescriptions, and procedures during the 5&#x02009;years prior to the first diagnosis of substance dependence. Furthermore, rather than predicting substance dependence status, we also constructed models to predict non-medical opioid poisoning events, i.e. overdose, denoted by ICD-9 codes 965.0, 965.00, 965.01, 965.02, 965.09, E850.0, E850.1, E850.2, using lab tests and vital signs during the 6&#x02009;months prior to the event.</p></sec></sec><sec id="Sec7"><title>Results</title><sec id="Sec8"><title>Descriptive statistics of the case population</title><p id="Par15">From the 12,112 patient records within the MSMC-EHR that had at least one substance dependence diagnosis, 64.12% were males (7745) and 35.84% were females (4329). Out of these we retained 11,573 cases whose first diagnosis of substance dependence was made at 20&#x02009;years of age or later. The mean age of these patients at their first substance dependence diagnosis was 45.6&#x02009;years, with the youngest patient being 20&#x02009;years old, and the oldest 89.4 (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>). 9528 of these patients had 1,525,293 recorded lab tests and vital signs measurements during the period of 10&#x02009;days before and 10&#x02009;days after their diagnosis of substance dependence. 9518 cases remained after outlier removal. The final case population was obtained after removing patients with less than 17 lab tests and vital signs, leaving 7797 patients. The case population consists of 65.4% males (5103), and 34.6% females (2694). The breakdown of ICD 304.* sub-diagnoses by drug is 53.5% opioids (4168), 19.98% cocaine (1558), 9.4% cannabis (736), 7.0% combo without opioids (547), 4.3% unspecified (337), 3.8% sedatives (295), 2.2, 1.2% amphetamines (94), and 0.8% other (59).<fig id="Fig2"><label>Fig. 2</label><caption><p>Distribution of ages for 11,573 cases given their first substance dependence diagnoses at 20&#x02009;years of age or older</p></caption><graphic xlink:href="13040_2019_193_Fig2_HTML" id="MO2"/></fig></p></sec><sec id="Sec9"><title>Opioid prescriptions in the Mount Sinai EHR</title><p id="Par16">Out of the 880,605 patients that have at least one prescription in the MSMC-EHR, 356,734 patients (40.51%) had at least one opioid prescription. Out of 45,392,334 total prescriptions, 2,029,008 prescriptions (4.47%) were for opioids. While 356,734 patients had at least one opioid prescription, 214,757 had at least two, 155,120 had at least three, 118,208 had at least four, 42,515 had at least five, and 5312 had at least fifty (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>). Prescriptions showed an approximate uniform distribution across ages 20&#x02013;80, with a slight increase for infants, possibly due to newborns born to substance dependent mothers (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Total prescriptions in the EHR steadily increased from the year 2000. For patients with an opioid dependence diagnosis, the average number of days between their first opioid prescription and first diagnosis of opioid dependence was 64&#x02009;days. The median was one day, likely due to patients that are prescribed methadone for the treatment of their previously existing opioid dependence. Patients diagnosed with an opioid use disorder had significantly more opioid prescriptions in the EHR. An average of 26.7 opioid prescriptions were observed for patients with opioid use disorder diagnosis, and an average of 5.27 for patients without opioid use disorder diagnosis (<italic>p</italic>&#x02009;=&#x02009;9.14E-208, Wilcoxon Rank Sum test). In terms of cases and their matched control populations, similar percentages had a prior non-methadone opioid prescription (cases: 24.57%, controls: 24.69%). However, for the patients that had a prior opioid prescription, the case patients had a mean of 13.07 prescriptions, and the controls had a mean of 4.25 prescriptions.<fig id="Fig3"><label>Fig. 3</label><caption><p>Histograms of (<bold>a</bold>) opioid prescriptions per patient, and (<bold>b</bold>) prescriptions per age in years</p></caption><graphic xlink:href="13040_2019_193_Fig3_HTML" id="MO3"/></fig></p></sec><sec id="Sec10"><title>Quantifying differences between the case and control groups</title><p id="Par17">Effect size is a common method to measure differences between measured variables in case and control groups. Lab tests and vital signs with the highest median effect sizes were blood gases (pO2, O2 SAT, pCO2, CO2) and white blood cell (WBC) markers (lymphocytes, basophils) (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). This can be explained by prior observations that indicated that respiratory disturbances are related to pain and pain scores [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. It is also possible that if patients use narcotics, their respiratory rate is suppressed, and this causes their pCO2 to rise. WBC counts have been noted to change in the short term in response to stressors such as surgery and trauma [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. Looking at the 100&#x02009;days prior to diagnosis of substance dependence, pain score ratings are significantly elevated in the cases compared to controls at ~&#x02009;80&#x02009;days prior to diagnosis (Additional&#x000a0;file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>: Figure S2). This prior elevation in pain scores may indicate the typical time from an initial opioid prescription to the point of substance dependence diagnosis. However, it is established that progression from an opioid prescription to a diagnosis of dependence generally takes many months to years. It is alternatively likely, that a high early pain score suggests opioid tolerance, and a diminished threshold for pain.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Top 10 lab tests and vital signs by median effect size</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Lab Test/Vital Sign</th><th>Median Effect Size</th><th>Mean Effect Size</th></tr></thead><tbody><tr><td>Absolute lymphocyte count</td><td>1.103</td><td>1.132</td></tr><tr><td>Oxygen saturation</td><td>1.1</td><td>1.289</td></tr><tr><td>Lymphocytes percentage</td><td>1.1</td><td>1.147</td></tr><tr><td>Partial pressure of oxygen</td><td>1.092</td><td>1.208</td></tr><tr><td>Estimated glomerular filtration rate</td><td>1.056</td><td>1.276</td></tr><tr><td>Total carbon dioxide level</td><td>1.048</td><td>1.067</td></tr><tr><td>Platelet count</td><td>1.045</td><td>1.081</td></tr><tr><td>Carbon dioxide pressure</td><td>1.044</td><td>1.072</td></tr><tr><td>Alkaline phosphatase</td><td>1.036</td><td>1.098</td></tr><tr><td>Aspartate aminotransferase</td><td>1.035</td><td>1.111</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec11"><title>Machine learning classifier to predict opioid dependence</title><p id="Par18">Lab tests and vital signs from the cases and matched controls were used to train various Random Forest classifiers. A bootstrapping method was used to match different sets of controls to equal size of the case population. The initial set of <italic>n</italic>&#x02009;=&#x02009;7797 case patients was achieved by the filtering steps described in the methods. Stratified 10-fold cross-validation was implemented to evaluate the performance of the classifiers.</p></sec><sec id="Sec12"><title>Classifiers that use only labs and vitals dense data without imputation</title><p id="Par19">The initial Random Forest classifier achieved, across 100 bootstraps, each with 10 folds, AUROCs ranging from 0.813&#x02013;0.875, with a mean of 0.846 (Additional&#x000a0;file&#x000a0;<xref rid="MOESM3" ref-type="media">3</xref>: Figure S3A). To select the optimal probability threshold for making a binarized prediction, F1 scores were calculated across all possible threshold values. The probability threshold (0.42) yielded the highest F1 score (0.776) and was used to calculate confusion matrices. The confusion matrix shows that the classifier correctly labeled 67.9% of the controls and 83.8% of the cases (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3B). When only using the lab tests and vital signs with the top 10 highest Gini important features, AUROCs dropped to a range from 0.72&#x02013;0.796, with a mean of 0.76 (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3C). The probability threshold (0.38) that yielded the highest F1 score (0.722) was used to calculate confusion matrices showing the classifier correctly labeled 51.4% of controls and 84% of cases (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3D). Using 10 random sets of 10 features, AUROCs ranged from 0.587&#x02013;0.789, with a mean of 0.72 (Additional&#x000a0;file&#x000a0;<xref rid="MOESM4" ref-type="media">4</xref>: Figure S4A). The probability thresholds across the 10 sets of features ranged from 0.16&#x02013;0.36 that yielded the highest F1 scores in the range of 0.669&#x02013;0.715, were used to calculate confusion matrices showing for each of the 10 sets that showed the classifiers correctly labeled 16.1&#x02013;52.1% of controls and 82.2&#x02013;92.4% of cases (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4B). Additionally, we tested the performance of random predictions from a dummy classifier to establish a baseline classification performance not using any features. AUROCs for all 10 folds ranged from 0.457&#x02013;0.54, with a mean of 0.5 (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4C), and the confusion matrix showed the classifier correctly labeled 50% of controls and 50% of cases (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4D) as expected. The average precision (AP) scores for the classifiers were as follows: 0.843 (all features), 0.744 (top 10 features by Gini), 0.499 (dummy), and the range for the 10 sets of 10 random features was 0.615&#x02013;0.751. Overall this analysis suggests that by using all features, classification improves. The features with the highest mean Gini importance across the 10 folds when using all features are related to white blood cells (lymphocytes, neutrophils), blood-specific measures RCDW, hematocrit, hemoglobin, bilirubin), and protein (total protein, albumin) (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>). These are consistent with boxplots of the Gini importance for the top 20 features (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>) and the raw values for the top nine features (Additional&#x000a0;file&#x000a0;<xref rid="MOESM5" ref-type="media">5</xref>: Figure S5). Additionally, we tested the classification performance using the top 10 lab tests and vital signs by median effect size. These lab tests and vital signs were sparser across patients, and hence performed significantly worse than the top 10 features by Gini importance and <italic>p</italic>-value. The mean AUROC was 0.619, with the confusion matrix showing correct identification of 11.6% of controls and 95.4% of cases.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Top 10 features by Gini importance</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Lab Test/Vital Sign</th><th>Mean Gini</th><th>SD Gini</th><th>Case Mean</th><th>Control Mean</th><th>Case SD</th><th>Control SD</th></tr></thead><tbody><tr><td>Red blood cell distribution width</td><td>0.026</td><td>0.001</td><td>14.620</td><td>14.1</td><td>1.687</td><td>1.592</td></tr><tr><td>Albumin testing g/dL</td><td>0.025</td><td>0.001</td><td>3.793</td><td>3.99</td><td>0.753</td><td>0.749</td></tr><tr><td>Total bilirubin mg/dL</td><td>0.025</td><td>0.002</td><td>0.191</td><td>0.19</td><td>0.115</td><td>0.111</td></tr><tr><td>Lymphocytes percentage</td><td>0.024</td><td>0.001</td><td>25.509</td><td>22.236</td><td>10.253</td><td>10.488</td></tr><tr><td>Total protein g/dL</td><td>0.024</td><td>0.001</td><td>7.181</td><td>7.078</td><td>0.855</td><td>0.832</td></tr><tr><td>Neutrophils percentage</td><td>0.022</td><td>0.001</td><td>63.032</td><td>67.512</td><td>12.542</td><td>12.707</td></tr><tr><td>Phosphorus mg/dL</td><td>0.019</td><td>0.001</td><td>3.608</td><td>3.482</td><td>0.729</td><td>0.742</td></tr><tr><td>Absolute neutrophil count</td><td>0.019</td><td>0.001</td><td>4.826</td><td>5.566</td><td>2.396</td><td>2.674</td></tr><tr><td>Hemoglobin g/dL</td><td>0.018</td><td>0</td><td>12.545</td><td>12.886</td><td>2.021</td><td>2.031</td></tr><tr><td>Hematocrit test</td><td>0.018</td><td>0</td><td>37.164</td><td>38.05</td><td>5.851</td><td>5.892</td></tr></tbody></table></table-wrap><fig id="Fig4"><label>Fig. 4</label><caption><p>Gini importance values for the top 20 features by mean Gini importance</p></caption><graphic xlink:href="13040_2019_193_Fig4_HTML" id="MO4"/></fig></p></sec><sec id="Sec13"><title>Classifiers that use imputed data with all labs and vitals</title><p id="Par20">Because a significant number of lab tests, vital signs, and patients were discarded due to sparsity, an alternative approach is to impute the missing values with expected values. Using the imputation strategies of substituting missing values with the mean or the median yielded similar results. Without imputation, the AUROCs ranged from 0.832&#x02013;0.87, with a mean AUROC of 0.856 (Additional&#x000a0;file&#x000a0;<xref rid="MOESM6" ref-type="media">6</xref>: Figure S6A). The confusion matrix showed that the classifier correctly identified 74.5% of controls and 81% of cases (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S6B). Imputing by the mean, the AUROCs ranged from 0.822&#x02013;0.87, with a mean AUROC of 0.847 (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S6C). The confusion matrix showed that the classifier correctly identified 72.7% of controls and 80.9% of cases (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S6D). Imputing by the median, the AUROCs ranged from 0.824&#x02013;0.867, with a mean of 0.844 (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S6E). The confusion matrix showed that the classifier correctly identified 72.1% of controls and 81% of cases (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S6F).</p></sec><sec id="Sec14"><title>Classifiers that use only dense labs and vitals data with imputation</title><p id="Par21">The imputation strategies increased the AUROC when limiting to the original set of non-sparse patients to patients with at least 17 or more lab tests and vital signs. When retaining only patients with non-sparse data and using no imputation, AUROCs ranged from 0.805&#x02013;0.858, with a mean of 0.835 (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>a). The confusion matrix showed that the classifier correctly identified 65.1% of controls and 84% of cases (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). Retaining non-sparse patients and imputing by the mean, AUROCs improved to 0.902&#x02013;0.931 with a mean of 0.918 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). The confusion matrix showed that the classifier correctly identified 75.8% of controls and 91.7% of cases (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d). Retaining non-sparse patients and imputing by the median, AUROCs improved to 0.899&#x02013;0.933, with a mean of 0.917 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e). The confusion matrix showed the classifier correctly identified 74.7% of controls and 92.4% of cases (Fig. <xref rid="Fig5" ref-type="fig">5</xref>f). Hence, by imputing patients with dense data, we achieved the maximally improved quality predictions.<fig id="Fig5"><label>Fig. 5</label><caption><p>Receiver operating characteristic curves, normalized, and non-normalized confusion matrices for classifiers using no imputation (<bold>a</bold>, <bold>b</bold>), imputation by the mean (<bold>c</bold>, <bold>d</bold>), and imputation by the median (<bold>e</bold>, <bold>f</bold>), retaining only patients with more than 17 labs and vitals</p></caption><graphic xlink:href="13040_2019_193_Fig5_HTML" id="MO5"/></fig></p></sec><sec id="Sec15"><title>Patients with drug or alcohol induced mental disorders as a test case</title><p id="Par22">In constructing our control sample, we excluded patients with a diagnosis of a drug- or alcohol-induced mental disorders, specifically, ICD-9 codes in the range of 291&#x02013;293. Examining these patients as a potential test cases, there were 6573 patients who had these ICD-9 codes, but only 1466 of these patients had the 291&#x02013;293 ICD-9 codes without additional diagnosis in the 304.* family. The classifier predicted that 57.6% of these patients belonged to the case group, compared to 21.3% of an equally-sized set of matched controls, suggesting that patients with drug- or alcohol-induced mental disorders are much more likely to also misuse opioids and develop dependence.</p></sec><sec id="Sec16"><title>Classifiers that use lab test and vital signs from 20&#x02009;day prior to initial diagnosis</title><p id="Par23">So far, all classifiers described used vital signs and lab test from 10&#x02009;day prior to initial diagnosis of substance dependence and 10&#x02009;day post this diagnosis. Next, we modified the cases dataset to include only lab tests and vital signs during the 20&#x02009;days prior to the initial diagnosis of substance dependence. We did this to assess whether the machine learning approach can operate in a practical clinical setting before diagnosis of substance dependence is detected and reported. Without imputation, AUROCs ranged from 0.791&#x02013;0.857, with a mean of 0.833 (Additional&#x000a0;file&#x000a0;<xref rid="MOESM7" ref-type="media">7</xref>: Figure S7A). The confusion matrix showed that the classifier correctly identified 64.4% of controls and 84.5% of cases (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S7B). Imputing by the mean, AUROCs ranged from 0.787&#x02013;0.85, with a mean of 0.823 (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S7C). The confusion matrix showed that the classifier correctly identified 63.8% of controls and 83.1% of cases (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S7D). Imputing by the median, AUROCs ranged from 0.781&#x02013;0.849, with a mean of 0.82 (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S7E). The confusion matrix showed that the classifier correctly identified 66.4% of controls and 81.1% of cases (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S7F). For these classifiers using lab tests and vital signs from 20&#x02009;days prior to diagnosis of substance dependence, the AP scores were as follows: 0.829 (no imputation, Additional&#x000a0;file&#x000a0;<xref rid="MOESM8" ref-type="media">8</xref>: Figure S8A), 0.821 (mean imputation, Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Figure S8B), and 0.818 (median imputation, Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Figure S8C). Hence, we can retain comparable high quality predictions by shifting the window of 20&#x02009;days to those days before initial diagnosis.</p></sec><sec id="Sec17"><title>Classifiers that use diagnoses, prescriptions, and procedures</title><p id="Par24">In addition to predicting substance dependence status from lab tests and vital signs, we also tested whether substance dependence status could be predicted only from 5-year clinical history of diagnoses, prescriptions, and procedures. Total number of diagnoses, prescriptions, and procedures from the 5&#x02009;years before the first diagnosis of substance dependence were classified, with and without imputation. Without imputation, AUROCs ranged from 0.838&#x02013;0.889, with a mean of 0.863 (Additional&#x000a0;file&#x000a0;<xref rid="MOESM9" ref-type="media">9</xref>: Figure S9A). The confusion matrix showed the classifier correctly identified 75.2% of controls and 81.8% of cases (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Figure S9B). Ranking all diagnoses, prescriptions, and procedures by Gini importance, the top 10 features were: methadone prescription, major depression diagnosis, trazodone prescription (used to treat major depression), interview/evaluation procedure, nicotine prescription, sodium chloride prescription, thiamine prescription, HIV diagnosis, lorazepam prescription, and personal history of allergy to penicillin diagnosis. Imputing by the mean, AUROCs ranged from 0.827&#x02013;0.875, with a mean of 0.853 (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Figure S9C). The confusion matrix showed that the classifier correctly identified 72% of controls and 82.4% of cases (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Figure S9D). Imputing by the median, AUROCs ranged from 0.796&#x02013;0.858, with a mean of 0.821 (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Figure S9E). The confusion matrix showed the classifier correctly identified 72.1% of controls and 75.4% of cases (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Figure S9F). For these classifiers, using the 5-year clinical history of diagnoses, prescriptions, and procedures prior to diagnosis of substance dependence, the AP scores were as follows: 0.865 (no imputation, Additional&#x000a0;file&#x000a0;<xref rid="MOESM10" ref-type="media">10</xref>: Figure S10A), 0.849 (mean imputation, Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Figure S10B), and 0.829 (median imputation, Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Figure S10C). Hence, we conclude that this strategy is also highly predictive. The most important features are consistent with the features described below when clinical phenotyping was applied to the original classifiers that utilized vital signs and lab tests.</p></sec><sec id="Sec18"><title>Classifiers that predict overdose</title><p id="Par25">Aside from predicting substance dependence status, we tested whether the diagnosis of a non-medical opioid poisoning, an overdose, could be predicted from lab tests and vital signs from data collected 6&#x02009;months prior to the overdose event, with and without imputation. Lab tests and vital signs from the 6&#x02009;months before the diagnosis of a non-medical opioid poisoning were classified, with and without imputation. Because these cases and control populations were small (477 cases, 4527 matched controls), the results showed more variability. Without imputation, AUROCs ranged from 0.694&#x02013;0.922, with a mean of 0.822 (Additional&#x000a0;file&#x000a0;<xref rid="MOESM11" ref-type="media">11</xref>: Figure S11A). The confusion matrix showed the classifier correctly identified 67.2% of controls and 80.7% of cases (Additional&#x000a0;file&#x000a0;<xref rid="MOESM11" ref-type="media">11</xref>: Figure S11B). Imputing by the mean, AUROCs ranged from 0.69&#x02013;0.951, with a mean of 0.815 (Additional&#x000a0;file&#x000a0;<xref rid="MOESM11" ref-type="media">11</xref>: Figure S11C). The confusion matrix showed that the classifier correctly identified 69.2% of controls and 79.3% of cases (Additional&#x000a0;file&#x000a0;<xref rid="MOESM11" ref-type="media">11</xref>: Figure S11D). Imputing by the median, AUROCs ranged from 0.665&#x02013;0.933, with a mean of 0.811 (Additional&#x000a0;file&#x000a0;<xref rid="MOESM11" ref-type="media">11</xref>: Figure S11E). The confusion matrix showed that the classifier correctly identified 72.1% of controls and 77.5% of cases (Additional&#x000a0;file&#x000a0;<xref rid="MOESM11" ref-type="media">11</xref>: Figure S11F). Overall, these results suggest that non-medical opioid poisoning is somewhat predictive with prior knowledge about vital signs and lab tests. It is expected that with more cases, prediction quality will improve.</p></sec><sec id="Sec19"><title>Clinical phenotyping of cases based on diagnoses, prescriptions, and procedures</title><p id="Par26">The most differentially represented diagnoses during the 5&#x02009;years prior to the diagnosis of substance abuse in the cases were mostly psychiatric, including depression, episodic mood disorder, dysthymic disorder, bipolar disorder, and unspecified psychosis (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>, Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>). This supports the observation that patients with substance abuse are more likely to have psychiatric conditions than non-substance abusers, and these conditions may predispose patient toward substance abuse. Human immunodeficiency virus (HIV) and hepatitis C were overrepresented in the cases. It is known that globally, intravenous drug users are 28 times more likely to contract HIV than the rest of the adult population [<xref ref-type="bibr" rid="CR28">28</xref>]. Intravenous drug use is also responsible for ~&#x02009;90% of new hepatitis C infections [<xref ref-type="bibr" rid="CR29">29</xref>].<fig id="Fig6"><label>Fig. 6</label><caption><p>Scatter plot of 483 diagnoses with statistically significant over- or underrepresentation in the cases compared to the controls measured using the Fisher Exact test. Each point is a diagnosis that was statistically significant. 31 diagnoses have odds ratios&#x000a0;of less than 1</p></caption><graphic xlink:href="13040_2019_193_Fig6_HTML" id="MO6"/></fig><table-wrap id="Tab3"><label>Table 3</label><caption><p>Top 10 differentially represented diagnoses during the 5&#x02009;years prior to diagnosis of substance abuse (ranked by odds ratio)</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Diagnosis</th><th>Odds ratio</th><th><italic>p</italic>-value (Bonferroni-corrected)</th></tr></thead><tbody><tr><td>Unspecified episodic mood disorder</td><td>11.779</td><td>1.03E-138</td></tr><tr><td>Dysthymic disorder</td><td>6.209</td><td>1.48E-114</td></tr><tr><td>Depressive disorder, not elsewhere classified</td><td>6.081</td><td>0</td></tr><tr><td>Personal history of noncompliance with medical treatment, presenting hazards to health</td><td>5.933</td><td>4.29E-107</td></tr><tr><td>Other unknown and unspecified cause of morbidity and mortality</td><td>4.896</td><td>2.69E-112</td></tr><tr><td>Accidents occurring in unspecified place</td><td>4.845</td><td>9.87E-110</td></tr><tr><td>Pain in limb</td><td>4.565</td><td>1.66E-112</td></tr><tr><td>Cough</td><td>4.54</td><td>9.00E-115</td></tr><tr><td>Lumbago</td><td>4.301</td><td>1.54E-110</td></tr><tr><td>Human immunodeficiency virus [HIV] disease</td><td>3.467</td><td>1.28E-136</td></tr></tbody></table></table-wrap></p><p id="Par27">Medical non-adherence, a condition where patients do not follow therapeutic recommendations, is overrepresented in the cases. This finding may support a socioeconomic difficulty in adhering to medical advice, or general apathy to medical treatment, or a refusal to take alternative medications that are not opioids, or a refusal for any psychiatric treatment. Lumbago, an older term for low back pain, is also overrepresented in the cases. Patients with lumbago are often treated with opioids, and may become addicted; or conversely, opioid users with correspondingly lower thresholds for pain may present to clinics or emergency departments with lumbago. Other pain-related diagnoses are also overrepresented in the cases. These include limb pain (OR&#x02009;=&#x02009;4.56, <italic>p</italic>&#x02009;=&#x02009;1.66E-112), backache (OR&#x02009;=&#x02009;4.04, <italic>p</italic>&#x02009;=&#x02009;5.82E-75), abdominal pain (OR&#x02009;=&#x02009;2.68, <italic>p</italic>&#x02009;=&#x02009;5.23E-66), chronic pain (OR&#x02009;=&#x02009;6.47, <italic>p</italic>&#x02009;=&#x02009;6.32E-63), chest pain (OR&#x02009;=&#x02009;1.95, <italic>p</italic>&#x02009;=&#x02009;3.49E-43), and others. Diagnoses underrepresented in the cases include those related with pregnancy, such as &#x0201c;supervision of other normal pregnancy,&#x0201d; &#x0201c;outcome of delivery, single liveborn,&#x0201d; and &#x0201c;post term pregnancy, delivered, with or without mention of antepartum condition.&#x0201d; This is related to the suggestion that pregnant patients are among the least likely to seek care from multiple institutions, while HIV and chronic pain patients are among the most likely to seek care from multiple institutions [<xref ref-type="bibr" rid="CR30">30</xref>].</p><p id="Par28">Among prescriptions that are differentially represented during the 5&#x02009;years prior to the first diagnosis of substance abuse in the cases are nicotine patches. It was previously reported that 85&#x02013;98% of patients undergoing methadone maintenance treatment consume tobacco [<xref ref-type="bibr" rid="CR31">31</xref>]. Other differentially represented medications among cases include the psychoactive medication trazodone, as well as the &#x0201c;banana bag&#x0201d; cocktail of thiamine, folic acid, and multivitamins with sodium chloride, given to malnourished alcohol users [<xref ref-type="bibr" rid="CR32">32</xref>]. Important to note, these are not prescriptions but rather inpatient orders. Other prescriptions are for methadone and lorazepam. Lorazepam is an anxiety medication that is also used for alcohol withdrawal symptoms (Table&#x000a0;<xref rid="Tab4" ref-type="table">4</xref>). Prescriptions underrepresented in the cases included cefazolin, an antibiotic; ondansetron, a 5HT-3 antagonist used as an anti-emetic; and midazolam, a short-acting sedative. Midazolam is a benzo, just like lorazepam, but shorter-acting. Lorazepam is given to alcohol withdrawal patients and agitated patients, while midazolam is given for procedural sedation such as shoulder dislocation, or lumbar puncture. Medical procedures that are differentially represented during the 5&#x02009;years prior to the diagnosis of substance abuse in the cases are various forms of evaluations and interviews, in agreement with the overrepresentation of psychiatric diagnoses (Table&#x000a0;<xref rid="Tab5" ref-type="table">5</xref>).<table-wrap id="Tab4"><label>Table 4</label><caption><p>Top 10 differentially represented prescriptions during the 5&#x02009;years prior to diagnosis of substance abuse (ranked by odds ratio)</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Prescription</th><th>Odds ratio</th><th><italic>p</italic>-value (Bonferroni-corrected)</th></tr></thead><tbody><tr><td>Methadone</td><td>45.956</td><td>0</td></tr><tr><td>Nicotine</td><td>26.239</td><td>0</td></tr><tr><td>Thiamine</td><td>12.861</td><td>1.58E-277</td></tr><tr><td>quetiapine</td><td>11.553</td><td>3.27E-241</td></tr><tr><td>Trazodone</td><td>9.863</td><td>0</td></tr><tr><td>Clonazepam</td><td>8.38</td><td>7.21E-165</td></tr><tr><td>Haloperidol</td><td>6.82</td><td>8.28E-178</td></tr><tr><td>Folic Acid</td><td>5.28</td><td>5.03E-202</td></tr><tr><td>Lorazepam</td><td>4.745</td><td>2.02E-231</td></tr><tr><td>Ibuprofen</td><td>4.64</td><td>2.58E-202</td></tr></tbody></table></table-wrap><table-wrap id="Tab5"><label>Table 5</label><caption><p>Top 10 differentially represented procedures during the 5&#x02009;years prior to diagnosis of substance abuse (ranked by odds ratio)</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Procedure</th><th>Odds ratio</th><th>p-value (Bonferroni-corrected)</th></tr></thead><tbody><tr><td>Other group therapy</td><td>19.8</td><td>1.23E-69</td></tr><tr><td>Interview &#x00026; Evaluation NEC</td><td>11.578</td><td>4.06E-42</td></tr><tr><td>Psychiatric Mental Determination</td><td>10.597</td><td>1.24E-29</td></tr><tr><td>Exploratory verbal psychotherapy</td><td>10.371</td><td>2.41E-57</td></tr><tr><td>Brief interview &#x00026; evaluation</td><td>6.224</td><td>9.00E-201</td></tr><tr><td>Limited interview/evaluation</td><td>5.804</td><td>2.71E-279</td></tr><tr><td>Interview &#x00026; evaluation NOS</td><td>5.745</td><td>6.16E-102</td></tr><tr><td>Comprehensive interview/evaluation</td><td>5.065</td><td>1.71E-147</td></tr><tr><td>Other counselling</td><td>4.3</td><td>3.93E-36</td></tr><tr><td>Other fetal monitoring</td><td>0.218</td><td>1.14E-30</td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec20"><title>Discussion</title><p id="Par29">Using lab tests and vital signs proximal to the diagnosis date of substance dependence as input, we tested the ability of a Random Forest machine learning classifier to predict whether a patient will be diagnosed with substance dependence. Using a baseline of 50/50 chance to diagnose a patient as substance dependent, the best classifier performed well above chance. The best classifier correctly predicted whether a patient is not substance-dependent ~&#x02009;76% of the times, and whether a patient is a substance-dependent ~&#x02009;92% of the times. While these results are promising, there is room for improvement before a clinical implementation. The measurements that distinguished substance-dependent patients from non-substance dependent patients, as determined by effect size, Gini importance, or by the Wilcoxon rank-sum test, were mostly related to white blood cells, protein, blood gases, blood volume and blood cell width. The relationships between these lab tests and vital signs in the context of substance dependence diagnosis can be explained. It is encouraging that the laboratory results and vital signs identified by the classifier have well-known relationships to pain syndromes and opioid use. Respiratory rate, for instance, has been shown to be elevated in many painful conditions, and decreased in opioid overdose. Respiratory rate will directly affect blood gases. White blood cell counts have also been shown to fluctuate in response to trauma and surgery, with a decline in lymphocytes and an increase in polymorphonuclear leukocytes (PMNs). Compared to the substance-dependent cases, our control cohort showed the same pattern as prior studies of trauma patients. In addition to classification using clinical measures, we attempted to classify patients with, as well as examined the prevalence of, diagnoses, prescriptions, and procedures in the case and control populations during the five years before diagnosis of substance dependence. The diagnoses most overrepresented were psychiatric, supporting the close association between substance abuse and psychiatric comorbidities as reported before [<xref ref-type="bibr" rid="CR7">7</xref>&#x02013;<xref ref-type="bibr" rid="CR10">10</xref>]. Agreeing with this, the medical procedures most overrepresented in the cases were various types of psychiatric evaluations and interviews. The prescriptions most overrepresented in the cases were related to opioid treatment and malnourishment, as many drug abusers arrive at the hospital in a malnourished state. Examining all opioid prescriptions in the MSMC-EHR, opioids were prescribed to a large portion of patients, and patients diagnosed with an opioid use disorder had significantly more opioid prescriptions than patients who were given few opioid prescriptions. Future work may include other features for predicting substance dependence status. These can be combined with the clinical features we already used here. Additionally, other machine learning methods such as deep learning may perform better than the Random Forest classifier we employed. The case and control populations could also be made larger by integrating other EHR systems. It is possible that results will vary when examining distinct populations across hospitals in different cities and countries. The current study is focused on patients with diagnoses in the 304 family (drug dependence), but there are other ICD-9 families related to drug abuse. The 305 family, which denotes non-dependent substance abuse, was commonly used for patients with alcohol and tobacco use disorders. For this reason, we focused on the 304 family of ICD-9 diagnoses. Finally, future studies can examine gene variants that are enriched in the cases compared to the controls. Such analysis can identify genetics variants that may influence propensity for drug abuse and at the same time point further to mechanisms of action. The machine learning classifiers developed here can increase the size of the case population to improve the statistical power needed to identify true variants.</p></sec><sec id="Sec21"><title>Conclusions</title><p id="Par30">Through analyzing of the health records of hundreds of thousands individuals in the MSMC-EHR with a machine learning framework, we furthered characterized opioid dependent patients using physiological measurements. We found that opioid dependent patients have significantly higher WBC and respiratory disturbances. Opioid dependent patients are also commonly malnourished which is characterized by low RCDW and blood albumin compared to controls. Clinical phenotyping analysis discovered that opioid dependent patients are more likely to suffer from psychiatric disorders and manifest pain-related symptoms. The predictive model may hold utility for identifying patients at risk of developing dependence, risk of overdose, and opioid-seeking patients that report other symptoms in their visits to the emergency room. It should be noted that marking a patient with an opioid dependency ICD code, which is commonly used for insurance purposes, is often inaccurate and inconclusive. Hence, we recommend that the results from our study should be considered preliminary, and the quality of the real cases disputable. The study should be validated by other independent EHR systems and different computational approaches. Regardless, the multi-variate non-linear characteristic of the classifiers developed here, combine unique mixture of the values of many measured variables together to produce predictions not possible by looking at a single biomarker. The complex relationships between measured variables would be difficult to detect via an in-person clinical assessment alone. Hence, the predictive machine learning classifiers we developed can alert physicians about the potential of patients to have opioid dependency from routine lab tests and vital signs. However, there are still technical, administrative, and bureaucratic barriers for real implementation.</p></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec22"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="13040_2019_193_MOESM1_ESM.pdf"><label>Additional file 1:</label><caption><p><bold>Figure S1.</bold> Flowchart illustrating the steps of the creating the case and control populations. (PDF 131 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="13040_2019_193_MOESM2_ESM.pdf"><label>Additional file 2:</label><caption><p><bold>Figure S2.</bold> Pain score ratings for cases (purple) and controls (gray) during the 100&#x02009;days prior to diagnosis of substance dependence. For the controls, the 100&#x02009;days are from prior to their mean day of analyzed lab tests and vital signs. The lines represent a moving average. (PDF 104 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="13040_2019_193_MOESM3_ESM.pdf"><label>Additional file 3:</label><caption><p><bold>Figure S3.</bold> Receiver operating characteristic curves, normalized, and non-normalized confusion matrices for classifiers using all features (A, B), the top 10 by Gini importance (C, D), and the top 10 by <italic>p</italic>-value from the Wilcoxon rank-sum test (E, F). (PDF 419 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM4"><media xlink:href="13040_2019_193_MOESM4_ESM.pdf"><label>Additional file 4:</label><caption><p><bold>Figure S4.</bold> Receiver operating characteristic curves, normalized, and non-normalized confusion matrices for a classifier using 10 sets of 10 random features (1/10 are shown) (A, B), and a dummy classifier outputting random predictions (C, D). (PDF 44 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM5"><media xlink:href="13040_2019_193_MOESM5_ESM.pdf"><label>Additional file 5:</label><caption><p><bold>Figure S5.</bold> Raw values for cases and matched controls of the top 9 lab tests and vital signs by mean Gini importance. (PDF 174 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM6"><media xlink:href="13040_2019_193_MOESM6_ESM.pdf"><label>Additional file 6:</label><caption><p><bold>Figure S6.</bold> Receiver operating characteristic curves, normalized, and non-normalized confusion matrices for classifiers using no imputation (A, B), imputation by the mean (C, D), and imputation by the median (E, F). (PDF 602 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM7"><media xlink:href="13040_2019_193_MOESM7_ESM.pdf"><label>Additional file 7:</label><caption><p><bold>Figure S7.</bold> Receiver operating characteristic curves, normalized, and non-normalized confusion matrices for labs and vitals from the 20&#x02009;days prior to substance dependence diagnosis, classified using no imputation (A, B), imputation by the mean (C, D), and imputation by the median (E, F). (PDF 1335 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM8"><media xlink:href="13040_2019_193_MOESM8_ESM.pdf"><label>Additional file 8:</label><caption><p><bold>Figure S8.</bold> Precision-recall curves for labs and vitals from the 20&#x02009;days prior to substance dependence diagnosis, using classifiers with no imputation (A), imputation by the mean (B), imputation by the median (C). (PDF 199 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM9"><media xlink:href="13040_2019_193_MOESM9_ESM.pdf"><label>Additional file 9:</label><caption><p><bold>Figure S9.</bold> Receiver operating characteristic curves, normalized, and non-normalized confusion matrices for diagnoses, prescriptions, and procedures from the 5&#x02009;years prior to substance dependence diagnosis, classified using no imputation (A, B), imputation by the mean (C, D), and imputation by the median (E, F). (PDF 596 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM10"><media xlink:href="13040_2019_193_MOESM10_ESM.pdf"><label>Additional file 10:</label><caption><p><bold>Figure S10.</bold> Precision-recall curves for classifiers using diagnoses, prescriptions, and procedures from the 5&#x02009;years to substance dependence diagnosis, with no imputation (A), imputation by the mean (B), imputation by the median (C). (PDF 212 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM11"><media xlink:href="13040_2019_193_MOESM11_ESM.pdf"><label>Additional file 11:</label><caption><p><bold>Figure S11.</bold> Receiver operating characteristic curves, normalized, and non-normalized confusion matrices for lab tests and vital signs from the 6&#x02009;months prior to opioid poisoning diagnosis, classified using no imputation (A, B), imputation by the mean (C, D), and imputation by the median (E, F). (PDF 597 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><ack><title>Acknowledgements</title><p>We thank the Dudley Lab at Mount Sinai for sharing their processed de-identified MSMC-EHR dataset with us for this project.</p><sec id="FPar1"><title>Funding</title><p id="Par31">This work is supported by NIH grants U54-HL127624 (LINCS-DCIC), U24-CA224260 (IDG-KMC), and OT3-OD025467 (NIH Data Commons).</p></sec><sec id="FPar2" sec-type="data-availability"><title>Availability of data and materials</title><p id="Par32">None available.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>AM conceived and managed the research project. RJE and ZW performed all the analyses. NG provided clinical implications and interpretations. RJE, ZW, NG and AM wrote the manuscript. All authors read and approved the final manuscript.</p></notes><notes notes-type="COI-statement"><sec id="FPar3"><title>Ethics approval and consent to participate</title><p>This study has been granted exemption from human-subject research by the Program for the Protection of Human Subjects (PPHS) at the Institutional Review Boards (IRB), Mount Sinai Health System. The project number is HS#:18&#x02013;00993.</p></sec><sec id="FPar4"><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec id="FPar5"><title>Publisher&#x02019;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><mixed-citation publication-type="other">Rudd RA. Increases in drug and opioid-involved overdose deaths&#x02014;United States, 2010&#x02013;2015. MMWR Morb Mortal Wkly Rep. 2016;65(50-51):1445&#x02013;52.</mixed-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Florence</surname><given-names>C</given-names></name><name><surname>Luo</surname><given-names>F</given-names></name><name><surname>Xu</surname><given-names>L</given-names></name><name><surname>Zhou</surname><given-names>C</given-names></name></person-group><article-title>The economic burden of prescription opioid overdose, abuse and dependence in the United States, 2013</article-title><source>Med Care</source><year>2016</year><volume>54</volume><issue>10</issue><fpage>901</fpage><pub-id pub-id-type="doi">10.1097/MLR.0000000000000625</pub-id><pub-id pub-id-type="pmid">27623005</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiner</surname><given-names>SG</given-names></name><name><surname>Griggs</surname><given-names>CA</given-names></name><name><surname>Mitchell</surname><given-names>PM</given-names></name><name><surname>Langlois</surname><given-names>BK</given-names></name><name><surname>Friedman</surname><given-names>FD</given-names></name><name><surname>Moore</surname><given-names>RL</given-names></name><name><surname>Lin</surname><given-names>SC</given-names></name><name><surname>Nelson</surname><given-names>KP</given-names></name><name><surname>Feldman</surname><given-names>JA</given-names></name></person-group><article-title>Clinician impression versus prescription drug monitoring program criteria in the assessment of drug-seeking behavior in the emergency department</article-title><source>Ann Emerg Med</source><year>2013</year><volume>62</volume><issue>4</issue><fpage>281</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1016/j.annemergmed.2013.05.025</pub-id><pub-id pub-id-type="pmid">23849618</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Longo</surname><given-names>LP</given-names></name><name><surname>Parran</surname><given-names>JT</given-names></name><name><surname>Johnson</surname><given-names>B</given-names></name><name><surname>Kinsey</surname><given-names>W</given-names></name></person-group><article-title>Addiction: part II. Identification and management of the drug-seeking patient</article-title><source>Am Fam Physician</source><year>2000</year><volume>61</volume><issue>8</issue><fpage>2401</fpage><lpage>2408</lpage><?supplied-pmid 10794581?><pub-id pub-id-type="pmid">10794581</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pretorius</surname><given-names>RW</given-names></name><name><surname>Zurick</surname><given-names>GM</given-names></name></person-group><article-title>A systematic approach to identifying drug-seeking patients</article-title><source>Fam Pract Manag</source><year>2008</year><volume>15</volume><issue>4</issue><fpage>3</fpage></element-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="other">Moeller KE, Lee KC, Kissack JC. Urine drug screening: practical guide for clinicians. Mayo Clin Proc. 2008;92(5);774&#x02013;96.</mixed-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ciesielski</surname><given-names>T</given-names></name><name><surname>Iyengar</surname><given-names>R</given-names></name><name><surname>Bothra</surname><given-names>A</given-names></name><name><surname>Tomala</surname><given-names>D</given-names></name><name><surname>Cislo</surname><given-names>G</given-names></name><name><surname>Gage</surname><given-names>BF</given-names></name></person-group><article-title>A tool to assess risk of de novo opioid abuse or dependence</article-title><source>Am J Med</source><year>2016</year><volume>129</volume><issue>7</issue><fpage>699</fpage><lpage>705</lpage><pub-id pub-id-type="doi">10.1016/j.amjmed.2016.02.014</pub-id><pub-id pub-id-type="pmid">26968469</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rice</surname><given-names>JB</given-names></name><name><surname>White</surname><given-names>AG</given-names></name><name><surname>Birnbaum</surname><given-names>HG</given-names></name><name><surname>Schiller</surname><given-names>M</given-names></name><name><surname>Brown</surname><given-names>DA</given-names></name><name><surname>Roland</surname><given-names>CL</given-names></name></person-group><article-title>A model to identify patients at risk for prescription opioid abuse, dependence, and misuse</article-title><source>Pain Med</source><year>2012</year><volume>13</volume><issue>9</issue><fpage>1162</fpage><lpage>1173</lpage><pub-id pub-id-type="doi">10.1111/j.1526-4637.2012.01450.x</pub-id><pub-id pub-id-type="pmid">22845054</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cochran</surname><given-names>BN</given-names></name><name><surname>Flentje</surname><given-names>A</given-names></name><name><surname>Heck</surname><given-names>NC</given-names></name><name><surname>Van Den Bos</surname><given-names>J</given-names></name><name><surname>Perlman</surname><given-names>D</given-names></name><name><surname>Torres</surname><given-names>J</given-names></name><name><surname>Valuck</surname><given-names>R</given-names></name><name><surname>Carter</surname><given-names>J</given-names></name></person-group><article-title>Factors predicting development of opioid use disorders among individuals who receive an initial opioid prescription: mathematical modeling using a database of commercially-insured individuals</article-title><source>Drug Alcohol Depend</source><year>2014</year><volume>138</volume><fpage>202</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1016/j.drugalcdep.2014.02.701</pub-id><pub-id pub-id-type="pmid">24679839</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dufour</surname><given-names>R</given-names></name><name><surname>Mardekian</surname><given-names>J</given-names></name><name><surname>Pasquale</surname><given-names>MK</given-names></name><name><surname>Schaaf</surname><given-names>D</given-names></name><name><surname>Andrews</surname><given-names>GA</given-names></name><name><surname>Patel</surname><given-names>NC</given-names></name></person-group><article-title>Understanding predictors of opioid abuse: predictive model development and validation</article-title><source>Am J Pharm Benefits</source><year>2014</year><volume>6</volume><issue>5</issue><fpage>208</fpage><lpage>216</lpage></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hylan</surname><given-names>TR</given-names></name><name><surname>Von Korff</surname><given-names>M</given-names></name><name><surname>Saunders</surname><given-names>K</given-names></name><name><surname>Masters</surname><given-names>E</given-names></name><name><surname>Palmer</surname><given-names>RE</given-names></name><name><surname>Carrell</surname><given-names>D</given-names></name><name><surname>Cronkite</surname><given-names>D</given-names></name><name><surname>Mardekian</surname><given-names>J</given-names></name><name><surname>Gross</surname><given-names>D</given-names></name></person-group><article-title>Automated prediction of risk for problem opioid use in a primary care setting</article-title><source>J Pain</source><year>2015</year><volume>16</volume><issue>4</issue><fpage>380</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1016/j.jpain.2015.01.011</pub-id><pub-id pub-id-type="pmid">25640294</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Casey</surname><given-names>JA</given-names></name><name><surname>Schwartz</surname><given-names>BS</given-names></name><name><surname>Stewart</surname><given-names>WF</given-names></name><name><surname>Adler</surname><given-names>NE</given-names></name></person-group><article-title>Using electronic health records for population health research: a review of methods and applications</article-title><source>Annu Rev Public Health</source><year>2016</year><volume>37</volume><fpage>61</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1146/annurev-publhealth-032315-021353</pub-id><pub-id pub-id-type="pmid">26667605</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miotto</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Kidd</surname><given-names>BA</given-names></name><name><surname>Dudley</surname><given-names>JT</given-names></name></person-group><article-title>Deep patient: an unsupervised representation to predict the future of patients from the electronic health records</article-title><source>Sci Rep</source><year>2016</year><volume>6</volume><fpage>26094</fpage><pub-id pub-id-type="doi">10.1038/srep26094</pub-id><pub-id pub-id-type="pmid">27185194</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Denny</surname><given-names>JC</given-names></name></person-group><article-title>Mining electronic health records in the genomics era</article-title><source>PLoS Comput Biol</source><year>2012</year><volume>8</volume><issue>12</issue><fpage>e1002823</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002823</pub-id><pub-id pub-id-type="pmid">23300414</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Osborn</surname><given-names>DP</given-names></name><name><surname>Hardoon</surname><given-names>S</given-names></name><name><surname>Omar</surname><given-names>RZ</given-names></name><name><surname>Holt</surname><given-names>RI</given-names></name><name><surname>King</surname><given-names>M</given-names></name><name><surname>Larsen</surname><given-names>J</given-names></name><name><surname>Marston</surname><given-names>L</given-names></name><name><surname>Morris</surname><given-names>RW</given-names></name><name><surname>Nazareth</surname><given-names>I</given-names></name><name><surname>Walters</surname><given-names>K</given-names></name></person-group><article-title>Cardiovascular risk prediction models for people with severe mental illness: results from the prediction and management of cardiovascular risk in people with severe mental illnesses (PRIMROSE) research program</article-title><source>JAMA psychiatry</source><year>2015</year><volume>72</volume><issue>2</issue><fpage>143</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1001/jamapsychiatry.2014.2133</pub-id><pub-id pub-id-type="pmid">25536289</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCoy</surname><given-names>TH</given-names></name><name><surname>Castro</surname><given-names>VM</given-names></name><name><surname>Rosenfield</surname><given-names>HR</given-names></name><name><surname>Cagan</surname><given-names>A</given-names></name><name><surname>Kohane</surname><given-names>IS</given-names></name><name><surname>Perlis</surname><given-names>RH</given-names></name></person-group><article-title>A clinical perspective on the relevance of research domain criteria in electronic health records</article-title><source>Am J Psychiatr</source><year>2015</year><volume>172</volume><issue>4</issue><fpage>316</fpage><lpage>320</lpage><pub-id pub-id-type="doi">10.1176/appi.ajp.2014.14091177</pub-id><pub-id pub-id-type="pmid">25827030</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>P</given-names></name><name><surname>Tran</surname><given-names>T</given-names></name><name><surname>Wickramasinghe</surname><given-names>N</given-names></name><name><surname>Venkatesh</surname><given-names>S</given-names></name></person-group><article-title>$\mathtt {Deepr} $: a convolutional net for medical records</article-title><source>IEEE J Biomed Health Inform</source><year>2017</year><volume>21</volume><issue>1</issue><fpage>22</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1109/JBHI.2016.2633963</pub-id><pub-id pub-id-type="pmid">27913366</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajkomar</surname><given-names>A</given-names></name><name><surname>Oren</surname><given-names>E</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Dai</surname><given-names>AM</given-names></name><name><surname>Hajaj</surname><given-names>N</given-names></name><name><surname>Hardt</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>PJ</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Marcus</surname><given-names>J</given-names></name><name><surname>Sun</surname><given-names>M</given-names></name></person-group><article-title>Scalable and accurate deep learning with electronic health records</article-title><source>npj Digit Med</source><year>2018</year><volume>1</volume><issue>1</issue><fpage>18</fpage><pub-id pub-id-type="doi">10.1038/s41746-018-0029-1</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Glicksberg</surname><given-names>BS</given-names></name><name><surname>Israel</surname><given-names>A</given-names></name><name><surname>Dudley</surname><given-names>JT</given-names></name><name><surname>Ma'ayan</surname><given-names>A</given-names></name></person-group><article-title>Predicting age by mining electronic medical records with deep learning characterizes differences between chronological and physiological age</article-title><source>J Biomed Inform</source><year>2017</year><volume>76</volume><fpage>59</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1016/j.jbi.2017.11.003</pub-id><pub-id pub-id-type="pmid">29113935</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slee</surname><given-names>VN</given-names></name></person-group><article-title>The international classification of diseases: ninth revision (ICD-9)</article-title><source>Ann Intern Med</source><year>1978</year><volume>88</volume><issue>3</issue><fpage>424</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.7326/0003-4819-88-3-424</pub-id><pub-id pub-id-type="pmid">629506</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">Iglewicz B, Hoaglin DC. How to detect and handle outliers. Milwaukee: Asq Press; 1993. vol. 16.</mixed-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F</given-names></name><name><surname>Varoquaux</surname><given-names>G</given-names></name><name><surname>Gramfort</surname><given-names>A</given-names></name><name><surname>Michel</surname><given-names>V</given-names></name><name><surname>Thirion</surname><given-names>B</given-names></name><name><surname>Grisel</surname><given-names>O</given-names></name><name><surname>Blondel</surname><given-names>M</given-names></name><name><surname>Prettenhofer</surname><given-names>P</given-names></name><name><surname>Weiss</surname><given-names>R</given-names></name><name><surname>Dubourg</surname><given-names>V</given-names></name></person-group><article-title>Scikit-learn: machine learning in python</article-title><source>J Mach Learn Res</source><year>2011</year><volume>12</volume><issue>Oct</issue><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanley</surname><given-names>JA</given-names></name><name><surname>McNeil</surname><given-names>BJ</given-names></name></person-group><article-title>The meaning and use of the area under a receiver operating characteristic (ROC) curve</article-title><source>Radiology</source><year>1982</year><volume>143</volume><issue>1</issue><fpage>29</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1148/radiology.143.1.7063747</pub-id><pub-id pub-id-type="pmid">7063747</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mimica</surname><given-names>&#x0017d;</given-names></name><name><surname>Pogoreli&#x00107;</surname><given-names>Z</given-names></name><name><surname>Perko</surname><given-names>Z</given-names></name><name><surname>Sr&#x00161;en</surname><given-names>D</given-names></name><name><surname>Stipi&#x00107;</surname><given-names>R</given-names></name><name><surname>Dujmovi&#x00107;</surname><given-names>D</given-names></name></person-group><article-title>Effect of surgical incision on pain and respiratory function after abdominal surgery: a randomized clinical trial</article-title><source>Hepato-Gastroenterology</source><year>2007</year><volume>54</volume><issue>80</issue><fpage>2216</fpage><lpage>2220</lpage><?supplied-pmid 18265636?><pub-id pub-id-type="pmid">18265636</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nishino</surname><given-names>T</given-names></name><name><surname>Shimoyama</surname><given-names>N</given-names></name><name><surname>Ide</surname><given-names>T</given-names></name><name><surname>Isono</surname><given-names>S</given-names></name></person-group><article-title>Experimental pain augments experimental dyspnea, but not vice versa in human volunteers</article-title><source>Anesthesiology</source><year>1999</year><volume>91</volume><issue>6</issue><fpage>1633</fpage><pub-id pub-id-type="doi">10.1097/00000542-199912000-00014</pub-id><pub-id pub-id-type="pmid">10598604</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>KIROV</surname><given-names>SM</given-names></name><name><surname>Shepherd</surname><given-names>J</given-names></name><name><surname>Donald</surname><given-names>K</given-names></name></person-group><article-title>Intraoperative and postoperative changes in peripheral white blood cell counts: the contribution of stress</article-title><source>Aust N Z J Surg</source><year>1979</year><volume>49</volume><issue>6</issue><fpage>738</fpage><lpage>742</lpage><pub-id pub-id-type="doi">10.1111/j.1445-2197.1979.tb06505.x</pub-id><pub-id pub-id-type="pmid">294270</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Toft</surname><given-names>P</given-names></name><name><surname>Svendsen</surname><given-names>P</given-names></name><name><surname>Tonnesen</surname><given-names>E</given-names></name><name><surname>Jw</surname><given-names>R</given-names></name><name><surname>Christensen</surname><given-names>N</given-names></name></person-group><article-title>Redistribution of lymphocytes after major surgical stress</article-title><source>Acta Anaesthesiol Scand</source><year>1993</year><volume>37</volume><issue>3</issue><fpage>245</fpage><lpage>249</lpage><pub-id pub-id-type="doi">10.1111/j.1399-6576.1993.tb03708.x</pub-id><pub-id pub-id-type="pmid">8517098</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cook</surname><given-names>C</given-names></name><name><surname>Murphy</surname><given-names>F</given-names></name><name><surname>Phelan</surname><given-names>M</given-names></name><name><surname>Sander</surname><given-names>G</given-names></name><name><surname>Stone</surname><given-names>K</given-names></name></person-group><source>The case for a harm reduction decade: progress, potential and paradigm shifts: harm reduction international</source><year>2016</year></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hellard</surname><given-names>M</given-names></name><name><surname>Sacks-Davis</surname><given-names>R</given-names></name><name><surname>Gold</surname><given-names>J</given-names></name></person-group><article-title>Hepatitis C treatment for injection drug users: a review of the available evidence</article-title><source>Clin Infect Dis</source><year>2009</year><volume>49</volume><issue>4</issue><fpage>561</fpage><lpage>573</lpage><pub-id pub-id-type="doi">10.1086/600304</pub-id><pub-id pub-id-type="pmid">19589081</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="other">Grinspan ZM, Abramson EL, Banerjee S, Kern LM, Kaushal R, Shapiro JS. Potential value of health information exchange for people with epilepsy: crossover patterns and missing clinical data. In: AMIA Annual Symposium Proceedings (Washington, DC): 2013. American Medical Informatics Association: 527.</mixed-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richter</surname><given-names>KP</given-names></name><name><surname>Gibson</surname><given-names>CA</given-names></name><name><surname>Ahluwalia</surname><given-names>JS</given-names></name><name><surname>Schmelzle</surname><given-names>KH</given-names></name></person-group><article-title>Tobacco use and quit attempts among methadone maintenance clients</article-title><source>Am J Public Health</source><year>2001</year><volume>91</volume><issue>2</issue><fpage>296</fpage><pub-id pub-id-type="doi">10.2105/AJPH.91.2.296</pub-id><pub-id pub-id-type="pmid">11211643</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flannery</surname><given-names>AH</given-names></name><name><surname>Adkins</surname><given-names>DA</given-names></name><name><surname>Cook</surname><given-names>AM</given-names></name></person-group><article-title>Unpeeling the evidence for the banana bag: evidence-based recommendations for the management of alcohol-associated vitamin and electrolyte deficiencies in the ICU</article-title><source>Crit Care Med</source><year>2016</year><volume>44</volume><issue>8</issue><fpage>1545</fpage><lpage>1552</lpage><pub-id pub-id-type="doi">10.1097/CCM.0000000000001659</pub-id><pub-id pub-id-type="pmid">27002274</pub-id></element-citation></ref></ref-list></back></article>