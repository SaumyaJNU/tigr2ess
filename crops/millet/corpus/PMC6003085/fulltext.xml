<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Plant Biol</journal-id><journal-id journal-id-type="iso-abbrev">BMC Plant Biol</journal-id><journal-title-group><journal-title>BMC Plant Biology</journal-title></journal-title-group><issn pub-type="epub">1471-2229</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6003085</article-id><article-id pub-id-type="publisher-id">1316</article-id><article-id pub-id-type="doi">10.1186/s12870-018-1316-3</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology</subject></subj-group></article-categories><title-group><article-title>UGbS-Flex, a novel bioinformatics pipeline for imputation-free SNP discovery in polyploids without a reference genome: finger millet as a case study</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Qi</surname><given-names>Peng</given-names></name><address><email>pengqi@uga.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Gimode</surname><given-names>Davis</given-names></name><address><email>dgimode@uga.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff3">3</xref><xref ref-type="aff" rid="Aff7">7</xref></contrib><contrib contrib-type="author"><name><surname>Saha</surname><given-names>Dipnarayan</given-names></name><address><email>dipsaha72@yahoo.com</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff8">8</xref></contrib><contrib contrib-type="author"><name><surname>Schr&#x000f6;der</surname><given-names>Stephan</given-names></name><address><email>Stephan.Schroder@ndsu.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff9">9</xref></contrib><contrib contrib-type="author"><name><surname>Chakraborty</surname><given-names>Debkanta</given-names></name><address><email>debkanta@uga.edu</email></address><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Xuewen</given-names></name><address><email>xwwang@uga.edu</email></address><xref ref-type="aff" rid="Aff5">5</xref></contrib><contrib contrib-type="author"><name><surname>Dida</surname><given-names>Mathews M.</given-names></name><address><email>mitodida@yahoo.com</email></address><xref ref-type="aff" rid="Aff6">6</xref></contrib><contrib contrib-type="author"><name><surname>Malmberg</surname><given-names>Russell L.</given-names></name><address><email>malmberg@uga.edu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0358-3278</contrib-id><name><surname>Devos</surname><given-names>Katrien M.</given-names></name><address><email>kdevos@uga.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff4">4</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 738X</institution-id><institution-id institution-id-type="GRID">grid.213876.9</institution-id><institution>Institute of Plant Breeding, Genetics and Genomics (Department of Crop and Soil Sciences), </institution><institution>University of Georgia, </institution></institution-wrap>Athens, GA 30602 USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 738X</institution-id><institution-id institution-id-type="GRID">grid.213876.9</institution-id><institution>Department of Plant Biology, </institution><institution>University of Georgia, </institution></institution-wrap>Athens, GA 30602 USA </aff><aff id="Aff3"><label>3</label>ICRISAT-Nairobi, P.O. Box 39063-00623, Nairobi, Kenya </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 738X</institution-id><institution-id institution-id-type="GRID">grid.213876.9</institution-id><institution>Institute of Bioinformatics, </institution><institution>University of Georgia, </institution></institution-wrap>Athens, GA 30602 USA </aff><aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 738X</institution-id><institution-id institution-id-type="GRID">grid.213876.9</institution-id><institution>Department of Genetics, </institution><institution>University of Georgia, </institution></institution-wrap>Athens, GA 30602 USA </aff><aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.442486.8</institution-id><institution>Department of Applied Plant Sciences, </institution><institution>Maseno University, </institution></institution-wrap>Maseno, Kenya </aff><aff id="Aff7"><label>7</label>Present address: Institute of Plant Breeding, Genetics and Genomics (Department of Horticulture), Tifton, GA 31793 USA </aff><aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9007 6834</institution-id><institution-id institution-id-type="GRID">grid.482704.d</institution-id><institution>Present address: ICAR-Central Research Institute for Jute and Allied Fibres, </institution></institution-wrap>Kolkata, India </aff><aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2293 4611</institution-id><institution-id institution-id-type="GRID">grid.261055.5</institution-id><institution>Present address: Department of Plant Sciences, </institution><institution>North Dakota State University, </institution></institution-wrap>Fargo, ND 58108 USA </aff></contrib-group><pub-date pub-type="epub"><day>15</day><month>6</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>15</day><month>6</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>18</volume><elocation-id>117</elocation-id><history><date date-type="received"><day>6</day><month>12</month><year>2017</year></date><date date-type="accepted"><day>23</day><month>5</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s). 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p id="Par1">Research on orphan crops is often hindered by a lack of genomic resources. With the advent of affordable sequencing technologies, genotyping an entire genome or, for large-genome species, a representative fraction of the genome has become feasible for any crop. Nevertheless, most genotyping-by-sequencing (GBS) methods are geared towards obtaining large numbers of markers at low sequence depth, which excludes their application in heterozygous individuals. Furthermore, bioinformatics pipelines often lack the flexibility to deal with paired-end reads or to be applied in polyploid species.</p></sec><sec><title>Results</title><p id="Par2">UGbS-Flex combines publicly available software with in-house python and perl scripts to efficiently call SNPs from genotyping-by-sequencing reads irrespective of the species&#x02019; ploidy level, breeding system and availability of a reference genome. Noteworthy features of the UGbS-Flex pipeline are an ability to use paired-end reads as input, an effective approach to cluster reads across samples with enhanced outputs, and maximization of SNP calling. We demonstrate use of the pipeline for the identification of several thousand high-confidence SNPs with high representation across samples in an F<sub>3</sub>-derived F<sub>2</sub> population in the allotetraploid finger millet. Robust high-density genetic maps were constructed using the time-tested mapping program MAPMAKER which we upgraded to run efficiently and in a semi-automated manner in a Windows Command Prompt Environment. We exploited comparative GBS with one of the diploid ancestors of finger millet to assign linkage groups to subgenomes and demonstrate the presence of chromosomal rearrangements.</p></sec><sec><title>Conclusions</title><p id="Par3">The paper combines GBS protocol modifications, a novel flexible GBS analysis pipeline, UGbS-Flex, recommendations to maximize SNP identification, updated genetic mapping software, and the first high-density maps of finger millet. The modules used in the UGbS-Flex pipeline and for genetic mapping were applied to finger millet, an allotetraploid selfing species without a reference genome, as a case study. The UGbS-Flex modules, which can be run independently, are easily transferable to species with other breeding systems or ploidy levels.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s12870-018-1316-3) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Chromosomal rearrangements</kwd><kwd><italic>Eleusine coracana</italic></kwd><kwd><italic>E. indica</italic></kwd><kwd>Finger millet</kwd><kwd>Genetic mapping</kwd><kwd>Genotyping-by-sequencing (GBS)</kwd><kwd>GBS-pipeline</kwd><kwd>Paired-end reads</kwd><kwd>Polyploid</kwd><kwd>SNP calling</kwd></kwd-group><funding-group><award-group><funding-source><institution>BioInnovate Africa</institution></funding-source></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007699</institution-id><institution>University of Georgia</institution></institution-wrap></funding-source></award-group></funding-group><funding-group><award-group><funding-source><institution>Fulbright-Nehru Senior Research Fellowship</institution></funding-source><award-id>Award 1865/FN-SR/2013</award-id><principal-award-recipient><name><surname>Saha</surname><given-names>Dipnarayan</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000015</institution-id><institution>U.S. Department of Energy</institution></institution-wrap></funding-source><award-id>DE-SC0010743</award-id><principal-award-recipient><name><surname>Devos</surname><given-names>Katrien M.</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p id="Par4">Efficient genotyping methods, whether used for mapping or population genetic studies, must be simple and reliable, and provide the allele composition at thousands or more of polymorphic loci that cover the entire genome [<xref ref-type="bibr" rid="CR1">1</xref>]. Despite the recent advances in sequencing technologies, whole genome sequencing is still not cost effective for large-genome species, especially when multiple-fold coverage needs to be achieved of several hundred individuals. Several reduced representation methods based on selective sequencing of restriction fragments have been developed to simultaneously conduct high-throughput marker discovery and genotyping [<xref ref-type="bibr" rid="CR2">2</xref>&#x02013;<xref ref-type="bibr" rid="CR4">4</xref>]. We collectively refer to these methods as &#x02018;genotyping-by-sequencing&#x02019; (GBS). To keep sequencing costs low, there is typically a trade-off between marker number and sequencing depth. As a result, genotyping-by-sequencing data sets often have large amounts of missing data and low sequence coverage at each locus [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Imputations can be used to infer missing genotypes [<xref ref-type="bibr" rid="CR7">7</xref>]. Low sequence depth, however, is highly problematic when analyzing diversity panels in outcrossing species, and biparental backcross, F<sub>1</sub> (in outcrossing species) and F<sub>2</sub> populations where sufficient sequence depth at each locus is a prerequisite to unambiguously differentiate homozygous and heterozygous alleles. We therefore implemented several modifications to the experimental GBS protocol developed by Elshire et al. [<xref ref-type="bibr" rid="CR2">2</xref>] and Poland et al. [<xref ref-type="bibr" rid="CR8">8</xref>], and tested their effect on reducing the GBS fragment pool and providing more even read coverage across pooled samples for high-confidence imputation free single nucleotide polymorphism (SNP) identification.</p><p id="Par5">Analysis of GBS reads is fairly straightforward if whole genome sequence data is available to which the GBS reads can be aligned. Pipelines for reference-based GBS analysis include TASSEL-GBS [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], Fast-GBS [<xref ref-type="bibr" rid="CR11">11</xref>] and Stacks [<xref ref-type="bibr" rid="CR12">12</xref>]. Pipelines such as TASSEL-UNEAK [<xref ref-type="bibr" rid="CR5">5</xref>], Stacks [<xref ref-type="bibr" rid="CR12">12</xref>] and GBS-SNP-CROP [<xref ref-type="bibr" rid="CR13">13</xref>] can generate a <italic>de novo</italic> GBS reference from the experimental data and are aimed at the analysis of GBS data from species without reference genomes. Most pipelines are geared towards single-end sequencing data from diploid organisms.</p><p id="Par6">Finger millet, <italic>Eleusine coracana</italic> (L.) Gaertn. subsp. <italic>coracana</italic>, is an inbreeding allotetraploid (AABB) cereal belonging to the subfamily Chloridoideae with a haploid genome size of 1.7 Gb [<xref ref-type="bibr" rid="CR14">14</xref>]. Despite being an important food security crop for Eastern Africa and parts of southern India, it has persistently been neglected by the international research community. The wild progenitor of finger millet, <italic>E. coracana</italic> subsp. <italic>africana</italic>, originated by hybridization between <italic>E. indica</italic> (AA genome) and an unknown B-genome species. The timing of the allopolyploidization event is not known. To date, only a single linkage map has been generated of finger millet consisting of 332 loci, mostly detected by restriction fragment length polymorphism (RFLP) markers and single strand conformation polymorphic expressed sequenced tags [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. The map was generated in an F<sub>2</sub> population derived from a cross between a wild accession, MD-20, and a cultivated accession, Okhale-1. Based on similarity between RFLP fragment sizes in the A-genomes of <italic>E. indica</italic> and <italic>E. coracana</italic>, linkage groups were allocated to subgenomes [<xref ref-type="bibr" rid="CR15">15</xref>]. The linkage map was also used to establish gross comparative relationships between the finger millet and rice genomes [<xref ref-type="bibr" rid="CR16">16</xref>]. There is a need for high-density SNP maps of finger millet to assist with trait analyses and planned genome sequencing efforts.</p><p id="Par7">Even with less than 10,000 markers, construction of an accurate linkage map is extremely challenging, in particular when dealing with less than perfect data sets such as, for example, obtained in F<sub>3</sub>-reconstituted F<sub>2</sub> populations. Traditional software like MAPMAKER [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] and JoinMap [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] use maximum likelihood based three-point and multi-point analyses which provide highly accurate marker ordering but are highly memory- and time-intensive for large data sets. To deal with large marker numbers, software packages such as MSTmap [<xref ref-type="bibr" rid="CR21">21</xref>] and Lep-Map [<xref ref-type="bibr" rid="CR22">22</xref>] based on the traveling salesman principle have been developed. Map generation is fast, but marker ordering is more sensitive to genotyping errors. To be able to take advantage of MAPMAKER&#x02019;s high accuracy for ordering large marker sets, we modified the original MAPMAKER package to run efficiently in a Windows Command Prompt Environment and developed in-house python scripts to automate several steps of the MAPMAKER mapping process. The mapping pipeline was applied to generate a new high-density genetic map of finger millet comprised of several thousand high-quality SNP markers.</p><p id="Par8">Our paper thus provides a modified GBS protocol, a new pipeline (UGbS-Flex) for analysis of paired-end GBS data suitable for application in species with different ploidy levels, breeding systems and polymorphism levels, irrespective of the availability of a reference genome sequence. We also provide a comprehensive solution for post-GBS data analysis, and a high-density genetic map of finger millet with new information on the organization of the allotetraploid finger millet genome.</p></sec><sec id="Sec2"><title>Methods</title><sec id="Sec3"><title>Plant materials and DNA extraction</title><p id="Par9">The F<sub>2</sub> mapping population was generated from a cross between <italic>E. coracana</italic> subsp. <italic>africana</italic> accession MD-20 and <italic>E. coracana</italic> subsp. <italic>coracana</italic> accession Okhale-1 [<xref ref-type="bibr" rid="CR15">15</xref>]. One hundred and thirty-four F<sub>2:3</sub> families with a minimum of 15 plants per F<sub>3</sub> family plus the parents were grown in the greenhouse at UGA under day/night temperatures in the range 26&#x02013;30&#x000a0;&#x000b0;C. KNE 796, an accession for which whole genome sequencing is ongoing, and <italic>E. indica</italic> accessions Ei-0, Ei-2 and Ei-5, collected in the wild in Kenya, were grown under the same conditions. All germplasm was obtained in compliance with national and international accords on export/import of seeds for research purposes. DNA was extracted using a modified CTAB method adapted from Doyle and Doyle [<xref ref-type="bibr" rid="CR23">23</xref>] from leaves bulk-harvested for each F<sub>3</sub> family from eight weeks old seedlings. DNA concentrations were measured on a Nanodrop (Thermo Scientific) and samples were diluted to 50&#x000a0;ng/&#x003bc;l. The quality of the DNA was assessed on a 0.8% agarose gel.</p></sec><sec id="Sec4"><title>GBS sample preparation</title><p id="Par10">Two-hundred nanogram of high-molecular-weight DNA was digested with a cocktail of either <italic>Pst</italic>I/<italic>Msp</italic>I, <italic>Pst</italic>I/<italic>Nde</italic>I or <italic>Pst</italic>I/<italic>Msp</italic>I&#x02009;+&#x02009;<italic>Ape</italic>KI. Digestions were done in volumes of 30&#x000a0;&#x003bc;l with 4&#x000a0;U <italic>Pst</italic>I-HF and 8&#x000a0;U <italic>Msp</italic>I in NEB CutSmart buffer for <italic>Pst</italic>I/<italic>Msp</italic>I digestions, 4&#x000a0;U <italic>Pst</italic>I, 8&#x000a0;U <italic>Msp</italic>I and 4&#x000a0;U <italic>Ape</italic>KI in NEB-buffer 3.1 for <italic>Pst</italic>I/<italic>Msp</italic>I plus <italic>Ape</italic>KI digestions, and 4&#x000a0;U <italic>Pst</italic>I-HF and 4&#x000a0;U <italic>Nde</italic>I in NEB CutSmart buffer for <italic>Pst</italic>I/<italic>Nde</italic>I digestions. Samples were incubated for 2&#x000a0;h at 37&#x000a0;&#x000b0;C. This was followed by an additional 2-h incubation at 75&#x000a0;&#x000b0;C for reaction mixtures comprising the enzyme <italic>Ape</italic>KI. Samples without <italic>Ape</italic>KI were incubated at 75&#x000a0;&#x000b0;C for 20&#x000a0;min to inactivate the restriction enzymes.</p><p id="Par11">Twenty microliter restriction digest was mixed with 1&#x000a0;&#x003bc;l barcoded <italic>Pst</italic>I adapter (stock: 0.1&#x000a0;&#x003bc;M), 1.5&#x000a0;&#x003bc;l common <italic>Msp</italic>I or <italic>Nde</italic>I Y-adapter (stock: 10&#x000a0;&#x003bc;M), 4&#x000a0;&#x003bc;l 10X T4-DNA ligase buffer and 200&#x000a0;U&#x000a0;T4 DNA ligase (NEB) in a total volume of 40&#x000a0;&#x003bc;l. The common Y-adaptor and barcoded adapters were as described by Poland et al. [<xref ref-type="bibr" rid="CR8">8</xref>]. Ligation was conducted at 22&#x000a0;&#x000b0;C for 2&#x000a0;h. Following ligation, fragments smaller than 300&#x000a0;bp were removed by incubating the samples with 0.7 volumes of Sera-Mag SpeedBeads (GE Healthcare Life Sciences) prepared according to Rohland and Reich [<xref ref-type="bibr" rid="CR24">24</xref>] at room temperature for 5&#x000a0;min. The beads were separated from the supernatant using a magnetic stand and washed three times with 200&#x000a0;&#x003bc;l freshly prepared 70% ethanol. DNA was eluted from the air-dried beads with 40&#x000a0;&#x003bc;l 10&#x000a0;mM Tris.HCl (pH&#x000a0;8.0).</p><p id="Par12">Three microliter of the resulting eluate was added to a cocktail of 16&#x000a0;&#x003bc;l H<sub>2</sub>O, 5&#x000a0;&#x003bc;l 5X Taq master mix (NEB), 0.5&#x000a0;&#x003bc;l of a forward primer specific to the barcoded adaptor (stock: 10&#x000a0;&#x003bc;M) and 0.5&#x000a0;&#x003bc;l of a reverse primer with homology to the common adaptor (stock: 10&#x000a0;&#x003bc;M). PCR amplification was done for each sample separately using an initial denaturation at 95&#x000a0;&#x000b0;C for 30&#x000a0;s, 16&#x000a0;cycles of denaturation at 95&#x000a0;&#x000b0;C for 30&#x000a0;s, primer annealing at 62&#x000a0;&#x000b0;C for 20&#x000a0;s and fragment elongation at 68&#x000a0;&#x000b0;C for 15&#x000a0;s, followed by a final fragment elongation step at 68&#x000a0;&#x000b0;C for 5&#x000a0;min. Eight microliters of PCR product were checked on a 1.5% agarose gel. The DNA concentration of each GBS library was measured on a Qubit 2.0 using a Qubit&#x02122; dsDNA HS assay kit. Only GBS libraries with concentrations &#x0003e;&#x02009;5.0&#x000a0;ng/&#x003bc;l were sequenced. Thirty nanograms of each GBS library were pooled. The number of samples pooled depended on the sequencing platform used; we aimed to obtain two million reads per sample. Primers, dNTP and small DNA fragments were removed from the pooled DNA with 0.7 volumes of AMPure Beads or Sera-Mag SpeedBeads. Pooled GBS libraries (100&#x000a0;ng) were sequenced on an Illumina NextSeq platform with paired-end 150&#x000a0;bp reads. The parents and 115&#x000a0;F<sub>2:3</sub> samples were sequenced as part of the same sequencing run. An additional three and 26&#x000a0;F<sub>2:3</sub> samples were sequenced as part of two separate NextSeq runs. Ten samples were sequenced in duplicate from independently generated libraries to ensure consistency across libraries and runs.</p></sec><sec id="Sec5"><title><italic>GBS analysis pipeline with optional</italic> de novo <italic>generation of a reference</italic></title><p id="Par13">The full UGbS-Flex pipeline is described below. All in-house perl and python scripts used in the UGbS-Flex pipeline with information on their use are provided under &#x02018;Programs and Scripts&#x02019; on <ext-link ext-link-type="uri" xlink:href="http://research.franklin.uga.edu/devoslab/">http://research.franklin.uga.edu/devoslab/</ext-link>. Detailed information on how to apply the UGbS-Flex pipeline is given in Additional&#x000a0;file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Data S1 and Additional&#x000a0;file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>: Figure S1.</p><sec id="Sec6"><title>Preprocessing of the reads</title><p id="Par14">The read quality was checked with &#x02018;FastQC&#x02019; v. 0.11.4 [<xref ref-type="bibr" rid="CR25">25</xref>]. Reads were split by barcode using the module &#x02018;Process_Radtags&#x02019; within the &#x02018;Stacks&#x02019; program [<xref ref-type="bibr" rid="CR12">12</xref>] with option &#x02013;r (rescue barcodes and RAD-tags). Forward reads passed the filter if they carried both the barcode and the <italic>Pst</italic>I restriction site. Because the first few bases of the reverse reads were low quality in some Illumina NextSeq sequencing runs, no selection was carried out for the restriction site of the second enzyme (<italic>Msp</italic>I or <italic>Nde</italic>I) in the reverse reads. &#x02018;FASTX_trimmer&#x02019; from the &#x02018;FASTX Toolkit&#x02019; package (<ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit">http://hannonlab.cshl.edu/fastx_toolkit/</ext-link>) was used to remove (1) the restriction sites, (2) the last 5&#x000a0;bp (typically) of each read that were more likely to contain errors (or, for lower quality runs, all bases at the 3&#x02032; end of a read with FastQC quality scores lower than 20) and (3) an additional 0 (for a 10&#x000a0;bp barcode) to 5 bases (for a 5&#x000a0;bp barcode) at the 3&#x02032; end of the forward read to make all reads the same length. Identical read length is a prerequisite of the &#x02018;Stacks&#x02019; program [<xref ref-type="bibr" rid="CR12">12</xref>] used in the generation of a <italic>de novo</italic> reference from the GBS reads.</p></sec><sec id="Sec7"><title><italic>De novo</italic> generation of a GBS reference</title><p id="Par15">To facilitate handling of paired-end reads during the generation of a GBS reference, overlapping forward and reverse reads were merged using &#x02018;Flash&#x02019; [<xref ref-type="bibr" rid="CR26">26</xref>]. From the non-overlapping read files, we removed any reads that were shorter than the expected (trimmed) size by running python script &#x02018;EL.1.2.py&#x02019;. If a reverse read was removed, the corresponding forward read was also removed, and <italic>vice versa</italic>. The &#x02018;EL.1.2.py&#x02019; script then reverse complemented the non-overlapping reverse reads within the remaining read pairs and artificially joined them to the 3&#x02032; end of the corresponding forwards reads. No Ns were added at the junction of the forward read and the reverse complemented reverse read. Because read clustering by &#x02018;ustacks&#x02019; [<xref ref-type="bibr" rid="CR12">12</xref>] requires reads of equal length, &#x02018;EL.1.2.py&#x02019; also extended merged overlapping reads at the 3&#x02032; end with &#x02018;As&#x02019; to make them the same length as the joined non-overlapping reads. The A-extended overlapping fragments are typically common to all samples, and hence the polyA tracts do not generate polymorphisms. Reads within each sample were clustered using the &#x02018;ustacks&#x02019; module (options: -m 2 -M 1 -N 1) within the &#x02018;Stacks&#x02019; program [<xref ref-type="bibr" rid="CR12">12</xref>]. The &#x02018;cstacks&#x02019; module within Stacks (options: -b 1 -n 1) was used to generate a set of representative tags by clustering the read stacks obtained from &#x02018;ustacks&#x02019; across the two parents and 117&#x000a0;F<sub>2</sub> progeny. Only a subset of the F<sub>2</sub> samples was included in the &#x02018;cstacks&#x02019; analysis due to the high memory requirements for running &#x02018;cstacks&#x02019; with large numbers of samples. We also tested and validated an alternative approach, referred to as &#x02018;across-sample ustacks&#x02019; (&#x02018;ASustacks&#x02019;) to replace &#x02018;cstacks&#x02019;. Using in-house python scripts, consensus sequences generated in each sample by &#x02018;ustacks&#x02019; were extracted, given a unique name including a sample identifier, and placed in an artificial fastq file by adding a sequence quality line consisting of Es to each consensus sequence. The &#x02018;ustacks&#x02019; module was then applied to this file using parameters comparable to those applied in &#x02018;cstacks&#x02019;. The minimum number of reads required to form a stack (&#x02212;m) was set at 1. An overview of the steps involved in the generation of a GBS reference using the UGbS-Flex pipeline is shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic overview showing use of the UGbS-Flex pipeline to generate a GBS reference</p></caption><graphic xlink:href="12870_2018_1316_Fig1_HTML" id="MO1"/></fig></p></sec><sec id="Sec8"><title>Filtering of the GBS representative tags to generate a reference</title><p id="Par16">Two filtering steps were conducted on the representative tags identified across samples by either &#x02018;cstacks&#x02019; or &#x02018;ASustacks&#x02019; (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Firstly, representative tags that were present in less than a user-defined percentage of samples (50 and 70% in this study) in the &#x02018;cstacks&#x02019; output were removed using the in-house perl script &#x02018;FCT.pl&#x02019;. This filtering step has been integrated into the &#x02018;ASustacks&#x02019; module. Secondly, we removed representative tags that had similarity levels to another representative tag equal to or higher than a user-defined percentage (98% in this study). To achieve this, a blastn all-against-all analysis of the consensus tags was conducted (e-value threshold: 10e<sup>&#x02212;&#x02009;5</sup>). For tags with &#x02265;98% homology, only a single tag was retained using python script &#x02018;Ref_98.py&#x02019;. The representative tags remaining were used as the GBS reference.</p></sec><sec id="Sec9"><title>SNP/indel calling and filtering</title><p id="Par17">Preprocessed reads were aligned against the GBS reference using Bowtie 2 v. 2.2.0 with default parameters [<xref ref-type="bibr" rid="CR27">27</xref>]. If a whole genome reference sequence is available, <italic>de novo</italic> generation of a GBS reference can be omitted and trimmed reads are aligned against the reference genome. For SNP/indel calling, we tested both the &#x02018;Unified Genotyper (GATK v. 3.4.0)&#x02019; (parameters &#x02013;dcov 1000, &#x02212;glm BOTH) and &#x02018;Haplotype Caller (GATK v. 3.4.0)&#x02019; (parameters --genotyping_mode DISCOVERY &#x02013;stand_emit_conf 10 &#x02013;stand_call_conf 30 &#x02013;minPruning 1 &#x02013;emitRefConfidence GVCF) modules within the GATK suite [<xref ref-type="bibr" rid="CR28">28</xref>]. Indels were treated the same as SNPs and, for simplicity, we use the term &#x02018;SNPs&#x02019; to cover both SNPs and indels. Raw SNPs were filtered within GATK to only retain biallelic SNPs with an allele frequency between 10 and 90%. We also removed adjacent SNPs (scripts &#x02018;SNPs_ISL.pl&#x02019; and &#x02018;Rm_adj_SNPs.pl&#x02019;) because some of these were artefacts caused by misalignments at the junction of the forward and reverse reads. The allelic depth (AD) information provided in the GATK .vcf file was then used to score the allelic status of the SNPs at each locus (script &#x02018;SNP_genotyper.py&#x02019;). Loci with a total AD &#x0003c;&#x02009;8 were scored as missing data points (&#x02212;). Loci with an AD<sub>ref(erence allele)</sub>/AD<sub>alt(ernate allele)</sub> ratio&#x02009;&#x02265;&#x02009;10 were scored as A (homozygous for the Parent 1 allele), AD<sub>ref</sub>/AD<sub>alt</sub>&#x02009;&#x02264;&#x02009;0.10 as B, 10&#x02009;&#x0003e;&#x02009;AD<sub>ref</sub>/AD<sub>alt</sub>&#x02009;&#x0003e;&#x02009;4 as D (ambiguous A or heterozygous (H)) and 0.25&#x02009;&#x0003e;&#x02009;AD<sub>ref</sub>/AD<sub>alt</sub>&#x02009;&#x0003e;&#x02009;0.1 as C (ambiguous B or H). Loci with other ratios were scored as H. For F<sub>2</sub> populations generated from two inbred parents, as was the case for finger millet, all SNPs that were not homozygous for different alleles in the parents were removed (script &#x02018;SNP_selectByParent.py&#x02019;). SNPs that were missing in more than 30% of the samples or had an A/B ratio&#x02009;&#x0003c;&#x02009;10% or&#x02009;&#x0003e;&#x02009;90% were also removed. This was done manually in Excel. Similarly, samples with more than 30% of missing data were removed.</p></sec><sec id="Sec10"><title>Comparison of the UGbS-flex and GBS-SNP-CROP pipelines</title><p id="Par18">To compare the performance of the UGbS-Flex and GBS-SNP-CROP [<xref ref-type="bibr" rid="CR13">13</xref>] pipelines, the raw sequence data from 48 tetraploid kiwiberry genotypes used by Melo et al. [<xref ref-type="bibr" rid="CR13">13</xref>] were downloaded from NCBI (SRR2296676). Guided by the fastQC report, we trimmed the forward and reverse reads to 121&#x000a0;bp. The parameters used for &#x02018;ustacks&#x02019; were &#x02013;m 2 &#x02013;M 2 &#x02013;N 4, and for &#x02018;ASustacks&#x02019;&#x02013;m 1 &#x02013;M 2 &#x02013;N 4. We selected the same missing data threshold (25%) and sequencing depth for SNP scoring as Melo and colleagues [<xref ref-type="bibr" rid="CR13">13</xref>]. The H-threshold was set at 4.</p></sec></sec><sec id="Sec11"><title>Genetic mapping</title><sec id="Sec12"><title>Reducing the dataset by consolidating SNPs located in the same GBS tag</title><p id="Par19">Information at SNP loci that were located within the same GBS reference tag and were in linkage disequilibrium was consolidated to further improve the robustness of the mapping scores (function included in &#x02018;SNP_genotyper.py&#x02019;). If loci within a representative tag were scored as a combination of &#x02018;A&#x02019;, &#x02018;D&#x02019; and &#x02018;-&#x02019;, the consolidated score was &#x02018;A&#x02019; (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). Similarly, a combination of &#x02018;B&#x02019;, &#x02018;C&#x02019; and &#x02018;-&#x02019; was consolidated as &#x02018;B&#x02019;, and a combination of &#x02018;H&#x02019;,&#x02018;C&#x02019;, &#x02018;D&#x02019; and &#x02018;-&#x02018; as H. If all loci in a GBS representative tag were scored as &#x02018;-&#x02019;, &#x02018;C&#x02019; or &#x02018;D&#x02019;, those scores were retained. Conflicting scores (A and B, A and C, A and H, B and H, and B and D) were flagged (&#x02018;F&#x02019;) and treated as missing data for map generation.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Schematic representation of the approach used to consolidate SNPs within the same GBS reference tag</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>S1<sup>b</sup></th><th>S2</th><th>S3</th><th>S4</th><th>S5</th><th>S6</th><th>S7</th><th>S8</th><th>S9</th><th>S10</th><th>S11</th><th>S12</th></tr></thead><tbody><tr><td>SNP1<sup>a</sup></td><td>&#x02013;</td><td>B<sup>c</sup></td><td>&#x02013;</td><td>C</td><td>D</td><td>A</td><td>B</td><td>H</td><td>A</td><td>B</td><td>H</td><td>A</td></tr><tr><td>SNP2<sup>a</sup></td><td>A</td><td>&#x02013;</td><td>&#x02013;</td><td>&#x02013;</td><td>&#x02013;</td><td>D</td><td>C</td><td>C</td><td>A</td><td>D</td><td>A</td><td>A</td></tr><tr><td>SNP3<sup>a</sup></td><td>&#x02013;</td><td>&#x02013;</td><td>H</td><td>&#x02013;</td><td>&#x02013;</td><td>A</td><td>C</td><td>D</td><td>C</td><td>B</td><td>A</td><td>B</td></tr><tr><td>After consolidation</td><td>
<bold>A</bold>
</td><td>
<bold>B</bold>
</td><td>
<bold>H</bold>
</td><td>
<bold>C</bold>
</td><td>
<bold>D</bold>
</td><td>
<bold>A</bold>
</td><td>
<bold>B</bold>
</td><td>
<bold>H</bold>
</td><td>
<bold>&#x02013;</bold>
</td><td>
<bold>&#x02013;</bold>
</td><td>
<bold>&#x02013;</bold>
</td><td>
<bold>&#x02013;</bold>
</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>SNP1, SNP2 and SNP3 are SNPs located on the same GBS tag</p><p><sup>b</sup>S1 to S12 represent different situations</p><p><sup>c</sup>A, B, H, C, D and &#x02013; are genotypic scores</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec13"><title>Reducing the dataset by removing cosegregating markers</title><p id="Par20">To generate a set of high-quality non-redundant markers for genetic map construction, each SNP marker was given a penalty score for the presence of a &#x02018;C&#x02019; or &#x02018;D&#x02019; (penalty&#x02009;=&#x02009;1) or a missing data point (penalty&#x02009;=&#x02009;2). Using the in-house python script &#x02018;SNP_cosegregation.py&#x02019;, the mapping scores of all SNP markers were compared in an all-against-all analysis with a greedy algorithm. SNP markers with the same multilocus genotypes were identified, and the marker with the smallest penalty score in each set was selected for mapping.</p></sec><sec id="Sec14"><title>Construction of genetic maps</title><p id="Par21">To construct the genetic maps, we removed all SNPs that had missing data in more than 20% of the progeny. The set of SNP markers was split into linkage groups using MSTmap [<xref ref-type="bibr" rid="CR21">21</xref>]. Initial map orders were established with MST map and checked for double recombination events using MAPMAKER (adapted from [<xref ref-type="bibr" rid="CR18">18</xref>]; adapted version available from <ext-link ext-link-type="uri" xlink:href="http://research.franklin.uga.edu/devoslab/">http://research.franklin.uga.edu/devoslab/</ext-link>)<italic>.</italic> Markers with more than a defined number (four in this study) of double recombination events were removed. The process of MSTmap mapping and checking of double recombination events was repeated until the number of double recombination events between each marker and its flanking markers was &#x02264;4. The corresponding MSTmap maps were used as starting points for map generation using MAPMAKER (adapted from [<xref ref-type="bibr" rid="CR18">18</xref>]; adapted version available from <ext-link ext-link-type="uri" xlink:href="http://research.franklin.uga.edu/devoslab/">http://research.franklin.uga.edu/devoslab/</ext-link>).</p><p id="Par22">Because the MAPMAKER version used was limited to ordering ~&#x02009;100 markers due to inherent program limitations, MSTmap maps with more than 100 markers were split into smaller subgroups of 60 to 100 markers. Subgroups overlapped by 40 markers. Genetic maps were constructed for each of the subgroups using the &#x02018;order&#x02019; and &#x02018;try&#x02019; commands. Subgroup maps were merged based on common marker orders in the overlapping segments. Each linkage group was split again into subgroups of &#x0003c;&#x02009;100 markers, and marker orders were further adjusted using the &#x02018;ripple&#x02019; command. &#x02018;Try&#x02019; and &#x02018;ripple&#x02019; were done in a semi-automated manner using the scripts &#x02018;try.py&#x02019; and &#x02018;ripple.py&#x02019;, respectively. Final marker orders were merged across subgroups. Genetic map distances (in Kosambi) were obtained using the &#x02018;map&#x02019; command with &#x02018;error detection on&#x02019; in MAPMAKER. Map orders were scrutinized manually and, if necessary, further adjusted. Markers with the same multi-locus genotype were added to the map as cosegregating with their representative marker. Finally, we placed markers with ambiguous orders (not separated by clear recombination events) in bins.</p></sec></sec><sec id="Sec15"><title>Identifying a and B genome linkage groups</title><p id="Par23">Reads from three <italic>E. indica</italic> accessions (AA genome) were aligned against the GBS reference tags using Bowtie 2 v. 2.2.9 with default parameters [<xref ref-type="bibr" rid="CR27">27</xref>]. Presence (present in at least two of the three <italic>E. indica</italic> accessions analyzed) and absence (absent from all three <italic>E. indica</italic> accessions analyzed) of mapped GBS tags in the <italic>E. indica</italic> genome were charted along the length of the genetic map using Excel scatterplots. Linkage groups with <italic>E. indica</italic> tags along their entire length were allocated to the A genome and those that were largely devoid of <italic>E. indica</italic> tags were allocated to the B-genome.</p></sec></sec><sec id="Sec16"><title>Results</title><sec id="Sec17"><title>Efficiency of different enzyme combinations in generating polymorphic markers</title><p id="Par24">We tested two two-enzyme combinations (<italic>Pst</italic>I/<italic>Msp</italic>I and <italic>Pst</italic>I/<italic>Nde</italic>I) and one three-enzyme combination (<italic>Pst</italic>I/<italic>Msp</italic>I&#x02009;+&#x02009;<italic>Ape</italic>KI) on three finger millet accessions for their efficiency in generating largely overlapping fragment pools that, when sequenced, yielded SNPs that were present in all three accessions at a depth of at least 8&#x000d7;. All samples were sequenced (paired-end 150&#x000a0;bp) on an Illumina NextSeq platform. The number of reads obtained for each of the nine sample/enzyme combinations (three accessions, three enzyme combinations) is given in Additional&#x000a0;file&#x000a0;<xref rid="MOESM3" ref-type="media">3</xref>: Table S1. To estimate the effect of read depth on the <italic>de novo</italic> generation of a GBS reference, we analyzed subsets of 0.2 million (M), 0.5&#x000a0;M, 1&#x000a0;M, 2&#x000a0;M and 3&#x000a0;M paired-end reads for each accession/enzyme combination with our newly developed UGbS-Flex pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The smaller read numbers were subsets of the larger read sets.</p><p id="Par25">For the enzyme combinations <italic>Pst</italic>I/<italic>Msp</italic>I and <italic>Pst</italic>I/<italic>Msp</italic>I plus <italic>Ape</italic>KI, as expected, the number of GBS tags that were common to all three accessions tested increased with increasing total read numbers, reaching a plateau around 2&#x000a0;M reads (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1 &#x02018;By Enzyme Combination&#x02019;). For the enzyme combination <italic>Pst</italic>I/<italic>Nde</italic>I, however, the number of common GBS tags increased from 0.2&#x000a0;M to 1&#x000a0;M total reads, but then decreased when total read numbers were increased from 1&#x000a0;M to 3&#x000a0;M. To test whether this was an artefact generated by the &#x02018;cstacks&#x02019; [<xref ref-type="bibr" rid="CR12">12</xref>] module, which clusters reads across samples, we developed the script &#x02018;across-sample ustacks&#x02019; (&#x02018;ASustacks&#x02019;). &#x02018;ASustacks&#x02019; generated an artificial fastq file from each sample&#x02019;s &#x02018;ustacks&#x02019; output and these files were used as input for &#x02018;ustacks&#x02019;. The &#x02018;ASustacks&#x02019; approach yielded similar numbers of reference tags as &#x02018;cstacks&#x02019; except for read numbers &#x02265;1&#x000a0;M in enzyme combination <italic>Pst</italic>I/<italic>Nde</italic>I. We now saw the expected increase in common GBS tags with increasing read numbers across all enzyme combinations. More than 97% of GBS reference tags that were identified with &#x02018;cstacks&#x02019; were also found in the reference generated using &#x02018;ASustacks&#x02019;. Interestingly, the read depth of the GBS reference tags that were identified by both &#x02018;cstacks&#x02019; and &#x02018;ASustacks&#x02019; was significantly lower than the read depth of the GBS reference tags that were uniquely identified by &#x02018;ASustacks&#x02019; (Additional&#x000a0;file&#x000a0;<xref rid="MOESM4" ref-type="media">4</xref>: Table S2). This suggests that high read depth hampered the performance of &#x02018;cstacks&#x02019;, possibly because a higher read depth led to a higher absolute presence of SNPs caused by PCR or sequencing errors in allelic reads. The &#x02018;cstacks&#x02019; module may have eliminated these clusters as likely consisting of repetitive DNA. We conducted a blastn analysis of all finger millet reference tags that were identified by &#x02018;ASustacks&#x02019; in the subset of 3&#x000a0;M reads in the <italic>Pst</italic>I/<italic>Nde</italic>I digested samples against the repeat-masked rice (<italic>Oryza sativa</italic>) genome. Blastn hits were identified (e-value threshold of e-5) for 30% of the tags that were common to &#x02018;cstacks&#x02019; and &#x02018;ASustacks&#x02019;, and for 37% of the tags that were uniquely identified by &#x02018;ASustacks&#x02019;. This shows that the tags eliminated by &#x02018;cstacks&#x02019; were not enriched for repeats. To further validate the &#x02018;ASustacks&#x02019; approach, we compared read clusters generated by &#x02018;cstacks&#x02019; and &#x02018;ASustacks&#x02019; in GBS data from DNA of a set of 96 diverse foxtail lily lines belonging to different <italic>Eremurus</italic> species digested with <italic>Pst</italic>I/<italic>Msp</italic>I. Foxtail lily has an ~&#x02009;7.9 Gb (1C) genome (I. Leitch, pers. comm.). The number of tags that were common to at least 50% of the lines based on &#x02018;cstacks&#x02019; and &#x02018;ASustacks&#x02019; was 376 and 3552, respectively, with 98% of &#x02018;cstacks&#x02019; clusters being present in the &#x02018;ASustacks&#x02019; output. In addition to yielding higher numbers of reference tags, the &#x02018;ASustacks&#x02019; approach was computationally much less intensive than &#x02018;cstacks&#x02019;.</p><p id="Par26">To estimate the effect of the different enzymes on reducing the fragment pool for sequencing, we compared the number of polymorphic GBS tags that were present in all three accessions tested and the number of SNPs identified across the three enzyme combinations (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>; Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1 &#x02018;By Read Number&#x02019;). Minimum read depth for SNP scoring was 8&#x000d7;. The use of a third enzyme greatly decreased the number of GBS reference tags and hence the number of SNPs identified but, contrary to our expectations, only marginally increased SNP read depth (Table <xref rid="Tab2" ref-type="table">2</xref>). The percentage of <italic>Ape</italic>KI sites in the <italic>Pst</italic>I/<italic>Msp</italic>I read set was some two-fold higher than in the <italic>Pst</italic>I/<italic>Msp</italic>I&#x02009;+&#x02009;<italic>Ape</italic>KI read set, and comparable to that found in the GBS reference tags (Additional&#x000a0;file&#x000a0;<xref rid="MOESM5" ref-type="media">5</xref>: Table S3). In the triple digest, however, <italic>Ape</italic>KI-containing reads were highly underrepresented in the GBS reference compared to the reads (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S3). This suggests that <italic>Ape</italic>KI-containing reads in the triple digests could not be clustered. They likely originated during the adapter-ligation step through random ligation of <italic>Ape</italic>KI fragments from different genomic regions. The highest number of polymorphic SNPs present at a minimum read depth of 8&#x000d7; in each of the three accessions tested was obtained with enzyme combination <italic>Pst</italic>I/<italic>Msp</italic>I for read numbers &#x02265;1&#x000a0;M and with <italic>Pst</italic>I/<italic>Nde</italic>I when the number of fragments sequenced per sample was &#x02264;500,000 (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1 &#x02018;By Read Number&#x02019;).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Summary statistics obtained for each of the three enzyme combinations for a subset of 1&#x000a0;M reads</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Enzyme combination</th><th>Accession</th><th>Total read number</th><th>Number of stacks (tags) within samples<sup>a</sup></th><th>Number of stacks (tags) common to all samples<sup>b</sup></th><th>Number of polymorphic tags<sup>c</sup></th><th>Number of polymorphic SNPs<sup>c</sup></th><th>Average depth of scored SNPs</th></tr></thead><tbody><tr><td rowspan="3"><italic>Pst</italic>I/<italic>Msp</italic>I</td><td>KNE 796</td><td>5,720,433</td><td>83,082</td><td rowspan="3">22,191</td><td/><td/><td>15.20</td></tr><tr><td>MD-20</td><td>5,418,738</td><td>64,382</td><td>4440</td><td>4515</td><td>15.64</td></tr><tr><td>Okhale-1</td><td>7,738,023</td><td>73,903</td><td/><td/><td>17.21</td></tr><tr><td rowspan="3"><italic>Pst</italic>I/<italic>Msp</italic>I&#x02009;+&#x02009;<italic>Ape</italic>KI</td><td>KNE 796</td><td>3,466,582</td><td>50,189</td><td rowspan="3">12,249</td><td/><td/><td>16.57</td></tr><tr><td>MD-20</td><td>4,474,070</td><td>37,619</td><td>2475</td><td>2509</td><td>20.90</td></tr><tr><td>Okhale-1</td><td>5,586,989</td><td>45,829</td><td/><td/><td>19.65</td></tr><tr><td rowspan="3"><italic>Pst</italic>I/<italic>Nde</italic>I</td><td>KNE 796</td><td>6,647,185</td><td>39,406</td><td rowspan="3">12,392</td><td/><td/><td>32.28</td></tr><tr><td>MD-20</td><td>4,269,463</td><td>35,218</td><td>3232</td><td>3305</td><td>28.66</td></tr><tr><td>Okhale-1</td><td>5,851,494</td><td>37,551</td><td/><td/><td>34.76</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Determined using &#x02018;ustacks&#x02019;</p><p><sup>b</sup>GBS tags that are common to all three accessions were selected from the &#x02018;ASustacks&#x02019; output; if two or more tags had a level of homology &#x02265;98%, only a single tag was retained</p><p><sup>c</sup>Only SNPs at a read depth&#x02009;&#x02265;&#x02009;8&#x000d7; were scored</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec18"><title>Generation of a GBS reference in the MD-20 x Okhale-1 mapping population</title><p id="Par27">A total of 278,880,767 paired-end reads were obtained across 146 samples (SRA Study <bold>SRP136342</bold>). Genotypic scores of duplicated samples were merged using the rules applied to SNP consolidation. Approximately 2% of SNPs disagreed between duplicated samples and were entered as missing data. The average and median read number per sample was 1,910,142 and 1,317,595, respectively. One sample with less than 600,000 reads was removed from the analysis. The number of representative GBS tags that were present in at least 50% of the samples (hereafter referred to as Ref50) following &#x02018;cstacks&#x02019; analysis was 34,960 (Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>). This number decreased to 16,725 for tags present in at least 70% of the samples (Ref70). Following removal of representative tags with &#x02265;98% homology, 28,579 tags remained in the Ref50 reference (Ref50_98) and 15,397 in the Ref70 reference (Ref70_98).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Number of SNPs identified with different combinations of SNP callers and GBS references</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"/><th colspan="4">Unified Genotyper (GATK)</th><th colspan="4">Haplotype Caller (GATK)</th></tr><tr><th>Ref50</th><th>Ref50_98</th><th>Ref70</th><th>Ref70_98</th><th>Ref50</th><th>Ref50_98</th><th>Ref70</th><th>Ref70_98</th></tr></thead><tbody><tr><td>No. of GBS tags</td><td>34,960</td><td>28,579</td><td>16,725</td><td>15,397</td><td>34,960</td><td>28,579</td><td>16,725</td><td>15,397</td></tr><tr><td>No. of SNPs</td><td>2358</td><td>5534</td><td>3939</td><td>4477</td><td>1766</td><td>4593</td><td>3413</td><td>3934</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec19"><title>SNP calling</title><p id="Par28">Trimmed reads were aligned against the generated Ref50, Ref50_98, Ref70 and Ref70_98 GBS references and the alignments were used for SNP calling. Both GATK&#x02019;s Unified Genotyper and Haplotype Caller were employed and their outputs compared. The number of reference GBS tags that carried SNPs for each SNP caller/alignment combination is given in Table <xref rid="Tab3" ref-type="table">3</xref>. The number of SNP-containing GBS tags common to different references and to different SNP callers is shown in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> and Additional&#x000a0;file&#x000a0;<xref rid="MOESM6" ref-type="media">6</xref>: Figure S2. For construction of the genetic maps, the SNPs identified with Unified Genotyper and Haplotype Caller against the references Ref50_98 and Ref70_98 were pooled, yielding a total of 17,245 SNPs distributed over 7307 tags. Consolidation of the SNPs located on the same tag to one consensus SNP per tag reduced the number of SNPs (tags) to 7125. A total of 182 tags was removed because they carried SNPs with conflicting genotypic scores in 20% or more of the progeny. High numbers of conflicting scores across SNPs located on the same GBS tag is likely caused by alignment of both A and B genome reads to the same GBS reference tag.<fig id="Fig2"><label>Fig. 2</label><caption><p>Venn-diagram showing the number of unique and common SNPs identified using GATK&#x02019;s Unified Genotyper and Haplotype Caller in combination with GBS references Ref50_98 and Ref70_98</p></caption><graphic xlink:href="12870_2018_1316_Fig2_HTML" id="MO2"/></fig></p></sec><sec id="Sec20"><title>Comparison of UGbS-flex and GBS-SNP-CROP pipelines</title><p id="Par29">Using the same dataset and, to the extent possible, same thresholds as reported by Melo and colleagues [<xref ref-type="bibr" rid="CR13">13</xref>], UGbS-Flex yielded, before filtering, a total of 86,810 SNPs compared to 56,598 reported by Melo and colleagues for GBS-SNP-CROP (Additional&#x000a0;file&#x000a0;<xref rid="MOESM7" ref-type="media">7</xref>: Table S4). After filtering, the total number of SNPs retained from the UGbS-Flex pipeline was 50,139 compared to 21,318 by GBS-SNP-CROP (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Table S4). The SNP number reported for the GBS-SNP-CROP pipeline is when a single accession with the most abundant read number was used in the generation of a reference. When all 48 accessions were used, the total number of filtered SNPs obtained by GBS-SNP-CROP was 14,712. We used all 48 accessions to generate a reference with UGbS-Flex.</p></sec><sec id="Sec21"><title>Genetic mapping</title><p id="Par30">Because some of the distorted markers caused spurious linkages, we initially removed all markers with segregation ratios that deviated from 1:2:1 (A:H:B). We also removed cosegregating markers to reduce marker load during map construction. After the initial map generation, three groups of distorted markers that linked together at high LOD scores and extended the preliminary maps were re-added to the dataset to generate the final maps. The maps consisted of a total of 3772 SNP markers organized in 18 linkage groups with the number of markers per linkage group varying from 39 (51&#x000a0;cM) to 301 (240&#x000a0;cM) (Figs.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>, Table&#x000a0;<xref rid="Tab4" ref-type="table">4</xref>, Additional&#x000a0;file&#x000a0;<xref rid="MOESM8" ref-type="media">8</xref>: Table S5). After integrating the cosegregating markers, the total number of markers mapped was 4453 (Additional&#x000a0;file&#x000a0;<xref rid="MOESM9" ref-type="media">9</xref>: Table S6). The number of recombination bins per chromosome varied from 25 to 120 (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Tables S5 and Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S6). The sequences of the mapped GBS tags and the SNP positions in these tags are provided in Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S6.<fig id="Fig3"><label>Fig. 3</label><caption><p>High-density genetic maps of finger millet (homoeologous groups 1, 2 and 3). Marker names are on the right-hand side, centiMorgan (Kosambi) distances on the left-hand side. For readability, only the first marker of each marker bin is represented on the map. Locations of all markers are available from Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S6</p></caption><graphic xlink:href="12870_2018_1316_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>High-density genetic maps of finger millet (homoeologous groups 4, 5 and 6). Marker names are on the right-hand side, centiMorgan (Kosambi) distances on the left-hand side. For readability, only the first marker of each marker bin is represented on the map. Locations of all markers are available from Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S6</p></caption><graphic xlink:href="12870_2018_1316_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>High-density genetic maps of finger millet (homoeologous groups 7, 8 and 9). Marker names are on the right-hand side, centiMorgan (Kosambi) distances on the left-hand side. For readability, only the first marker of each marker bin is represented on the map. Locations of all markers are available from Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S6</p></caption><graphic xlink:href="12870_2018_1316_Fig5_HTML" id="MO5"/></fig><table-wrap id="Tab4"><label>Table 4</label><caption><p>Number of markers and map length of each of the nine A and nine B genome linkage groups</p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="2"/><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th></tr></thead><tbody><tr><td rowspan="2">A</td><td>Number of markers</td><td>301</td><td>259</td><td>292</td><td>162</td><td>295</td><td>260</td><td>204</td><td>183</td><td>122</td></tr><tr><td>Map length (cM)</td><td>239.8</td><td>191.5</td><td>200.7</td><td>108.1</td><td>197.2</td><td>177.3</td><td>163.2</td><td>131.6</td><td>102.8</td></tr><tr><td rowspan="2">B</td><td>Number of markers</td><td>148</td><td>112</td><td>295</td><td>198</td><td>289</td><td>251</td><td>39</td><td>183</td><td>179</td></tr><tr><td>Map length (cM)</td><td>188.6</td><td>85.4</td><td>167.1</td><td>144</td><td>195.5</td><td>173.7</td><td>50.5</td><td>131.4</td><td>131.8</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec22"><title>Allocating linkage groups to a and B subgenomes</title><p id="Par31">For approximately 13% of the mapped <italic>E. coracana</italic> GBS tags, corresponding GBS reads were identified in all three <italic>E. indica</italic> accessions analyzed. An additional 14% of mapped tags were represented in two of the three analyzed <italic>E. indica</italic> accessions and 18% were present in only a single <italic>E. indica</italic> accession. Excel scatterplots showing the distribution of GBS tags absent from all three <italic>E. indica</italic> accessions and present in at least two of the three <italic>E. indica</italic> accessions in each of the 18 <italic>E. coracana</italic> linkage groups are shown in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>. Chromosomes within seven of the nine homoeologous groups were unambiguously assigned to the A or B subgenome. A/B translocations were identified for homoeologous groups 6 and 9.<fig id="Fig6"><label>Fig. 6</label><caption><p>Scatterplots showing presence/absence in <italic>E. indica</italic> (AA genome) of GBS tags mapped in <italic>E. coracana</italic> (AABB genome). Linkage group designations are given on the right-hand side of each graph. GBS tags are ordered by map position (distance in cM). Tags that were present in at least two of the three <italic>E. indica</italic> accessions analyzed were placed at position &#x02018;2&#x02019; on the Y-axis. Tags that were absent from all three <italic>E. indica</italic> accessions analyzed were placed at position &#x02018;0&#x02019; on the Y-axis. GBS tags located on the B-genome of <italic>E. coracana</italic> are absent from <italic>E. indica</italic>. GBS tags on the A-genome of <italic>E. coracana</italic> are predominantly present (conserved tag) but can be absent from <italic>E. indica</italic> (polymorphism at restriction site, tag not amplified due to a large insertion, or tag not sequenced)</p></caption><graphic xlink:href="12870_2018_1316_Fig6_HTML" id="MO6"/></fig></p></sec></sec><sec id="Sec23"><title>Discussion</title><sec id="Sec24"><title>Optimization of the GBS technology</title><p id="Par32">We tested several modifications to the experimental GBS protocol developed by Elshire et al. [<xref ref-type="bibr" rid="CR2">2</xref>] and Poland et al. [<xref ref-type="bibr" rid="CR8">8</xref>]. The aim was to reduce the fragment pool for sequencing and to provide more even read coverage across pooled samples to increase read depth at each locus and SNP representation across samples. A reduction in the number of fragments that will be sequenced can be attained by preventing the addition of Illumina sequencing adapters to a subset of the DNA fragments during the PCR step. This can be achieved using primers with one or more selective bases as applied in Tunable GBS (tGBS&#x000ae;, Data2Bio, ISU Research Park, Iowa) or by cutting PCR-amplifiable fragments with a restriction enzyme. We pioneered the latter approach in finger millet, an inbreeding tetraploid species. DNA of three accessions was either double digested with the enzyme combination <italic>Pst</italic>I/<italic>Msp</italic>I or <italic>Pst</italic>I/<italic>Nde</italic>I, or triple digested by adding <italic>Ape</italic>KI to the <italic>Pst</italic>I/<italic>Msp</italic>I digest. <italic>Pst</italic>I and <italic>Nde</italic>I are 6-bp cutters, <italic>Msp</italic>I is a 4-bp cutter and <italic>Ape</italic>KI is a 5-bp cutter. <italic>Pst</italic>I, <italic>Nde</italic>I and <italic>Ape</italic>KI are sensitive to CNG methylation. No adapters were ligated to sites generated by the third enzyme. While employing a third enzyme did reduce the fragment pool significantly, random ligation between fragments that originated from different parts of the genome during the adapter-ligation step resulted in chimeric fragments. These fragments were sequenced but did not align within or across accessions. Use of a three-enzyme mix therefore did not provide an advantage over a double digest. A third enzyme could likely be employed more effectively after ligation of the adapters, but this would require an additional step in the GBS protocol. The use of <italic>Nde</italic>I, a 6-bp cutter, in the double digest was advantageous for low read numbers (500,000 or less) because a smaller fragment pool allowed more fragments to be sequenced that were common across samples to a depth of at least 8&#x000d7;. For target read numbers in the range of 1&#x000a0;M to 2&#x000a0;M per sample and SNP scoring at a minimum read depth of 8&#x000d7;, we recommend the use of <italic>Pst</italic>I/<italic>Msp</italic>I. The <italic>Pst</italic>I/<italic>Msp</italic>I combination generated a larger fragment pool than <italic>Pst</italic>I/<italic>Nde</italic>I but this fragment pool remained sufficiently small that many fragments that were common across samples were sequenced to the desired 8&#x000d7; depth. Obtaining more than 2&#x000a0;M reads was not cost-effective for fragment pools generated by <italic>Pst</italic>I<italic>/Msp</italic>I (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1).</p><p id="Par33">We added two size selection steps to our protocol. Fragments smaller than 300&#x000a0;bp were removed after ligation of the adapters to the DNA fragments using Sera-Mag SpeedBeads. During the PCR step, the duration of the primer elongation step was kept to 15&#x000a0;s which largely limited amplification to fragments shorter than 800&#x000a0;bp. In addition, we incorporated a modification to obtain a more even read number across pooled samples. In the original protocol [<xref ref-type="bibr" rid="CR2">2</xref>], samples were pooled before the PCR step. Elshire and colleagues initially noted large variation in read numbers between samples which they attributed to inconsistent pipetting by the liquid handling system and rectified by adjustments to the system [<xref ref-type="bibr" rid="CR2">2</xref>]. We also saw significant variation in read numbers between samples within a pool. While we aimed to obtain two million reads per sample, read numbers varied from 103,000 to close to 13 million in our early GBS experiments (Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>). Variation in pipetting, which was done manually, might have been one contributing factor, but variation between samples in the efficiency of adapter ligation also likely played a role. We therefore PCR amplified samples individually, and measured the DNA concentration on a Qubit fluorometer before pooling equal amounts of DNA. Samples with a DNA concentration less than 5&#x000a0;ng/&#x003bc;l were discarded as they resulted in low read numbers even after adjusting the amount of sample added to the pool. Furthermore, these samples could generally not be rescued by redoing only the PCR step but had to be redone from the start, indicating that the problem lay either in the digestion or adapter-ligation step. Introduction of this modification greatly narrowed the range of read numbers obtained (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). While this approach increased the cost of sample preparation, it allowed &#x02018;bad samples&#x02019; to be identified pre-sequencing and, as such, represented a cost-saving at the sequencing end.<fig id="Fig7"><label>Fig. 7</label><caption><p>Box-and-whisker plot showing the read number distribution across pooled samples before optimization and after optimization of the GBS protocol</p></caption><graphic xlink:href="12870_2018_1316_Fig7_HTML" id="MO7"/></fig></p></sec><sec id="Sec25"><title>Generation of a GBS reference</title><p id="Par34">We wanted a GBS protocol and analysis pipeline that would provide several thousand robust SNP markers in a variety of species, irrespective of the breeding system, ploidy level, polymorphism level and availability of a whole-genome sequence. To maximize the chances of finding SNP variation in species with unknown or low levels of variation, we opted to sequence the reduced representation libraries from both ends (2&#x02009;&#x000d7;&#x02009;150 bp on a NextSeq). Furthermore, the longer paired-end reads were more likely to identify orthologous sequences in related species, and availability of comparative information is key to the study of orphan crops with few genetic and genomic resources. While a few pipelines (e.g. TASSEL-GBS [<xref ref-type="bibr" rid="CR10">10</xref>], STACKS [<xref ref-type="bibr" rid="CR12">12</xref>]) were available when we initiated our analyses that could build a genomic reference from the GBS tags, none could deal with paired-end reads or had been developed for data from polyploid species<italic>.</italic> These shortcomings were recently addressed with the publication of the GBS-SNP-CROP pipeline [<xref ref-type="bibr" rid="CR13">13</xref>]. We present an alternative pipeline, UGbS-Flex, that can generate a GBS reference from paired-end data from inbreeding diploids as well as outcrossing allopolyploids. This intuitive and flexible pipeline consists of publicly available software packages and in-house perl and python scripts to cover data analysis from read processing to SNP scoring (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Each UGbS-Flex module can be run independently.</p><p id="Par35">Much of the UGbS-Flex pipeline development was done with GBS sequencing data generated in an F<sub>2</sub> population of finger millet. However, we have successfully used the UGbS-Flex pipeline for the analysis of GBS data generated in diversity panels in finger millet and foxtail lily, and in mapping populations in seashore paspalum, an outcrossing diploid, and switchgrass, an outcrossing tetraploid. To facilitate working with paired-end data, we merged overlapping sequences, and considered non-overlapping paired-end reads as contiguous sequences. We then grouped reads by similarity within samples using the &#x02018;ustacks&#x02019; module from the STACKs package [<xref ref-type="bibr" rid="CR12">12</xref>] and across samples using either &#x02018;cstacks&#x02019; or the novel &#x02018;ASustacks&#x02019; approach. The latter applies &#x02018;ustacks&#x02019; to a file that comprises consensus sequences for per sample read clusters from all samples. Because the &#x02018;ASustacks&#x02019; approach is more efficient in terms of computing resources and numbers of identified GBS reference tags, it has been integrated in the UGbS-Flex pipeline for analysis of reduced representation sequencing data generated using methylation-sensitive restriction enzymes and hence enriched for low copy sequences.</p><p id="Par36">Optimal &#x02018;ustacks&#x02019; and &#x02018;cstacks/&#x02018;ASustacks&#x02019; parameters are dependent on the breeding system, ploidy, and polymorphism level of the species under investigation. For example, in an inbreeding species, most loci are homozygous, and stacks within an accession should be built with reads containing no or only a single mismatch. Use of very stringent conditions in the stack building within inbreeding individuals will promote separation of paralogs and, in polyploids, of homoeologous loci. In outcrossing polyploid species, however, stacks within accessions need to be generated that comprise homo-alleles but not homoeo-alleles. Finding the optimal parameters to achieve this can be challenging, in particular in highly polymorphic polyploids, and needs to be done empirically. Similar considerations need to be taken into account when generating stacks across accessions. For finger millet, we allowed a 1&#x000a0;bp mismatch both for clustering within samples and across samples. Polymorphism levels in finger millet are relatively low, and because we were working with an F<sub>2</sub> population, allelic variation within and between samples was similar. The &#x02018;cstacks&#x02019;/&#x02018;ASustacks&#x02019; outputs were filtered to retain only those consensus sequences that were present in a specified percentage of the samples, and these sequences were used as a reference. This step limits downstream identification of SNPs with large amounts of missing data.</p></sec><sec id="Sec26"><title>SNP calling</title><p id="Par37">Quality-trimmed reads were aligned to the GBS reference using Bowtie 2 [<xref ref-type="bibr" rid="CR27">27</xref>]. SNPs were called using GATK [<xref ref-type="bibr" rid="CR28">28</xref>]. The fact that the GBS reference consisted of paired-end reads that were artificially joined but were physically separated in the genome did not affect the bowtie alignment nor the SNP calling. The only exception was when a deletion was present in an allele relative to the allele used in the GBS reference. Because alleles are sequenced to a fixed length on Illumina platforms (e.g. 150&#x000a0;bp), the presence of a, for example, 2-bp deletion polymorphism in the region sequenced practically means that sequence information will be generated for an additional 2&#x000a0;bp at the 3&#x02019;end of reads for alleles with the deletion compared to alleles without the deletion. If the corresponding GBS reference tag lacks the deletion, there will be an alignment gap at the location of the deletion and the &#x02018;extra&#x02019; 2&#x000a0;bps sequenced will extend beyond the junction point where the forward and reverse reads were artificially joined in the GBS reference. This leads to SNP artifacts (Additional&#x000a0;file&#x000a0;<xref rid="MOESM10" ref-type="media">10</xref>: Figure S3). Because adjacent SNPs were removed as part of our SNP filtering protocol, only spurious SNPs caused by single base pair deletions remained in our dataset. The SNP frequency immediately flanking the junction between the forward and reverse reads was two-to three-fold higher than the SNP frequency across the rest of the read (Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>). Discarding the SNPs at these two positions reduced overall SNP numbers by approximately 2.5%.<fig id="Fig8"><label>Fig. 8</label><caption><p>SNP distribution across <italic>Pst</italic>I/<italic>Msp</italic>I GBS tags for which forward and reverse reads were joined artificially during the GBS reference generation in three finger millet accessions (KNE 796, MD-20 and Okhale-1). Red bars flank the junction between forward and reverse reads</p></caption><graphic xlink:href="12870_2018_1316_Fig8_HTML" id="MO8"/></fig></p><p id="Par38">We tested both GATK&#x02019;s Haplotype Caller and Unified Genotyper for calling SNPs. Unified Genotyper identified some 17% more SNPs than Haplotype Caller (Table <xref rid="Tab3" ref-type="table">3</xref>). On average, 25% of the SNPs identified with Unified Genotyper were not identified by Haplotype Caller (Fig. <xref rid="Fig2" ref-type="fig">2</xref>, Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S2). Conversely, some 12% of SNPs identified with Haplotype Caller were not identified by Unified Genotyper. These comparisons were made on filtered data sets, and hence concerned robust SNPs. The percentage of SNPs uniquely identified by Unified Genotyper and Haplotype Caller that were incorporated in the genetic maps and hence were validated, was very similar (41.3% <italic>vs</italic> 40.1% for Ref50_98 and 47.5% <italic>vs</italic> 40.8% for Ref70_98). This indicates that, at least in our dataset, the high sensitivity/aggressiveness of Unified Genotyper in calling SNPs did not increase the false positive rate. For comparison, the percentage of SNPs identified by both SNP callers that were incorporated in the genetic maps was 56% for Ref50_98 and 55.4% for Ref70_50. Freebayes [<xref ref-type="bibr" rid="CR29">29</xref>], a haplotype-based SNP caller, also yielded a lower number of SNPs than Unified Genotyper when tested on the parents of the mapping population. Although we did not validate the SNPs identified by Freebayes, the number of SNPs identified in common with Unified Genotyper and the percentage of common SNPs mapped suggest that the lower SNP detection rate in Freebayes would have resulted in a lower percentage of mappable polymorphisms.</p><p id="Par39">The threshold number of samples in which each representative GBS tag had to be present in order to be included in the GBS reference also greatly affected the number of identified SNPs, although the trend was opposite to what we expected (Table <xref rid="Tab3" ref-type="table">3</xref>). To our surprise, we identified fewer SNPs, after filtering, when a representative tag was selected to be present in at least 50% of the samples (Ref50) compared to at least 70% (Ref70), despite the fact that more reference tags were present in the Ref50 compared to the Ref70 reference. We hypothesized that, although the Ref70 reference carried fewer tags, more loci were represented by only a single allele. If alleles from the same locus (e.g. Parent 1 allele and Parent 2 allele) formed separate stacks during the clustering performed by &#x02018;ustacks&#x02019;, both would be included in the GBS reference. Reads from the same locus in heterozygous individuals would align to either the allele 1 GBS reference tag or the allele 2 GBS reference tag during the bowtie alignment, and be scored as two homozygous loci in GATK. To test this hypothesis, we removed tags that were potentially allelic to another tag. When a GBS tag had more than 98% homology to another tag following a blast-all-against-all analysis, only one of the tags was included in the GBS reference. Removing allelic tags from Ref50 (referred to as Ref50_98) resulted in the calling of 136% new SNPs, while less than 2% of SNPs were lost (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S2). As expected, SNP gain was significantly smaller (15%) when allelic tags were removed from Ref70 (referred to as Ref70_98), but still greatly outpaced SNP loss (1%) (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S2). SNP discovery now followed the expected trend with approximately 24% higher SNP numbers being identified with Ref50_98 compared to Ref70_98 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Interestingly, only 75% of the SNPs identified with Ref70_98 were detected with Ref50_98. The percentage of SNPs uniquely found by only a single reference was 25 and 39% for Ref70_98 and Ref50_98, respectively. This suggest that a substantially improved reference could be obtained and SNP calling maximized by combining the tags in both GBS references.</p><p id="Par40">The UGbS-Flex pipeline compares favorably to GBS-SNP-CROP [<xref ref-type="bibr" rid="CR13">13</xref>], which can also use paired-end reads as input. Using the same filtering criteria, the number of SNPs identified by UGbS-Flex was more than 3-fold that identified by GBS-SNP-CROP when the reference in both pipelines was generated with all 48 accessions. Interestingly, more heterozygotes were identified by GBS-SNP-CROP than UGbS-Flex. While a larger percentage of the SNPs identified by GBS-SNP-CROP than UGbS-Flex (99.9% <italic>vs</italic> 73.7%) had read depths &#x02265;20, it seems unlikely that the read depth explains the difference in the calling of homozygotes <italic>vs</italic> heterozygotes between the two pipelines because of the stringent criteria used in SNP calling. As per Melo and colleagues [<xref ref-type="bibr" rid="CR13">13</xref>], to score a SNP locus as homozygote required a minimum read depth of 11 when the secondary allele count was zero, and a minimum read depth of 48 when the secondary allele count was one. Because kiwiberry is a tetraploid, it is likely that some of the heterozygote SNPs are variants between homoeo-alleles rather than homo-alleles. The parameters used to cluster reads may have separated homoeologs from homologs at a higher frequency in UGbS-Flex than in GBS-SNP-CROP.</p></sec><sec id="Sec27"><title>Construction of a high-density genetic map</title><p id="Par41">We had previously constructed a 332-loci genetic map in an F<sub>2</sub> population generated from a cross between the wild <italic>E. coracana</italic> subsp. <italic>africana</italic> acc. MD-20 and the cultivated <italic>E. coracana</italic> subsp. <italic>coracana</italic> acc. Okhale-1 using restriction fragment length polymorphism (RFLP), simple sequence repeat (SSR) and expressed sequenced tag (EST) markers [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. The same population was used here to generate a high-density genetic map. The decision to use a three-enzyme combination (<italic>Pst</italic>I/<italic>Msp</italic>I plus <italic>Ape</italic>KI) for GBS of the mapping population predated data availability on the relative efficiency of different enzyme combinations in generating polymorphic markers. The choice of enzyme combination does not affect map quality, only marker number. Because DNA from individual F<sub>2</sub> plants was no longer available, we used DNA extracted from bulked F<sub>2:3</sub> families for mapping. The drawback of this was that the mapping data was not quite as clean as when genotyping actual F<sub>2</sub> plants, especially in heterozygous regions that underwent recombination or displayed segregation distortion. Mapping programs such as MSTmap [<xref ref-type="bibr" rid="CR21">21</xref>] and Lep-Map [<xref ref-type="bibr" rid="CR22">22</xref>] are based on the traveling salesman principle (TSP) and can very quickly generate maps with large numbers of markers. However, because marker ordering relies on two-point linkage information, TSP mapping programs are more affected by missing data and provide less robust genetic maps than programs such as MAPMAKER [<xref ref-type="bibr" rid="CR17">17</xref>] that use multipoint analyses [<xref ref-type="bibr" rid="CR30">30</xref>] (Additional&#x000a0;file&#x000a0;<xref rid="MOESM11" ref-type="media">11</xref>: Figure S4). Furthermore, C (ambiguous B or H) and D (ambiguous A or H) values could be incorporated in MAPMAKER, but had to be converted to missing data points in MSTmap. We therefore used a hybrid approach in which we identified linkage groups and did the initial marker ordering with MSTmap. Using the MSTmap marker orders, we generated maps in MAPMAKER with the option &#x02018;error detection on&#x02019; to identify markers with high levels of genotypic errors. These markers were removed from further analyses. We then used the MSTmap marker orders to select overlapping marker groups for fine-scale ordering using three/multipoint analyses in MAPMAKER. The version of MAPMAKER employed (available from <ext-link ext-link-type="uri" xlink:href="http://research.franklin.uga.edu/devoslab/">http://research.franklin.uga.edu/devoslab/</ext-link>) had been modified to run efficiently in a Windows Command Prompt Environment and to handle larger numbers of markers than the original MAPMAKER version [<xref ref-type="bibr" rid="CR18">18</xref>]. Despite the modifications, marker ordering was still limited to groups of approximately 100 markers due to inherent software limitations. The &#x02018;try&#x02019; and &#x02018;ripple&#x02019; commands in MAPMAKER were semi-automated with in-house developed python scripts. Because the overlapping segments were selected based on the initial marker orders defined by MSTmap, incorrect placement of one or more markers in the MST map could affect the final MAPMAKER-generated map. Recombination events in the final maps were therefore scrutinized manually and, if necessary, potentially problematic map regions were reanalyzed. Two blocks of markers, one on linkage group 2A and one on 2B, were removed because they were flanked on either side by a large number of recombination events. Following the manual assignment of markers to recombination bins and addition of the cosegregating markers, we obtained a robust map consisting of 4453 SNP markers organized in 18 linkage groups (Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>; Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S6).</p></sec><sec id="Sec28"><title>The finger millet genetic map and its characteristics</title><p id="Par42">The 18 <italic>E. coracana</italic> linkage groups were labeled 1 to 9 with the suffix A or B to designate whether they originated from the A or B subgenome (Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>; Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S6). Linkage group designations were the same as in Dida et al. [<xref ref-type="bibr" rid="CR15">15</xref>] as determined by the incorporation of a subset of the markers from the map generated by Dida and colleagues into the high density GBS map. The assignment of each linkage group to a subgenome had previously been achieved by identifying a small number of RFLP markers for each linkage group that were conserved in size between <italic>E. indica</italic>, the A genome progenitor of <italic>E. coracana</italic>, and the presumed A genome of <italic>E. coracana</italic> [<xref ref-type="bibr" rid="CR15">15</xref>]. The GBS data generated in <italic>E. indica</italic> provided us with an opportunity to scan the entire length of each linkage group for the presence of A-genome markers. A-genome linkage groups were expected to carry <italic>E. indica</italic> GBS tags along their entire length, while B-genome linkage groups should be devoid of such tags. We observed the expected pattern in seven of the nine homoeologous linkage groups (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Interestingly, in homoeologous groups 6 and 9, the presence/absence pattern of <italic>E. indica</italic> GBS tags indicated the presence of a reciprocal translocation between homoeologous chromosomes. Visual examination of the group 9 recombination data (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S5) showed a number of progeny that carried recombination events in both the A and B homoeologs at the putative translocation breakpoint leading to cross-shaped maps which had been split at high LOD scores during our mapping analysis. This suggests that the group 9 translocation was present in only one of the two mapping parents. Chromosomes that are heterozygous for a translocation undergo pairing in a cross-type configuration. Depending on how the chromosomes segregate (and assuming no cross-overs take place), progeny can either carry full copies of the A and B genome chromosomes or a chromosome complement that carries deletions/duplications for regions of the translocated chromosome. One progeny (progeny 151 in Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S5) indeed lacked all A-genome markers located within the translocated region and five progeny (16, 56, 125, 131, 148) lacked the B-genome markers, indicating that these regions were deleted in those progeny. Further analysis showed that read numbers were approximately double in the corresponding B-genome region in progeny 151 and in the corresponding A-genome region in progenies 16, 56, 125, 131 and 148, indicating that the absence of a region was compensated for by an extra copy of the homoeologous region in those progeny (Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>). While deletion of a chromosomal region would likely be deleterious in a diploid species, the presence of homoeologous chromosomes in an allopolyploid largely buffers against the negative effects caused by chromosomal deletions. Progeny with apparent recombination events in homoeologous A and B chromosomes, or with a deleted region were not identified for chromosomes 6A and 6B. It is possible that the 6A/6B rearrangement occurred early in polyploid evolution and is present in both parents. Identification of a heterozygous translocation through the comparison with <italic>E. indica</italic> depends on whether the cross-shaped maps were split into two non-translocated chromosomes or into two translocated chromosomes. We therefore scrutinized the other homoeologous groups for cross-shaped linkages and deletions, and uncovered an interstitial rearrangement in homoeologous group 2. The two interstitial marker blocks that we removed during the map construction, because they were flanked on either side by a large number of recombination events, were regions that had undergone an interstitial translocation in one of the parents. At this point, we do not know whether the 9A/9B and 2A/2B rearrangements occurred in the cultivated or wild parent. In allopolyploids, pairing is typically controlled genetically and limited to homologous chromosomes [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Removal of the pairing control locus can lead to chromosomal rearrangements, including homoeologous translocations [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. Finger millet has been reported to display disomic inheritance [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>] but the mechanism of pairing control is not known. An analysis of the pairing behavior is needed to determine whether homoeologous pairing control is suppressed in either of the parents.<fig id="Fig9"><label>Fig. 9</label><caption><p>Box-and-whisker plots showing the read depth distribution at SNP positions along the length of the translocated (9A<sup>B</sup> and 9B<sup>A</sup>) and non-translocated regions (9A<sup>A</sup> and 9B<sup>B</sup>) in chromosomes 9A and 9B of five selected progeny. Progenies 16 and 56 carry a chromosome complement in which the 9B<sup>A</sup> region is absent and two copies of the 9A<sup>B</sup> region are present. Progeny 94 and 114 carry complete A and B genomes. Progeny 151 carries a chromosome complement in which the 9A<sup>B</sup> region is absent and two copies of the 9B<sup>A</sup> region are present</p></caption><graphic xlink:href="12870_2018_1316_Fig9_HTML" id="MO9"/></fig></p></sec></sec><sec id="Sec29"><title>Conclusions</title><p id="Par43">We provide a detailed analysis of the effect of parameter and module changes in the GBS methodology, reference generation and SNP calling that were aimed at maximizing the discovery of high confidence SNPs with minimal missing data. The newly developed UGbS-Flex pipeline provides a useful addition to the currently available tools for GBS data analysis, in particular for genotyping of heterozygous and polyploid individuals from paired-end sequencing reads in the absence of a whole-genome reference. The UGbS-Flex pipeline was applied here to identify high confidence SNPs that were subsequently used to generate the first high-density genetic map of finger millet, <italic>Eleusine coracana</italic>. Map robustness was achieved by applying multipoint marker ordering. We demonstrated that cross-species application of GBS is feasible between closely related species and, when applied between an allopolyploid and one of the diploid genome donors, can be used to identify the subgenome origin of linkage groups and the occurrence of translocations between homoeologous chromosomes. Finger millet, an inbreeding allopolyploid species with few genomic resources was used here as a case study, but applicability of the UGbS-Flex pipeline to other species, including the outcrossing tetraploid switchgrass has been successfully achieved.</p></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec30"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="12870_2018_1316_MOESM1_ESM.pdf"><label>Additional file 1:</label><caption><p><bold>Data S1.</bold> System requirements and UGbS-Flex commands for GBS reference generation,&#x000a0;SNP calling and further SNP processing. (PDF 165&#x000a0;kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="12870_2018_1316_MOESM2_ESM.pptx"><label>Additional file 2:</label><caption><p><bold>Figure S1.</bold> The &#x02018;Bcraw&#x02019; folder comprises the raw sequencing files for individual samples. After trimming, the trimmed sequence files are placed in the &#x02018;BCpc&#x02019; folder. Using files in the &#x02018;BCpc&#x02019; folder as input, all files with equal-length reads are placed in &#x02018;BCfin&#x02019; folder. The &#x02018;ASU&#x02019; folder holds the ASU method results for all files present in the &#x02018;BCfin&#x02019; folder. The ASU results are used to generate a reference; the filtered reference is placed in the &#x02018;Ref&#x02019; folder. The trimmed sequences in the &#x02018;BCpc&#x02019; folder are aligned (with Bowtie) against the reference files in the &#x02018;Ref&#x02019; folder; alignments are used for SNP calling (using GATK); all results are stored in the &#x02018;SNP&#x02019; folder. The &#x02018;Process&#x02019; number corresponds to the step number in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Data S1. (PPTX 52&#x000a0;kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="12870_2018_1316_MOESM3_ESM.xlsx"><label>Additional file 3:</label><caption><p><bold>Table S1A.</bold> Summary statistics obtained for each of the three enzyme combinations for subsets of reads; Entries are grouped by read number.&#x000a0;<bold>Table S1B.</bold> Summary statistics&#x000a0;obtained for each of the three enzyme combinations for subsets of reads; Entries are grouped by enzyme combination. (XLSX 29&#x000a0;kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM4"><media xlink:href="12870_2018_1316_MOESM4_ESM.docx"><label>Additional file 4:</label><caption><p><bold>Table S2.</bold> Average read depth (across three accessions tested) of GBS reference tags common to all three accessions in the <italic>Pst</italic>I/<italic>Nde</italic>I fragment pool. (DOCX 13&#x000a0;kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM5"><media xlink:href="12870_2018_1316_MOESM5_ESM.docx"><label>Additional file 5:</label><caption><p><bold>Table S3.</bold> Number and percentage of <italic>Ape</italic>KI sites present in <italic>Pst</italic>I/<italic>Msp</italic>I and <italic>Pst</italic>I/<italic>Msp</italic>I&#x02009;+&#x000a0;<italic>Ape</italic>KI digests. (DOCX 12&#x000a0;kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM6"><media xlink:href="12870_2018_1316_MOESM6_ESM.pptx"><label>Additional file 6:</label><caption><p><bold>Figure S2.</bold> Comparison of the number of SNPs identified using different SNP callers (UG&#x02009;=&#x02009;Unified Genotyper; HC=Haplotype Caller) and different GBS references (Ref50: tags present in &#x02265;50% of the samples; Ref70: tags present in &#x02265;70% of the samples; Ref50_98: tags present in &#x02265;50% of the samples and only 1 tag retained for tags with &#x02265;98% homology; Ref70_98: tags present in &#x02265;70% of the samples and only 1 tag retained for tags with &#x02265;98% homology. (PPTX 7261&#x000a0;kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM7"><media xlink:href="12870_2018_1316_MOESM7_ESM.xlsx"><label>Additional file 7:</label><caption><p><bold>Table S4.</bold> Comparison of SNPs identified by UGbS-Flex and GBS-SNP-CROP. (XLSX 9&#x000a0;kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM8"><media xlink:href="12870_2018_1316_MOESM8_ESM.xlsx"><label>Additional file 8:</label><caption><p><bold>Table S5.</bold> Genotypic data&#x000a0;for the&#x000a0;MD-20 x Okhale-1 population. (XLSX 2444&#x000a0;kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM9"><media xlink:href="12870_2018_1316_MOESM9_ESM.xlsx"><label>Additional file 9:</label><caption><p><bold>Table S6.</bold> Genetic maps comprising all markers. (XLSX 717&#x000a0;kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM10"><media xlink:href="12870_2018_1316_MOESM10_ESM.pptx"><label>Additional file 10:</label><caption><p><bold>Figure S3.</bold> Effect of the presence of a deletion in a sample relative to the GBS reference allele. A gapped alignment is formed and the 3&#x02032; end extends beyond the junction of the forward and reverse reads in the GBS reference resulting in the calling of a SNP at that position. The Integrative Genomics Viewer (Robinson et al. 2011, Nature Biotechnology 29: 24&#x02013;26; Thorvaldsd&#x000f3;ttir et al. 2013, Briefings in Bioinformatics 14: 178&#x02013;192) was used for visualization. (PPTX 75&#x000a0;kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM11"><media xlink:href="12870_2018_1316_MOESM11_ESM.pptx"><label>Additional file 11:</label><caption><p><bold>Figure S4.</bold> Comparison of genetic maps generated using MSTmap (left-hand side) and MAPMAKER (right-hand side). Nearly 65% of markers were reordered in MAPMAKER compared to MSTmap maps. The markers that occupied a different relative position in the two maps are connected by a line. (PPTX 170&#x000a0;kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Electronic supplementary material</bold></p><p>The online version of this article (10.1186/s12870-018-1316-3) contains supplementary material, which is available to authorized users.</p></fn></fn-group><ack><title>Acknowledgements</title><p>This research was funded in part through the BioInnovate Africa Program, the University of Georgia and DOE grant DE-SC0010743. DS was funded through a Fulbright-Nehru Senior Research Fellowship grant (Award 1865/FN-SR/2013) from the United States India Educational Foundation, New Delhi, India.</p><sec id="FPar1"><title>Availability of data and materials</title><p id="Par44">All datasets used and scripts generated are included in this manuscript as supplementary data and/or are available through the Devos Lab website (<ext-link ext-link-type="uri" xlink:href="http://research.franklin.uga.edu/devoslab/">http://research.franklin.uga.edu/devoslab/</ext-link>).</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>PQ developed most of the scripts and led the data analysis. DG conducted GBS on the mapping population and assisted with the data analysis. DC and XW contributed scripts. DS and SS participated in optimization of the GBS experimental protocol. MMD generated the mapping population and collected the <italic>E. indica</italic> germplasm. RLM generated the updated version of MAPMAKER. KMD conceived the research, participated in the analyses and led the manuscript preparation. All authors participated in preparation of the manuscript and approved the manuscript.</p></notes><notes notes-type="COI-statement"><sec id="FPar2"><title>Ethics approval and consent to participate</title><p id="Par45">Not applicable.</p></sec><sec id="FPar3"><title>Competing interests</title><p id="Par46">The authors declare that they have no competing interests.</p></sec><sec id="FPar4"><title>Publisher&#x02019;s Note</title><p id="Par47">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luikart</surname><given-names>G</given-names></name><name><surname>England</surname><given-names>PR</given-names></name><name><surname>Tallmon</surname><given-names>D</given-names></name><name><surname>Jordan</surname><given-names>S</given-names></name><name><surname>Taberlet</surname><given-names>P</given-names></name></person-group><article-title>The power and promise of population genomics: from genotyping to genome typing</article-title><source>Nat Rev Genet</source><year>2003</year><volume>4</volume><issue>12</issue><fpage>981</fpage><lpage>994</lpage><pub-id pub-id-type="doi">10.1038/nrg1226</pub-id><?supplied-pmid 14631358?><pub-id pub-id-type="pmid">14631358</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="other">Elshire RJ, Glaubitz JC, Sun Q, Poland JA, Kawamoto K, Buckler ES, Mitchell SE. A robust, simple genotyping-by-sequencing (GBS) approach for high diversity species. PLoS One. 2011;6</mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="other">Baird NA, Etter PD, Atwood TS, Currey MC, Shiver AL, Lewis ZA, Selker EU, Cresko WA, Johnson EA. Rapid SNP discovery and genetic mapping using sequenced RAD markers. PLoS One. 2008;3</mixed-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Pollara</surname><given-names>VJ</given-names></name><name><surname>Cowles</surname><given-names>CR</given-names></name><name><surname>Van Etten</surname><given-names>WJ</given-names></name><name><surname>Baldwin</surname><given-names>J</given-names></name><name><surname>Linton</surname><given-names>L</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name></person-group><article-title>An SNP map of the human genome generated by reduced representation shotgun sequencing</article-title><source>Nature</source><year>2000</year><volume>407</volume><issue>6803</issue><fpage>513</fpage><lpage>516</lpage><pub-id pub-id-type="doi">10.1038/35035083</pub-id><?supplied-pmid 11029002?><pub-id pub-id-type="pmid">11029002</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>F</given-names></name><name><surname>Lipka</surname><given-names>AE</given-names></name><name><surname>Glaubitz</surname><given-names>J</given-names></name><name><surname>Elshire</surname><given-names>R</given-names></name><name><surname>Cherney</surname><given-names>JH</given-names></name><name><surname>Casler</surname><given-names>MD</given-names></name><name><surname>Buckler</surname><given-names>ES</given-names></name><name><surname>Costich</surname><given-names>DE</given-names></name></person-group><article-title>Switchgrass genomic diversity, ploidy, and evolution: novel insights from a network-based SNP discovery protocol</article-title><source>PLoS Genet</source><year>2013</year><volume>9</volume><fpage>e1003215</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1003215</pub-id><?supplied-pmid 23349638?><pub-id pub-id-type="pmid">23349638</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname><given-names>KM</given-names></name><name><surname>Brown</surname><given-names>P</given-names></name><name><surname>Cooke</surname><given-names>TF</given-names></name><name><surname>Cann</surname><given-names>S</given-names></name><name><surname>Costa</surname><given-names>F</given-names></name><name><surname>Bustamante</surname><given-names>C</given-names></name><name><surname>Velasco</surname><given-names>R</given-names></name><name><surname>Troggio</surname><given-names>M</given-names></name><name><surname>Myles</surname><given-names>S</given-names></name></person-group><article-title>Fast and cost-effective genetic mapping in apple using next-generation sequencing. G3: Genes|Genomes<italic>|</italic></article-title><source>Genetics</source><year>2014</year><volume>4</volume><issue>9</issue><fpage>1681</fpage><lpage>1687</lpage></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davey</surname><given-names>JW</given-names></name><name><surname>Hohenlohe</surname><given-names>PA</given-names></name><name><surname>Etter</surname><given-names>PD</given-names></name><name><surname>Boone</surname><given-names>JQ</given-names></name><name><surname>Catchen</surname><given-names>JM</given-names></name><name><surname>Blaxter</surname><given-names>ML</given-names></name></person-group><article-title>Genome-wide genetic marker discovery and genotyping using next-generation sequencing</article-title><source>Nat Rev Genet</source><year>2011</year><volume>12</volume><issue>7</issue><fpage>499</fpage><lpage>510</lpage><pub-id pub-id-type="doi">10.1038/nrg3012</pub-id><?supplied-pmid 21681211?><pub-id pub-id-type="pmid">21681211</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poland</surname><given-names>JA</given-names></name><name><surname>Brown</surname><given-names>PJ</given-names></name><name><surname>Sorrells</surname><given-names>ME</given-names></name><name><surname>Jannink</surname><given-names>J-L</given-names></name></person-group><article-title>Development of high-density genetic maps for barley and wheat using a novel two-enzyme genotyping-by-sequencing approach</article-title><source>PLoS One</source><year>2012</year><volume>7</volume><fpage>e32253</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0032253</pub-id><?supplied-pmid 22389690?><pub-id pub-id-type="pmid">22389690</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradbury</surname><given-names>PJ</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Kroon</surname><given-names>DE</given-names></name><name><surname>Casstevens</surname><given-names>TM</given-names></name><name><surname>Ramdoss</surname><given-names>Y</given-names></name><name><surname>Buckler</surname><given-names>ES</given-names></name></person-group><article-title>TASSEL: software for association mapping of complex traits in diverse samples</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><issue>19</issue><fpage>2633</fpage><lpage>2635</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btm308</pub-id><?supplied-pmid 17586829?><pub-id pub-id-type="pmid">17586829</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaubitz</surname><given-names>JC</given-names></name><name><surname>Casstevens</surname><given-names>TM</given-names></name><name><surname>Lu</surname><given-names>F</given-names></name><name><surname>Harriman</surname><given-names>J</given-names></name><name><surname>Elshire</surname><given-names>RJ</given-names></name><name><surname>Sun</surname><given-names>Q</given-names></name><name><surname>Buckler</surname><given-names>ES</given-names></name></person-group><article-title>TASSEL-GBS: a high capacity genotyping by sequencing analysis pipeline</article-title><source>PLoS One</source><year>2014</year><volume>9</volume><issue>2</issue><fpage>e90346</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0090346</pub-id><?supplied-pmid 24587335?><pub-id pub-id-type="pmid">24587335</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Torkamaneh</surname><given-names>D</given-names></name><name><surname>Laroche</surname><given-names>J</given-names></name><name><surname>Bastien</surname><given-names>M</given-names></name><name><surname>Abed</surname><given-names>A</given-names></name><name><surname>Belzile</surname><given-names>F</given-names></name></person-group><article-title>Fast-GBS: a new pipeline for the efficient and highly accurate calling of SNPs from genotyping-by-sequencing data</article-title><source>BMC Bioinformatics</source><year>2017</year><volume>18</volume><fpage>5</fpage><pub-id pub-id-type="doi">10.1186/s12859-016-1431-9</pub-id><?supplied-pmid 28049422?><pub-id pub-id-type="pmid">28049422</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Catchen</surname><given-names>JM</given-names></name><name><surname>Amores</surname><given-names>A</given-names></name><name><surname>Hohenlohe</surname><given-names>P</given-names></name><name><surname>Cresko</surname><given-names>W</given-names></name><name><surname>Postlethwait</surname><given-names>JH</given-names></name></person-group><article-title>Stacks: building and genotyping loci de novo from short-read sequences. G3: Genes|Genomes<italic>|</italic></article-title><source>Genetics</source><year>2011</year><volume>1</volume><issue>3</issue><fpage>171</fpage><lpage>182</lpage></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Melo</surname><given-names>ATO</given-names></name><name><surname>Bartaula</surname><given-names>R</given-names></name><name><surname>Hale</surname><given-names>I</given-names></name></person-group><article-title>GBS-SNP-CROP: a reference-optional pipeline for SNP discovery and plant germplasm characterization using variable length, paired-end genotyping-by-sequencing data</article-title><source>BMC Bioinformatics</source><year>2016</year><volume>17</volume><issue>1</issue><fpage>29</fpage><pub-id pub-id-type="doi">10.1186/s12859-016-0879-y</pub-id><?supplied-pmid 26754002?><pub-id pub-id-type="pmid">26754002</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mysore</surname><given-names>KS</given-names></name><name><surname>Baird</surname><given-names>V</given-names></name></person-group><article-title>Nuclear DNA content in species of Eleusine (Gramineae): a critical re-evaluation using laser flow cytometry</article-title><source>Plant Syst Evol</source><year>1997</year><volume>207</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1007/BF00985206</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="other">Dida MM, Srinivasachary RS, Bennetzen JL, Gale MD, Devos KM. The genetic map of finger millet, Eleusine coracana. Theor Appl Genet. 2007, 114:321&#x02013;32.</mixed-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srinivasachary</surname><given-names>DMM</given-names></name><name><surname>Gale</surname><given-names>MD</given-names></name><name><surname>Devos</surname><given-names>KM</given-names></name></person-group><article-title>Comparative analyses reveal high levels of conserved colinearity between the finger millet and rice genomes</article-title><source>Theor Appl Genet</source><year>2007</year><volume>115</volume><fpage>489</fpage><lpage>499</lpage><pub-id pub-id-type="doi">10.1007/s00122-007-0582-5</pub-id><?supplied-pmid 17619853?><pub-id pub-id-type="pmid">17619853</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Green</surname><given-names>P</given-names></name><name><surname>Abrahamson</surname><given-names>J</given-names></name><name><surname>Barlow</surname><given-names>A</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Lincoln</surname><given-names>SE</given-names></name><name><surname>Newburg</surname><given-names>L</given-names></name></person-group><article-title>MAPMAKER: an interactive computer package for constructing primary genetic linkage maps of experimental and natural populations</article-title><source>Genomics</source><year>1987</year><volume>1</volume><fpage>174</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1016/0888-7543(87)90010-3</pub-id><?supplied-pmid 3692487?><pub-id pub-id-type="pmid">3692487</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">Lincoln S, Daly M, Lander ES: Constructing genetic maps with MAPMAKER/EXP 3.0. Cambridge, Mass., USA.: Whitehead Institute for Biomed Res; 1993.</mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Van Ooijen JW: Joinmap &#x000ae; 4, Software for the calculation of genetic linkage maps in experimental populations. In<italic>.</italic> Wageningen, Netherlands: Kyazma B.V.; 2006.</mixed-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stam</surname><given-names>P</given-names></name></person-group><article-title>Construction of integrated genetic linkage maps by means of a new computer package: JoinMap</article-title><source>Plant J</source><year>1993</year><volume>3</volume><fpage>739</fpage><lpage>744</lpage><pub-id pub-id-type="doi">10.1111/j.1365-313X.1993.00739.x</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Bhat</surname><given-names>PR</given-names></name><name><surname>Close</surname><given-names>TJ</given-names></name><name><surname>Lonardi</surname><given-names>S</given-names></name></person-group><article-title>Efficient and accurate construction of genetic linkage maps from the minimum spanning tree of a graph</article-title><source>PLoS Genet</source><year>2008</year><volume>4</volume><issue>10</issue><fpage>e1000212</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1000212</pub-id><?supplied-pmid 18846212?><pub-id pub-id-type="pmid">18846212</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rastas</surname><given-names>P</given-names></name><name><surname>Paulin</surname><given-names>L</given-names></name><name><surname>Hanski</surname><given-names>I</given-names></name><name><surname>Lehtonen</surname><given-names>R</given-names></name><name><surname>Auvinen</surname><given-names>P</given-names></name></person-group><article-title>Lep-MAP: fast and accurate linkage map construction for large SNP datasets</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><issue>24</issue><fpage>3128</fpage><lpage>3134</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btt563</pub-id><?supplied-pmid 24078685?><pub-id pub-id-type="pmid">24078685</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doyle</surname><given-names>JJ</given-names></name><name><surname>Doyle</surname><given-names>JL</given-names></name></person-group><article-title>A rapid DNA isolation procedure for small quantitites of fresh leaf tissue</article-title><source>Phytochemical Bulletin</source><year>1987</year><volume>19</volume><fpage>11</fpage><lpage>15</lpage></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohland</surname><given-names>N</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><article-title>Cost-effective, high-throughput DNA sequencing libraries for multiplexed target capture</article-title><source>Genome Res</source><year>2012</year><volume>22</volume><issue>5</issue><fpage>939</fpage><lpage>946</lpage><pub-id pub-id-type="doi">10.1101/gr.128124.111</pub-id><?supplied-pmid 22267522?><pub-id pub-id-type="pmid">22267522</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">Andrews S: FastQC: a quallity control tool for high throughput sequence data. 2010. Available online at: <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc">http://www.bioinformatics.babraham.ac.uk/projects/fastqc</ext-link>.</mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="other">Magoc T, Salzberg S. FLASH: fast length adjustment of short reads to improve genome assemblies. Bioinformatics. 2011;27</mixed-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Fast gapped-read alignment with bowtie 2</article-title><source>Nat Meth</source><year>2012</year><volume>9</volume><fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><name><surname>Sivachenko</surname><given-names>A</given-names></name><name><surname>Cibulskis</surname><given-names>K</given-names></name><name><surname>Kernytsky</surname><given-names>A</given-names></name><name><surname>Garimella</surname><given-names>K</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Gabriel</surname><given-names>S</given-names></name><name><surname>Daly</surname><given-names>M</given-names></name><etal/></person-group><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title><source>Genome Res</source><year>2010</year><volume>20</volume><issue>9</issue><fpage>1297</fpage><lpage>1303</lpage><pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id><?supplied-pmid 20644199?><pub-id pub-id-type="pmid">20644199</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Garrison</surname><given-names>E</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name></person-group><article-title>Haplotype-based variant detection from short-read sequencing</article-title><source>arXiv:12073907</source><year>2012</year></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahfock</surname><given-names>D</given-names></name><name><surname>Wood</surname><given-names>I</given-names></name><name><surname>Stephen</surname><given-names>S</given-names></name><name><surname>Cavanagh</surname><given-names>CR</given-names></name><name><surname>Huang</surname><given-names>BE</given-names></name></person-group><article-title>Characterizing uncertainty in high-density maps from multiparental populations</article-title><source>Genetics</source><year>2014</year><volume>198</volume><issue>1</issue><fpage>117</fpage><lpage>128</lpage><pub-id pub-id-type="doi">10.1534/genetics.114.167577</pub-id><?supplied-pmid 25236453?><pub-id pub-id-type="pmid">25236453</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riley</surname><given-names>R</given-names></name><name><surname>Chapman</surname><given-names>V</given-names></name></person-group><article-title>Genetic control of the cytologically diploid behaviour of hexaploid wheat</article-title><source>Nature</source><year>1958</year><volume>182</volume><fpage>713</fpage><lpage>715</lpage><pub-id pub-id-type="doi">10.1038/182713a0</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenczewski</surname><given-names>E</given-names></name><name><surname>Eber</surname><given-names>F</given-names></name><name><surname>Grimaud</surname><given-names>A</given-names></name><name><surname>Huet</surname><given-names>S</given-names></name><name><surname>Lucas</surname><given-names>MO</given-names></name><name><surname>Monod</surname><given-names>H</given-names></name><name><surname>Chevre</surname><given-names>AM</given-names></name></person-group><article-title>PrBn, a major gene controlling homeologous pairing in oilseed rape (<italic>Brassica napus</italic>) haploids</article-title><source>Genetics</source><year>2003</year><volume>164</volume><issue>2</issue><fpage>645</fpage><lpage>653</lpage><?supplied-pmid 12807785?><pub-id pub-id-type="pmid">12807785</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaeta</surname><given-names>RT</given-names></name><name><surname>Chris Pires</surname><given-names>J</given-names></name></person-group><article-title>Homoeologous recombination in allopolyploids: the polyploid ratchet</article-title><source>New Phytol</source><year>2010</year><volume>186</volume><issue>1</issue><fpage>18</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1111/j.1469-8137.2009.03089.x</pub-id><?supplied-pmid 20002315?><pub-id pub-id-type="pmid">20002315</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Devos</surname><given-names>KM</given-names></name><name><surname>Sorrells</surname><given-names>ME</given-names></name><name><surname>Anderson</surname><given-names>JA</given-names></name><name><surname>Miller</surname><given-names>TE</given-names></name><name><surname>Reader</surname><given-names>SM</given-names></name><name><surname>Lukaszewski</surname><given-names>AJ</given-names></name><name><surname>Dubcovsky</surname><given-names>J</given-names></name><name><surname>Sharp</surname><given-names>PJ</given-names></name><name><surname>Faris</surname><given-names>J</given-names></name><name><surname>Gale</surname><given-names>MD</given-names></name></person-group><article-title>Chromosome aberrations in wheat nullisomic-tetrasomic and ditelosomic lines</article-title><source>Cereal Res Commun</source><year>1999</year><volume>27</volume><fpage>231</fpage><lpage>239</lpage></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chennaveeraiah</surname><given-names>MS</given-names></name><name><surname>Hiremath</surname><given-names>SC</given-names></name></person-group><article-title>Genome analysis of Eleusine coracana Gaertn</article-title><source>Euphytica</source><year>1974</year><volume>23</volume><fpage>489</fpage><lpage>495</lpage><pub-id pub-id-type="doi">10.1007/BF00022469</pub-id></element-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hiremath</surname><given-names>SC</given-names></name><name><surname>Salimath</surname><given-names>SS</given-names></name></person-group><article-title>The a genome donor of Eleusine coracana Gaertn (Gramineae)</article-title><source>Theor Appl Genet</source><year>1992</year><volume>84</volume><fpage>747</fpage><lpage>754</lpage><?supplied-pmid 24201369?><pub-id pub-id-type="pmid">24201369</pub-id></element-citation></ref></ref-list></back></article>